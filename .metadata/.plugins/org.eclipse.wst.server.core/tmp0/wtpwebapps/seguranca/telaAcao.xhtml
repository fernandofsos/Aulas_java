<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<ui:composition xmlns="http://www.w3.org/1999/xhtml"
				xmlns:ui="http://java.sun.com/jsf/facelets"
				xmlns:h="http://java.sun.com/jsf/html"
				xmlns:a4j="http://richfaces.org/a4j"
				xmlns:rich="http://richfaces.org/rich"
				xmlns:f="http://java.sun.com/jsf/core"
				xmlns:t="http://myfaces.apache.org/tomahawk"
				xmlns:mj="http://mojarra.dev.java.net/mojarra_ext"
				template="crud_template.xhtml">
	
	<ui:param name="crudBean" value="#{telaAcaoForm}" />
		
	<ui:define name="saveStateObjectsDefined">		
		<t:saveState value="#{crudBean.entity}" />
		<t:saveState value="#{crudBean.listaSistemas}" />
		<t:saveState value="#{crudBean.listaAcoes}" />
	</ui:define>
	
	
	<ui:define name="requiredFieldsMessage">
		<h:outputText value="#{bundle.todosCamposObrigatorios}" rendered="#{crudBean.updating}"/>
		<h:outputText value="#{bundle.peloMenosUmCamposObrigatorio}" rendered="#{crudBean.searching}"/>
	</ui:define>
	
	<ui:define name="content">
		
		<!-- Painel de Busca -->
		<h:panelGroup id="panelGroupDePesquisa" style="height:100%;width:100%;" rendered="#{crudBean.searching}">
			<f:subview id="viewBusca">
				<table class="tabela">		
					<tr>
						<td class="tdCor" width="200px">Descrição da Tela *</td>
						<td class="tdBranco">
							<h:inputText size="110" maxlength="100" id="dscTelaAcao" onblur="upper(this);" value="#{crudBean.searchObject.dscTelaAcao}" />
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Página *</td>
						<td class="tdBranco">
							<h:inputText size="60" maxlength="50" id="dscPagina" onblur="upper(this);" value="#{crudBean.searchObject.dscPagina}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Ação *</td>
						<td class="tdBranco">
							<h:selectOneMenu value="#{crudBean.searchObject.isnAcao}" converter="simpleIndexConverter">								
								<t:selectItems var="o" itemValue="#{o.isnAcao}" itemLabel="#{o.dscAcao}" value="#{crudBean.listaAcoes}" />
							</h:selectOneMenu>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Sistema *</td>
						<td class="tdBranco">
							<h:selectOneMenu value="#{crudBean.searchObject.sistemaBean}" converter="simpleIndexConverter">								
								<t:selectItems var="o" itemValue="#{o}" itemLabel="#{o.dscSistema}" value="#{crudBean.listaSistemas}" />
							</h:selectOneMenu>
						</td>
					</tr>					
					<tr>
						<td class="tdCor" width="200px">Data do Cadastro *</td>
						<td class="tdBranco">
							<rich:calendar value="#{crudBean.searchObject.filtro.datCadastroInicio}" datePattern="dd/MM/yyyy" cellWidth="24px" cellHeight="22px" style="width:200px" showWeeksBar="false" inputSize="10"  enableManualInput="true" oninputkeypress="return formataData(event,this);" maxlength="10"/>
								<h:outputText value=" a "/>
							<rich:calendar value="#{crudBean.searchObject.filtro.datCadastroFim}" datePattern="dd/MM/yyyy" cellWidth="24px" cellHeight="22px" style="width:200px" showWeeksBar="false" inputSize="10"  enableManualInput="true" oninputkeypress="return formataData(event,this);" maxlength="10"/>						
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Flag de Ativo</td>
						<td class="tdBranco">
							<div style="width:300px;">
								<h:selectOneRadio value="#{crudBean.searchObject.flgAtivo}" styleClass="radioButton">
									<f:selectItem itemValue="" itemLabel="Todos"/>
									<f:selectItem itemValue="S" itemLabel="Sim"/>
									<f:selectItem itemValue="N" itemLabel="Não"/>
								</h:selectOneRadio>
							</div>
						</td>
					</tr>
				</table>
				<mj:focus for="formulario:viewBusca:dscTelaAcao" />
			</f:subview>
		</h:panelGroup>
		
		
		<!-- Painel de Cadastro -->		
		<h:panelGroup id="panelGroupDeEdicao" style="height:100%;width:100%;" rendered="#{crudBean.updating}">
			<f:subview id="viewEdicao">
				<h:panelGroup id="panelGroupDeAlterar" rendered="#{crudBean.editing}" style="height:100%">
					<table class="tabela">
						<tr>
							<td class="tdCor" width="200px">Código </td>
							<td class="tdBranco">
								<h:outputText value="#{crudBean.entity.isnTelaAcao}"/>
							</td>
						</tr>
						<tr>
							<td class="tdCor" width="200px">Usuário de Inclusão </td>
							<td class="tdBranco">
								<h:outputText value="#{crudBean.entity.usuarioBean.dscUsuario}"/>
							</td>
						</tr>
						<tr>
							<td class="tdCor" width="200px">Data de Inclusão </td>
							<td class="tdBranco">
								<h:outputText value="#{crudBean.entity.datCadastro}"/>
							</td>
						</tr>
					</table>		
				</h:panelGroup>
			
				<table class="tabela">
					<tr>
						<td class="tdCor" width="200px">Descrição da Tela *</td>
						<td class="tdBranco">
							<h:inputText size="110" maxlength="100" id="dscTelaAcao" onblur="upper(this);" value="#{crudBean.entity.dscTelaAcao}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Página *</td>
						<td class="tdBranco">
							<h:inputText size="60" maxlength="50" id="dscPagina" onblur="upper(this);" value="#{crudBean.entity.dscPagina}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Ação *</td>
						<td class="tdBranco">
							<h:selectOneMenu value="#{crudBean.entity.isnAcao}" converter="simpleIndexConverter">								
								<t:selectItems var="o" itemValue="#{o.isnAcao}" itemLabel="#{o.dscAcao}" value="#{crudBean.listaAcoes}" />
							</h:selectOneMenu>
						</td>
					</tr>					
					<tr>
						<td class="tdCor" width="200px">Sistema *</td>
						<td class="tdBranco">
							<h:selectOneMenu value="#{crudBean.entity.isnSistema}" converter="simpleIndexConverter">								
								<t:selectItems var="o" itemValue="#{o.isnSistema}" itemLabel="#{o.dscSistema}" value="#{crudBean.listaSistemas}" />
							</h:selectOneMenu>
						</td>
					</tr>
				</table>
				<mj:focus for="formulario:viewEdicao:dscTelaAcao" />
				<h:panelGroup id="panelGroupAlterar" rendered="#{crudBean.editing}" style="height:100%">
					<table class="tabela">
						<tr>
							<td class="tdCor" width="200px">Flag de Ativo</td>
							<td class="tdBranco">
								<div style="width:200px;">
									<h:selectOneRadio value="#{crudBean.entity.flgAtivo}" styleClass="radioButton">
 										<f:selectItem itemValue="S" itemLabel="Sim"/>
										<f:selectItem itemValue="N" itemLabel="Não"/>
									</h:selectOneRadio>
								</div>
							</td>
						</tr>
					</table>
				</h:panelGroup>
			</f:subview>
		</h:panelGroup>
	
		<!-- Painel de Visualização -->		
		<h:panelGroup id="panelGroupDeVisualizacao" style="height:100%;width:100%;" rendered="#{crudBean.viewing}">
			<f:subview id="viewVisualizacao">
				<table class="tabela">
					<tr>
						<td class="tdCor" width="200px">Descrição da Tela </td>
						<td class="tdBranco">
							<h:outputText value="#{crudBean.entity.dscTelaAcao}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Página </td>
						<td class="tdBranco">
							<h:outputText value="#{crudBean.entity.dscPagina}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Ação </td>
						<td class="tdBranco">
							<h:outputText value="#{crudBean.entity.acaoBean.dscAcao}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Sistema </td>
						<td class="tdBranco">
							<h:outputText value="#{crudBean.entity.sistemaBean.dscSistema}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Ativo </td>
						<td class="tdBranco">
							<h:outputText value="SIM" rendered="#{crudBean.entity.flgAtivo == 'S'}"/>
						<h:outputText value="NÃO" rendered="#{crudBean.entity.flgAtivo == 'N'}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Usuário de Inclusão </td>
						<td class="tdBranco">
							<h:outputText value="#{crudBean.entity.usuarioBean.dscUsuario}"/>
						</td>
					</tr>
					<tr>
						<td class="tdCor" width="200px">Data de Inclusão </td>
						<td class="tdBranco">
							<h:outputText value="#{crudBean.entity.datCadastro}"/>
						</td>
					</tr>
				</table>
				<table>					
					<tr>
						<td>
							<rich:dataTable id="tblDataLog" value="#{crudBean.listaTelaAcaoLog}" binding="#{crudBean.tblDataLog}" var="rst" style="width: 100%;" rowClasses="par,impar">
								<f:facet name="header">
									<rich:columnGroup>
										<rich:column colspan="7">
											HISTÓRICO
										</rich:column>
										<rich:column style="width: 24%; text-align: center;"  breakBefore="true">
											Descrição da Tela
										</rich:column>
										<rich:column style="width: 8%; text-align: center;">
											Página
										</rich:column>
										<rich:column style="width: 8%; text-align: center;">
											Ação
										</rich:column>
										<rich:column style="width: 23%; text-align: center;">
											Sistema
										</rich:column>
										<rich:column style="width: 3%; text-align: center;">
											Ativo
										</rich:column>
										<rich:column style="width: 24%; text-align: center;">
											Usuário de Inclusão
										</rich:column>
										<rich:column style="width: 10%; text-align: center;">
											Data de Inclusão
										</rich:column>
									</rich:columnGroup>						
								</f:facet>
								<rich:column style="text-align: left;">
									<h:outputText value="#{rst.dscTelaAcao}" />
								</rich:column>
								<rich:column style="text-align: left;">
									<h:outputText value="#{rst.dscPagina}" />
								</rich:column>
								<rich:column style="text-align: left;">
									<h:outputText value="#{rst.acaoBean.dscAcao}" />
								</rich:column>
								<rich:column style="text-align: left;">
									<h:outputText value="#{rst.sistemaBean.dscSistema}" />
								</rich:column>
								<rich:column style="text-align: left;">
									<h:outputText value="SIM" rendered="#{rst.flgAtivo == 'S'}"/>
									<h:outputText value="NÃO" rendered="#{rst.flgAtivo == 'N'}"/>
								</rich:column>
								<rich:column style="text-align: center;">
									<h:outputText value="#{rst.usuarioBean.dscUsuario}" />
								</rich:column>
								<rich:column style="text-align: center;">
									<h:outputText value="#{rst.datCadastro}" />
								</rich:column>
							</rich:dataTable>
						</td>
					</tr>
				</table>
			</f:subview>			
		</h:panelGroup>				
	</ui:define>
	
	<ui:define name="list">
	<!-- Painel de resultado da busca-->
		<h:panelGroup id="panelGroupDeListagem" style="height:100%;width:100%;" rendered="#{crudBean.searching}">
			<f:subview id="viewListagem">
				<rich:dataTable id="tblData" value="#{crudBean.searchResult}" binding="#{crudBean.tblData}" var="rst" style="width: 100%;" rowClasses="par,impar">
					<f:facet name="header">
						<rich:columnGroup>
							<rich:column style="width: 5%; text-align: center;">
								Código
							</rich:column>
							<rich:column style="width: 30%; text-align: center;">
								Descrição da Tela
							</rich:column>
							<rich:column style="width: 12%; text-align: center;">
								Página
							</rich:column>
							<rich:column style="width: 10%; text-align: center;">
								Ação
							</rich:column>						
							<rich:column style="width: 30%; text-align: center;">
								Sistema
							</rich:column>
							<rich:column style="width: 4%; text-align: center;">
								Ativo
							</rich:column>
							<rich:column style="width: 3%; text-align: center;"/>
							<rich:column style="width: 3%; text-align: center;"/>
							<rich:column style="width: 3%; text-align: center;"/>
						</rich:columnGroup>
					</f:facet>
					<rich:column style="text-align: left;">
						<h:outputText value="#{rst.isnTelaAcao}" />
					</rich:column>
					<rich:column style="text-align: left;">
						<h:outputText value="#{rst.dscTelaAcao}" />
					</rich:column>
					<rich:column style="text-align: left;">
						<h:outputText value="#{rst.dscPagina}" />
					</rich:column>
					<rich:column style="text-align: left;">
						<h:outputText value="#{rst.acaoBean.dscAcao}" />
					</rich:column>
					<rich:column style="text-align: left;">
						<h:outputText value="#{rst.sistemaBean.dscSistema}" />
					</rich:column>
					<rich:column style="text-align: left;">
						<h:outputText value="SIM" rendered="#{rst.flgAtivo == 'S'}"/>
						<h:outputText value="NÃO" rendered="#{rst.flgAtivo == 'N'}"/>
					</rich:column>
										
					<rich:column style="text-align: center;">
						<a4j:commandButton image="/imagens/icone_alterar.gif" style="border:white; width: 12px; height: 12px;" title="ALTERAR" actionListener="#{crudBean.preparaAlterar}" reRender="formulario, panelTitle" />
					</rich:column>
					<rich:column style="text-align: center;">
						<a4j:commandButton image="/imagens/visualizar.gif" style="border:white; width: 12px; height: 12px;" title="VISUALIZAR" actionListener="#{crudBean.visualizar}" reRender="formulario, panelTitle"/>
					</rich:column>
					<rich:column style="text-align: center;">
						<a4j:commandButton image="/imagens/icone_excluir.gif" style="border:white; width: 12px; height: 12px;" rendered="#{rst.flgAtivo == 'S'}" title="INATIVAR" actionListener="#{crudBean.inativar}" reRender="formulario" onclick="if (!confirm('Deseja realmente inativar esta ação?')) return false"/>
					</rich:column>
										
				</rich:dataTable>
			</f:subview>
		</h:panelGroup>
	</ui:define>		
</ui:composition>