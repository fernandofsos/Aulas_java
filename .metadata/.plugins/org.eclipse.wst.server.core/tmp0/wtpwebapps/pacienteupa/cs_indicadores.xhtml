<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
      
<ui:composition template="template.xhtml">
		
	<ui:define name="conteudo">
		<a4j:keepAlive beanName="indicadorForm" />

		<rich:modalPanel id="panelStatus" autosized="true" >  
 			<h:panelGrid columns="2"> 
 				<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
 				<h:outputText value="Aguarde, calculando..." />
 			</h:panelGrid> 
 		</rich:modalPanel> 

        <rich:modalPanel id="panelEstudos" autosized="true" width="750"  headerClass="headerPanel">  
            <f:facet name="header">
				<h:outputText value="DETALHES"></h:outputText>		
			</f:facet>
			
			<f:facet name="controls">
			     <h:panelGroup>
			     	<h:graphicImage value="IMG/fechar.png" id="fechaPanel" />
			     	<rich:componentControl attachTo="fechaPanel" event="onclick" for="panelEstudos" operation="hide"/>
			     </h:panelGroup>
			</f:facet>
			
			<rich:tabPanel switchType="client">
				<rich:tab label="RESUMO"> 				
				    <div class="quadroDetalhes col320">
				        <div class="tituloDetalhes">
				            <div class="col250">ENTRADAS</div>
				            <div class="col50">#{indicadorForm.clinica.totalEntradas}</div>				            
				        </div>
				        <div style="padding: 4px">
				            <div class="col230 linhaDetalhes">Internações</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdInternacao}</div>
							<br/>
							<div class="col230">Internações do Mesmo Bloco</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdInternacaoMesmoBloco}</div>
							<br/>
							<div class="col230">Internações de Outro Bloco</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdInternacaoOutroBloco}</div>							    
				        </div>
				        <div class="tituloDetalhes">
				            <div class="col250">SAÍDAS</div>
				            <div class="col50">#{indicadorForm.clinica.totalSaidas}</div>				            
				        </div>
				        <div>
				            <div class="col250">Altas</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdAltas}</div>
							<br/>
							<div class="col250">*) Altas menos 24h</div>
							<div class="col50">#{clinica.indicador.qtdAltas24}</div>
							<br/>
							<div class="col250">Transf. Outro Hospital</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdTransferenciaOutroHospital}</div>							    
							<br/>
							<div class="col250">Transf. do Outro Bloco</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdTransferenciaOutroBloco}</div>
							<br/>
							<div class="col250">Transf. para UTI</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdTransferenciaUTI}</div>
							<br/>
							<div class="col250">Obitos 24h</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdObito24}</div>
							<br/>
							<div class="col250">Obitos +24h</div>
							<div class="col50">#{indicadorForm.clinica.indicador.qtdObito25}</div>
				        </div>
				    </div>   

                    <div class="col300">
                    	<rich:dataTable id="tabelaIndicadorUnidade"
							onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
							onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
							value="#{indicadorForm.listaIndicadorUnidade}" 
							var="indicador"					
							style="width: 300px" >					
							<f:facet name="header">
								<rich:columnGroup>
									<h:column>
										<h:outputText value="INDICADOR" />
									</h:column>							
									<h:column>
										<h:outputText value="VALOR" />
									</h:column>								
								</rich:columnGroup>
							</f:facet>
							<rich:column styleClass="fonte12">
								<h:outputText value="#{indicador.descricao}">				
								</h:outputText>
							</rich:column>
							<rich:column styleClass="textoCentralizado">
								<h:outputText value="#{indicador.valor}" styleClass="fonte12">
									<f:convertNumber pattern="##,###.00"/>				
								</h:outputText>				
							</rich:column>
						</rich:dataTable>
                    </div>      
    	    	</rich:tab>
    	    	
        		<rich:tab label="PROCEDÊNCIAS EXTERNAS">          
        			<rich:dataTable id="tabelaEntradas"
						onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
						onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
						value="#{indicadorForm.listaIndicadorUnidade}" 
						var="indicador"					
						style="width: 300px" >					
						<f:facet name="header">
							<rich:columnGroup>
								<h:column>
									<h:outputText value="INDICADOR" />
								</h:column>							
								<h:column>
									<h:outputText value="VALOR" />
								</h:column>								
							</rich:columnGroup>
						</f:facet>
						<rich:column styleClass="fonte12">
							<h:outputText value="#{indicador.descricao}">				
							</h:outputText>
						</rich:column>
						<rich:column styleClass="textoCentralizado">
							<h:outputText value="#{indicador.valor}" styleClass="fonte12">
								<f:convertNumber pattern="##,###.00"/>				
							</h:outputText>				
						</rich:column>
					</rich:dataTable>	  
					<rich:dataGrid>
					    
					</rich:dataGrid>         		
           		</rich:tab>        
           		
        		<rich:tab label="SAÍDAS" >
        			<rich:dataTable id="tabelaSaidas"
						onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
						onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
						value="#{indicadorForm.listaIndicadorUnidade}" 
						var="indicador"					
						style="width: 300px" >					
						<f:facet name="header">
							<rich:columnGroup>
								<h:column>
									<h:outputText value="INDICADOR" />
								</h:column>							
								<h:column>
									<h:outputText value="VALOR" />
								</h:column>								
							</rich:columnGroup>
						</f:facet>
						<rich:column styleClass="fonte12">
							<h:outputText value="#{indicador.descricao}">				
							</h:outputText>
						</rich:column>
						<rich:column styleClass="textoCentralizado">
							<h:outputText value="#{indicador.valor}" styleClass="fonte12">
								<f:convertNumber pattern="##,###.00"/>				
							</h:outputText>				
						</rich:column>
					</rich:dataTable>        					    
        		</rich:tab>
        	
        		
    		</rich:tabPanel>
    	</rich:modalPanel>

		<a4j:form>		
		    <label class="cabAreaPesquisa">INDICADORES</label>	
    		<div class="areaPesquisa">        		    	     
            	<div class="col200">
            	    <label>Pesquisar por:</label>
            	    <div class="col200">
            	        <h:selectOneRadio value="#{indicadorForm.tipoPesquisa}">
            	        	<f:selectItem itemValue="1" itemLabel="Mês/Ano"/>
            	        	<f:selectItem itemValue="2" itemLabel="Período"/>
            	        	<a4j:support event="onclick" reRender="pesqMes"></a4j:support>
            	        </h:selectOneRadio>
            	    </div>
            	 </div>
            	 <div class="col400">   
            	    <h:panelGroup id="pesqMes" layout="block">
						<h:panelGroup layout="block" rendered="#{indicadorForm.tipoPesquisa==1}">
						    <rich:spacer height="10px"/><br/>					    
						    <label>Mês/Ano:</label>  
                			<h:selectOneMenu value="#{indicadorForm.mesAnoSelecionado}" 
                			                 styleClass="selectItens" style="margin-right: 10px" id="mesAno">
                			     <f:selectItems value="#{indicadorForm.sliMeses}"/>                			     
                			</h:selectOneMenu>  
                			<a4j:commandButton image="IMG/pesquisa.gif" 
                			                   action="#{indicadorForm.lerIndicadores}"
		    								   reRender="tabelaCenso,tabelaIndicador,cabResumo" 
		    								   style="vertical-align: middle;"/>	              		
                		</h:panelGroup>                		
                		<h:panelGroup layout="block" rendered="#{indicadorForm.tipoPesquisa==2}"> 
                            <rich:spacer height="10px"/><br/>              		    
                		    <label>Período:</label>
                			<rich:calendar datePattern="dd/MM/yyyy" value="#{indicadorForm.dataInicial}" />                	
                			<rich:calendar datePattern="dd/MM/yyyy"  value="#{indicadorForm.dataFinal}"/>                			
                			<a4j:commandButton image="IMG/pesquisa.gif"  
                			                   action="#{indicadorForm.lerIndicadores}"
		    								   reRender="tabelaCenso,tabelaIndicador,cabResumo" 
		    								   style="vertical-align: middle;"/>
                		</h:panelGroup>
                	</h:panelGroup>                	
            	</div>            
    		</div>	
					
			<div>
				<rich:dataTable id="tabelaCenso"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{indicadorForm.listaCenso}" 
					var="censo"										 
					style="width: 810px">
					
					<f:facet name="header">
						<rich:columnGroup>
							<h:column>
								<h:outputText value="Clinica" />
							</h:column>							
							<h:column>
								<h:outputText value="Paciente Dia" />
							</h:column>
							<h:column>
								<h:outputText value="Total Entradas" />
							</h:column>
							<h:column>
								<h:outputText value="Total Saidas" />
							</h:column>
							<h:column>
								<h:outputText value="Total Leitos" />
							</h:column>								
							<h:column>
								<h:outputText value="---" />
							</h:column>		
						</rich:columnGroup>
					</f:facet>
					<rich:column style="background-color: #E6E6E6">						
						<h:outputText value="BLOCO #{censo.descricao}" styleClass="fonte12 fonteNegrito"/>
					</rich:column>
					
					<rich:column styleClass="fonte12 textoCentralizado" style="background-color: #E6E6E6">				
						<h:outputText value="#{censo.totalPaciente}" styleClass="fonte12 fonteNegrito">
							<f:convertNumber pattern="##,###"/>
						</h:outputText>
					</rich:column>
				
					<rich:column styleClass="fonte12 textoCentralizado" style="background-color: #E6E6E6">
						<h:outputText value="#{censo.totalEntradas}" styleClass="fonte12 fonteNegrito">
							<f:convertNumber pattern="##,###"/>
						</h:outputText>   
					</rich:column>
					
					<rich:column styleClass="fonte12 textoCentralizado" style="background-color: #E6E6E6">
						<h:outputText value="#{censo.totalSaidas}" styleClass="fonte12 fonteNegrito">
							<f:convertNumber pattern="##,###"/>
						</h:outputText>
					</rich:column>
					
					<rich:column styleClass="fonte12 textoCentralizado" style="background-color: #E6E6E6">
						<h:outputText value="#{censo.indicador.qtdLeitos}" styleClass="fonte12 fonteNegrito">
							<f:convertNumber pattern="##,###"/>
						</h:outputText>
					</rich:column>
					
					<rich:column styleClass="textoCentralizado" style="background-color: #E6E6E6">
						<h:graphicImage value="IMG/detalhes.png"></h:graphicImage>						
						<rich:toolTip layout="block" direction="top-left" mode="client">
							<div style="width: 310px; text-align: left;">
							    <div class="tituloTooltipCenso">CENSO - BLOCO</div>
							    <label class="fonteNegrito">ENTRADAS</label>
							    <div class="col250">Internaçoes</div>
							    <div class="col50">#{censo.indicador.qtdInternacao}</div>
							    <br/>
							    <div class="col250">Internaçoes de Outro Bloco</div>
							    <div class="col50">#{censo.indicador.qtdInternacaoOutroBloco}</div>
							    <label class="fonteNegrito">SAÍDAS</label>
							    <div class="col250">Altas</div>
							    <div class="col50">#{censo.indicador.qtdAltas}</div>
							    <br/>
							    <div class="col250">Transf. Outro Hospital</div>
							    <div class="col50">#{censo.indicador.qtdTransferenciaOutroHospital}</div>							    
							    <br/>
							    <div class="col250">Transf. do Outro Bloco</div>
							    <div class="col50">#{censo.indicador.qtdTransferenciaOutroBloco}</div>
							    <br/>
							    <div class="col250">Transf. para UTI</div>
							    <div class="col50">#{censo.indicador.qtdTransferenciaUTI}</div>
							    <br/>
							    <div class="col250">Obitos 24h</div>
							    <div class="col50">#{censo.indicador.qtdObito24}</div>
							    <br/>
							    <div class="col250">Obitos +24h</div>
							    <div class="col50">#{censo.indicador.qtdObito25}</div>
							</div>
						</rich:toolTip>				
					</rich:column>
					
					<rich:subTable var="clinica" value="#{censo.subItens}">				    
						<rich:column  styleClass="fonte12">
						    <a4j:commandLink action="#{indicadorForm.selecionarClinica()}"
						                     oncomplete="#{rich:component('panelEstudos')}.show()" 
						                     reRender="panelEstudos" style="font-size: 12px">
								<h:outputText value="#{clinica.descricao}" />
								<f:setPropertyActionListener value="#{clinica.descricao}" target="#{indicadorForm.clinicaSelecionada}"/>
								<f:setPropertyActionListener value="#{clinica}" target="#{indicadorForm.clinica}"/>
							</a4j:commandLink>							
						</rich:column>				
						<rich:column styleClass="fonte12 textoCentralizado">
					    	<h:outputText value="#{clinica.totalPaciente}" >
					    		<f:convertNumber pattern="##,###"/> 
					    	</h:outputText>					    						    									    	
						</rich:column>							
						<rich:column styleClass="fonte12 textoCentralizado">
							<h:outputText value="#{clinica.totalEntradas}" >
								<f:convertNumber pattern="##,###"/>
							</h:outputText>																			
						</rich:column>				
						<rich:column styleClass="fonte12 textoCentralizado">
							<h:outputText value="#{clinica.totalSaidas}" >
								<f:convertNumber pattern="##,###"/>
							</h:outputText>																									
						</rich:column>						
						<rich:column styleClass="fonte12 textoCentralizado">
							<h:outputText value="#{clinica.indicador.qtdLeitos}" >
								<f:convertNumber pattern="##,###"/>
							</h:outputText>																									
						</rich:column>
						<rich:column styleClass="textoCentralizado">
							<h:graphicImage value="IMG/detalhes.png"></h:graphicImage>	
							<rich:toolTip layout="block" direction="top-left" mode="client">
							<div style="width: 310px; text-align: left;">
							    <div class="tituloTooltipCenso">CENSO - #{clinica.descricao}</div>
							    <div class="fonteNegrito">ENTRADAS</div>
							    <div class="col250">Internaçoes</div>
							    <div class="col50">#{clinica.indicador.qtdInternacao}</div>
							    <br/>
							    <div class="col250">Internações do Mesmo Bloco</div>
							    <div class="col50">#{clinica.indicador.qtdInternacaoMesmoBloco}</div>
							    <br/>
							    <div class="col250">Internaçoes de Outro Bloco</div>
							    <div class="col50">#{clinica.indicador.qtdInternacaoOutroBloco}</div>
							    
							    <div class="fonteNegrito">SAÍDAS</div>
							    <div class="col250">Altas</div>
							    <div class="col50">#{clinica.indicador.qtdAltas}</div>
							    <br/>
							    <div class="col250">*) Altas menos 24h</div>
							    <div class="col50">#{clinica.indicador.qtdAltas24}</div>
							    <br/>
							    <div class="col250">Transferencias para Outro Hospital</div>
							    <div class="col50">#{clinica.indicador.qtdTransferenciaOutroHospital}</div>
							    <br/>
							    <div class="col250">Transferencias do Mesmo Bloco</div>
							    <div class="col50">#{clinica.indicador.qtdTransferenciaMesmoBloco}</div>							    
							    <br/>
							    <div class="col250">Transferencias do Outro Bloco</div>
							    <div class="col50">#{clinica.indicador.qtdTransferenciaOutroBloco}</div>
							    <br/>
							    <div class="col250">Transf. para UTI</div>
							    <div class="col50">#{clinica.indicador.qtdTransferenciaUTI}</div>
							    <br/>
							    <div class="col250">Obitos 24h</div>
							    <div class="col50">#{clinica.indicador.qtdObito24}</div>
							    <br/>
							    <div class="col250">Obitos +24h</div>
							    <div class="col50">#{clinica.indicador.qtdObito25}</div>							    
							</div>
						</rich:toolTip>							
						</rich:column>
					</rich:subTable>
										
					<f:facet name="footer">
                		<rich:columnGroup>                			
                   			<rich:column>                    			
                    			<h:outputText value="TOTAL HOSPITAL"/>                    			
                   			</rich:column>
                    			
                        	<rich:column styleClass="fonte12 textoCentralizado">
                            	<h:outputText value="#{indicadorForm.totalHospital.pacienteDia}">
                            		<f:convertNumber pattern="##,###"/>
                            	</h:outputText>
                        	</rich:column>
                        	<rich:column styleClass="fonte12 textoCentralizado">
                            	<h:outputText value="#{indicadorForm.totalHospital.entradas}">
                            		<f:convertNumber pattern="##,###"/>
                            	</h:outputText>
                        	</rich:column>
                        	<rich:column styleClass="fonte12 textoCentralizado">
                            	<h:outputText value="#{indicadorForm.totalHospital.saidas}">
                            		<f:convertNumber pattern="##,###"/>
                            	</h:outputText>
                        	</rich:column>  
                        	<rich:column styleClass="fonte12 textoCentralizado">
                            	<h:outputText value="#{indicadorForm.totalHospital.leitos}">
                            		<f:convertNumber pattern="##,###"/>
                            	</h:outputText>
                        	</rich:column>
                        	<rich:column styleClass="textoCentralizado">
								<h:graphicImage value="IMG/detalhes.png"></h:graphicImage>											
							</rich:column>                      
                		</rich:columnGroup>
                	</f:facet>				
				</rich:dataTable>
			</div>
			<br/>
			<h:panelGroup id="cabResumo"  layout="block" styleClass="tituloResumoIndicador">
				<label>RESUMO DO HOSPITAL</label>
			</h:panelGroup>
			<rich:dataTable id="tabelaIndicador"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{indicadorForm.listaIndicadorGeral}" 
					var="indicador"					
					rowKeyVar="linha"
					style="width: 810px">					
			
				<f:facet name="header">
					<rich:columnGroup>
						<h:column>
							<h:outputText value="INDICADOR" />
						</h:column>							
						<h:column>
							<h:outputText value="VALOR" />
						</h:column>
						<!-- <h:column>
							<h:outputText value="META" />
						</h:column>					
						<h:column>
							<h:outputText value="DESEMPENHO" />
						</h:column>  -->		
					</rich:columnGroup>
				</f:facet>
					
				<rich:column styleClass="fonte12">
					<h:outputText value="#{indicador.descricao}">				
					</h:outputText>
				</rich:column>
					
				<rich:column styleClass="textoCentralizado">
					<h:outputText value="0.00" styleClass="fonte12" rendered="#{indicador.valor == 0}"/>
					<h:outputText value="#{indicador.valor}" styleClass="fonte12" rendered="#{indicador.valor != 0}">
						<f:convertNumber pattern="##,###.00"/>		
					</h:outputText>				
				</rich:column>
				
				<!-- <rich:column styleClass="textoCentralizado">
					<h:outputText value="#{indicador.meta}">
						<f:convertNumber pattern="##,###.00"/>				
					</h:outputText>				
				</rich:column>
				
				<rich:column styleClass="textoCentralizado">
					<h:outputText value="#{indicador.desempenho}">
						<f:convertNumber pattern="##,###.00"/>					
					</h:outputText>				
				</rich:column> -->			
			</rich:dataTable>
			<br/>
			<br/>
			<br/>
			<a4j:status id="status" 
                onstart="#{rich:component('panelStatus')}.show()"  
                onstop="#{rich:component('panelStatus')}.hide()" >
 			</a4j:status>
 	
			<script type="text/javascript">
	    	 	function avisosPesquisa(tipo) {
		    		if (tipo==1) {
			    		alert("Digite pelo menos 3 letras ou numeros.");
		     		} else if (tipo==2) {
		    			alert("Não há pacientes cadastrados que atendam a esta pesquisa.");
		     		}
	     		}
			</script>
	</a4j:form>	
</ui:define>
</ui:composition>
</html>