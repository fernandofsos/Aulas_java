<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
<head>
	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
	<script src="SCRIPTS/mascara.js" type="text/javascript"></script>
</head>

<ui:composition template="template.xhtml">
	<rich:modalPanel id="panelStatus" autosized="true">  
	 		<h:panelGrid columns="2"> 
	 			<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
	 			<h:outputText value="Carregando..." />
	 		</h:panelGrid> 
	</rich:modalPanel>
	
	<ui:define name="headHtml">	
	</ui:define>
	<ui:define name="conteudo">
		<a4j:keepAlive beanName="geralForm" />
		<a4j:keepAlive beanName="emergenciaForm" />
		
		<h:form id="formGeral">
		<div id="geral">    
		    <div class="tituloPagina">DADOS DO PACIENTE</div>	    	
   			<div class="quadroPaciente">			
				<div>
			   		<label>Nome do Paciente:</label><br />
			   		<h:outputText id="nmPaciente" value="#{geralForm.objPaciente.dscNome}" 
			   		              styleClass="campoVazio" ></h:outputText>
				</div>
				<div>
			   		<label>Nome da Mãe:</label><br />
			   		<h:outputText id="nmMae" value="#{geralForm.objPaciente.dscMae}" 
			   		        styleClass="campoVazio col385" ></h:outputText>
				</div>	

				<div style="margin-right: 12px">				
		   			<label>Sexo:</label><br />
					<h:outputText value="#{geralForm.objPaciente.sexo.dscSexo}" styleClass="campoVazio col70" />
				</div>
				<div style="margin-right: 13px">
				    <label>Data Nascimento:</label><br />						
					<h:outputText value="#{geralForm.objPaciente.idade}" styleClass="campoVazio col220" />								
				</div>
				<div>
				    <label>Prontuario:</label><br />
					<h:outputText value="#{geralForm.objPaciente.numProntuario} " styleClass="campoVazio col70" />
				</div>
			
	  		</div>
    		<br/>    		
    		<div id="botoes" style="text-align: center">
    			<h:commandButton id="btnImprimirEtiqueta" 
    				value="Imprimir Etiqueta" 
    				styleClass="botaoModal100" 
    				style='margin-right: 10px'
    				onclick="document.getElementById('formGeral:cmdImprimirEtiqueta').click(); return false">
				</h:commandButton>
				<h:commandLink id="cmdImprimirEtiqueta" 
					style="display:none" 
					action="#{geralForm.imprimirEtiqueta}" 
					target="_blank">
				</h:commandLink>
		  	    <h:commandButton id="btnVoltar" 
			  	    value="Voltar"
			  	    styleClass="botaoModal100"
		  			action="csGeral_csPaciente" >		  			
		  		</h:commandButton>
    		</div>
    		<br/>
    		
       		<rich:dataTable id="tblEmergencia"
							onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
			           		onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
							value="#{geralForm.lstHistorico}" 
							var="emergencia" 
							rowKeyVar="linha" 
							style="width:100%;" 
							reRender="ds">
					
					<f:facet name="header">
						<rich:columnGroup>
							<rich:column colspan="10"><h:outputText value="HISTÓRICO DAS EMERGÊNCIAS" /></rich:column>
							<rich:column  breakBefore="true"><h:outputText value="N° Aten" /></rich:column>	
							<rich:column><h:outputText value="Data Entrada" /></rich:column>
							<rich:column><h:outputText value="Hora Entrada" /></rich:column>
							<rich:column><h:outputText value="Referência" /></rich:column>
							<rich:column><h:outputText value="Risco" /></rich:column>					
							<rich:column><h:outputText value="Guia" /></rich:column>
							<rich:column><h:outputText value="Trans." /></rich:column>	
							<rich:column><h:outputText value="Sepse" /></rich:column>		
							<rich:column><h:outputText value="Regulação" /></rich:column>		
							<rich:column><h:outputText value="Movim." /></rich:column>
						</rich:columnGroup>
					</f:facet>
					
					
					<rich:column width="5%">
						<h:outputText value="#{emergencia.isnInternacao}" />
					</rich:column>
					
						
					<rich:column>
						<h:outputText value="#{emergencia.datCadastro}" >
							<f:convertDateTime pattern="dd/MM/yyyy" />
						</h:outputText>
					</rich:column>
					
					<rich:column>
						<h:outputText value="#{emergencia.horChegada}" />
					</rich:column>
																
					<rich:column>
						<h:outputText value="#{emergencia.dscReferencia}" />
					</rich:column>
					
					<rich:column>
					   <center>
						  <h:graphicImage value="#{emergencia.dscRisco}" rendered="#{emergencia.dscRisco != '---'}"/>
						  <h:outputText value="#{emergencia.dscRisco}"  rendered="#{emergencia.dscRisco == '---'}"/>
					   </center>	
					</rich:column>
					
					<rich:column>
						<center>
							<a4j:commandLink id="atendimento"
								action="#{emergenciaForm.validaImpressao}"
								title="IMPRIMIR IDENTIFICAÇÃO DO PACIENTE"
								oncomplete="errosPagina(#{emergenciaForm.codigoErro});">
								<h:graphicImage id="imgAtendimento" url="IMG/impressora.png"
									style="border:0;" />
								<f:setPropertyActionListener value="#{emergencia.isnInternacao}"
									target="#{emergenciaForm.isnInternacao}" />
							</a4j:commandLink>
							
						</center>
					</rich:column>
					
					<rich:column>
					<center>
						<t:commandLink id="transf" action="#{emergenciaForm.relatorioTranf}" rendered="#{emergencia.intTrans > 0}" target="_blank" title="IMPRIMIR INTERNAÇÃO TRANSFERÊNCIA">
							<h:graphicImage id="imgTransf" url="IMG/impressora.png" style="border:0;" />
							<f:setPropertyActionListener value="#{emergencia.isnInternacao}" target="#{emergenciaForm.isnInternacao}" />
						</t:commandLink>
					</center>
					</rich:column>
					
					<rich:column>
					<center>
						<a4j:commandLink id="printSepse" 
							reRender="tblSepse" 							
							oncomplete="Richfaces.showModalPanel('modalSepse');"  action="#{emergenciaForm.carregarProtocoloSepseByIsnInternacao}" title="IMPRIMIR PROTOCOLO SEPSE">
							<h:graphicImage id="imgSepsePrint" url="IMG/impressora.png" style="border:0;" />							
							
							<f:setPropertyActionListener value="#{emergencia.isnInternacao}" target="#{emergenciaForm.isnInternacao}" /> 
						</a4j:commandLink>
					</center>
					</rich:column>
					
					<rich:column>
						<center>
							<t:commandLink id="regulacaoId" action="#{geralForm.relatorioRegulacao}" rendered="#{emergencia.internacaoTransBean.flgRegulacao != null and emergencia.internacaoTransBean.flgRegulacao == 'S'}" target="_blank" title="IMPRIMIR REGULAÇÃO DO PACIENTE">
								<h:graphicImage id="imgRegulacaoId" url="IMG/impressora.png" style="border:0;" />
								<f:setPropertyActionListener value="#{emergencia.internacaoTransBean.isnInternacaoTrans}" target="#{geralForm.isnInternacaoTrans}" />							
							</t:commandLink>
						</center>
					</rich:column>
					
					<rich:column>
						<center>
							<a4j:commandLink id="Emergencia" title="Histórico da movimentação Emergência" 
							               action="#{emergenciaForm.irHistorioMovPaciente}" oncomplete="errosPagina(#{emergenciaForm.codigoErro})">
								<h:graphicImage id="imgLeito" url="IMG/leito.png" style="border:0;" />
								<f:setPropertyActionListener value="#{emergencia.isnInternacao}" target="#{movLeitoTransporteForm.isnInternacao}"/>
								<f:setPropertyActionListener value="#{geralForm.objPaciente}" target="#{movLeitoTransporteForm.objPaciente}"/>	
							</a4j:commandLink>
						</center>
					</rich:column>

					<f:facet name="footer">
					</f:facet>
				</rich:dataTable>
        	        	<t:commandLink style="display:none;" id="relGeral"
								value="relgeral" target="_blank"
								action="#{emergenciaForm.relatorioGeral}" />
								
		<rich:modalPanel id="modalSepse" headerClass="headerPanel3" width="1280" height="550" style="overflow: auto" autosized="false">
			<f:facet name="header">
			<h:panelGroup>
       			<h:outputText value="Lista de SEPSE"></h:outputText>
       		</h:panelGroup>
	    	</f:facet>
	    	<f:facet name="controls">
	    	 	<h:panelGroup>
	        		<h:graphicImage value="IMG/fechar.png" id="fechaPanelPrint"/>
	        		<rich:componentControl for="modalSepse" attachTo="fechaPanelPrint" operation="hide" event="onclick" />
	        	</h:panelGroup>
	    	</f:facet>
			<h:panelGrid >
				        		<rich:dataTable id="tblSepse"
												onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
								           		onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
												value="#{emergenciaForm.listProtocoloSepse}" 
												var="sepse"
												style="width:100%; height: 600px; overflow: scroll;"
												rows="5" 
												reRender="dsProtocoloSepse">
												
										<f:facet name="header">
											<rich:columnGroup>
												<rich:column style="text-align: center;width: 5%;">
													Suspeita de Infecção
												</rich:column>
												<rich:column style="text-align: center;width: 20%;">
													Paciente com sinais de alerta para Infecção!
												</rich:column>
												<rich:column style="text-align: center;width: 10%;">
													Paciente apresenta sinais de disfunção orgânica ou choque séptico?
												</rich:column>
												<rich:column style="text-align: center;width: 5%;">
													Data/Hora abertura
												</rich:column>
												<rich:column style="text-align: center;width: 10%;">
													Profissional
												</rich:column>
												<rich:column style="text-align: center;width: 45%;">
													Abertura do Protocolo SEPSE
												</rich:column>
												<rich:column style="text-align: center;width: 5%;">
													Ações
												</rich:column>
											</rich:columnGroup>
										</f:facet>										
										<rich:column style="text-align: left;">
									        <h:outputText value="Sim" rendered="#{sepse.suspeitaInfeccao == true}"/>
									        <h:outputText value="Não" rendered="#{sepse.suspeitaInfeccao == false}"/>
										</rich:column>
										<rich:column style="text-align: left;">
											<a4j:outputPanel rendered="#{sepse.suspeitaInfeccao == true}">
												<h:outputText value="Infecção Respiratória" rendered="#{sepse.codTela1 == 1}" style="font-size: 11px;"/>
								        		<h:outputText value="Infecção Urinária" rendered="#{sepse.codTela1 == 2}" style="font-size: 11px;"/>
								        		<h:outputText value="Infecção Abdominal Aguda" rendered="#{sepse.codTela1 == 3}" style="font-size: 11px;"/>
								        		<h:outputText value="Infecção de Pele e Partes Moles" rendered="#{sepse.codTela1 == 4}" style="font-size: 11px;"/>
								        		<h:outputText value="S/ foco Definido" rendered="#{sepse.codTela1 == 5}" style="font-size: 11px;"/>
								        		<h:outputText value="Não tem história sugestiva de infecção" rendered="#{sepse.codTela1 == 6}" style="font-size: 11px;"/>
								        		<h:outputText value="Infecção do Sistema Nervoso Central (SNC)" rendered="#{sepse.codTela1 == 7}" style="font-size: 11px;"/>
								        		<strong><h:outputText value="OUTROS:" rendered="#{sepse.codTela1 == 8}" style="font-size: 11px;"/></strong>
								        		<h:outputText value="#{sepse.outrosSinaisAlerta}" rendered="#{sepse.codTela1 == 8}" style="font-size: 11px;"/>
							        		</a4j:outputPanel>					        		
										</rich:column>
										<rich:column style="text-align: left;">
											<a4j:outputPanel>
												<h:outputText value="#{sepse.strProtocoloSepseSinaisResp}" escape="false" style="font-size: 11px;"/>
											</a4j:outputPanel>
										</rich:column>
										<rich:column>									
											<h:outputText value="#{sepse.datCadastro}" >
												<f:convertDateTime pattern="dd/MM/yyyy HH:mm" timeZone="GMT-3" />
											</h:outputText> 
										</rich:column>
										<rich:column>									
											<h:outputText value="#{sepse.profissional.dscUsuario}" />
										</rich:column>
										<rich:column style="text-align: left;">
										    <h:outputText style="margin-left:5px; font-size:11px; font-weight: bold;" value="PA:"/>
										    <h:outputText style="margin-left:5px; font-size:11px;" value="#{sepse.dscPa} X #{sepse.dscPaFinal} mmHg" rendered="#{not empty sepse.dscPa}"/>
										    <h:outputText style="margin-left:5px; font-size:11px; font-weight: bold;" value="Peso:"/>
										    <h:outputText style="margin-left:5px; font-size:11px;" value="#{sepse.peso}"/>
										    <h:outputText style="margin-left:5px; font-size:11px; font-weight: bold;" value="Volume:"/>
										    <h:outputText style="margin-left:5px; font-size:11px;" value="#{sepse.volume}"/>
										    <h:outputText style="margin-left:2px; font-size:11px; font-weight: bold;" value="ml"/>
											<div style="clear:both"/>										    
										    <h:outputText style="margin-left:5px; font-size:11px; font-weight: bold;" value="Sepse Grave: "/>
										    <h:outputText style="font-size:11px;" value=" Sim" rendered="#{sepse.flgSepseGrave}"/>
										    <h:outputText style="font-size:11px;" value=" Não" rendered="#{!sepse.flgSepseGrave}"/>
										    <h:outputText style="margin-left:5px; font-size:11px; font-weight: bold;" value=" | Choque Séptico: "/>
										    <h:outputText style="font-size:11px;" value=" Sim" rendered="#{sepse.flgChoqueSeptico}"/>
										    <h:outputText style="font-size:11px;" value=" Não" rendered="#{!sepse.flgChoqueSeptico}"/>
										    										    											    
											<div style="clear:both"/>
										    <h:outputText style="margin-left:5px; font-size:11px; font-weight: bold;" value="Exames:"/>
				    						<div style="height: 140px; overflow:scroll;overflow-y:scroll;overflow-x:hidden;">
												<rich:dataTable id="tblExamesSepse"
													value="#{sepse.exames}"
													rendered="#{not empty sepse.exames}"
													var="emergenciaExame" 
													rowKeyVar="linha" 
													style="width:98%;">
										
													<f:facet name="header">
														<rich:columnGroup>									
															<rich:column style="text-align: center;width: 10%">
																Solicitação
															</rich:column>
															<rich:column style="text-align: center;width: 15%">
																Data
															</rich:column>
															<rich:column style="text-align: center;width: 40%">
																Exame
															</rich:column>
															<rich:column style="text-align: center;width: 15%">Situação</rich:column>									
															<!--<rich:column style="text-align: center;width: 5%">Imprimir Laudo</rich:column>-->
														</rich:columnGroup>
													</f:facet>
													
													<rich:columnGroup>
														<rich:column style="text-align: center;">
															<h:outputText value="#{emergenciaExame.isnExameSolicAux}"/>
														</rich:column>
														
														<rich:column style="text-align: center;">
															<h:outputText value="#{emergenciaExame.datCadastro}" converter="ConversorDeDataHora"/>
														</rich:column>
																		
														<rich:column style="text-align: left;">
														  <h:outputText  value="#{emergenciaExame.examePepBean.dscExame}"/> <h:outputText  value=" #{emergenciaExame.dscExameCompl}" rendered="#{emergenciaExame.dscExameCompl != null and not empty emergenciaExame.dscExameCompl}"/>
														</rich:column>				
						
														<rich:column style="text-align: center;">
															<h:outputText  value="#{emergenciaExame.exameSituacaoPepBean.dscExameSituacao}"/>
														</rich:column>	
													</rich:columnGroup>					
												</rich:dataTable>	
											</div>						
										</rich:column>									
										<rich:column>									
											<h:panelGroup id="imprimirSepse">
												<t:commandLink id="imprimirAberturaSepseIndividual" action="#{emergenciaForm.printAberturaSepse(sepse)}" target="_blank" style="float: right;margin-right: 5px;">
													<f:setPropertyActionListener value="#{emergencia.isnInternacao}" target="#{emergenciaForm.isnInternacao}" /> 
													<f:setPropertyActionListener value="#{sepse.strProtocoloSepseSinaisResp}" target="#{emergenciaForm.strProtocoloSepseSinaisResp}" />								
													<h:graphicImage id="imgAtendimento" url="IMG/impressora.png" style="border:0;width:20px;height:20px;" title="IMPRIMIR FORMULÁRIO DE ABERTURA"/>
												</t:commandLink>
											</h:panelGroup>
										</rich:column>
										<f:facet name="footer">
											<rich:datascroller id="dsProtocoloSepse" ajaxSingle="false" />
										</f:facet>
								</rich:dataTable>
								
																				
							</h:panelGrid>
							<div style="text-align: center;">
									<h:commandButton styleClass="botaoModal" onclick="Richfaces.hideModalPanel('modalSepse');" value="FECHAR" /> 
							</div>
		</rich:modalPanel> 
	</div>
	
	<script type="text/javascript">
	    var corOriginal;
		function gerarRelatorio(p1,p2,server) {
			window.open(server+"/relatorios/GeraRelMovPaciente?p1=" + p1 + "&amp;p2=" + p2,"relatorio","width=800,height=600");
		}
		
		function gerarRelatorioEmergencia(p1,p2,server) {
			window.open(server+"/relatorios/EmergenciaExame?p1=" + p1 + "&amp;p2=" + p2,"relatorio","width=800,height=600");
		}
		 
		function errosPagina(erro) {
		   if (erro == 1) {
		      alert("ATENÇÃO: Paciente já possui uma internação em aberto!");
		      return false;
		   } if(erro == 2){
			   window.alert("Usuário sem permissão!");
			   return false;
		   }else{
			   document.getElementById(
				'formGeral:relGeral').click();
		   }
		}
		
		function  setCorLinha(linha, over) {		   
		   if (over) {
		      corOriginal = linha.style.backgroundColor;
		   	  linha.style.backgroundColor = '#F1F1F1';
		   } else {
		      linha.style.backgroundColor = corOriginal;
		   }
		}
	</script>  
	<a4j:status id="statusPanel"  
           onstart="Richfaces.showModalPanel('panelStatus');" 
           onstop="#{rich:component('panelStatus')}.hide()" >
	</a4j:status>
</h:form>
</ui:define>
</ui:composition>
</html>