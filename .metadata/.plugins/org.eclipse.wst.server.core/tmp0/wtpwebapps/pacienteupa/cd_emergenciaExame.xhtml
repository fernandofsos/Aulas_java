<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:t="http://myfaces.apache.org/tomahawk"
      xmlns:rich="http://richfaces.org/rich">

<ui:composition template="template.xhtml">
    <ui:define name="headHtml">
    	<!-- cd_emergenciaExame.xhtml -->
		<meta http-equiv="cache-control" content="no-cache" />
		<meta http-equiv="pragma" content="no-cache" />
		<script type="text/javascript" src="SCRIPTS/maskbrphone.js"></script>
	</ui:define>  
	<ui:define name="conteudo">
		<a4j:keepAlive beanName="emergenciaExameForm" />
		
		<rich:modalPanel id="panelStatus" autosized="true" >  
	 		<h:panelGrid columns="2"> 
	 			<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
	 			<h:outputText value="Carregando..." />
	 		</h:panelGrid> 
	 	</rich:modalPanel>
		
<rich:modalPanel id="panPlanoSaude" autosized="false" width="900" height="500" resizeable="false" headerClass="headerPanel3">
	<f:facet name="header">
		<h:panelGroup>
			<h:outputText value="Pesquisa de Plano de Saúde" />
		</h:panelGroup>
	</f:facet>
	<f:facet name="controls">
		<h:panelGroup>
			<h:graphicImage value="IMG/fechar.png" id="fechaPanel" />
			<rich:componentControl for="panPlanoSaude" attachTo="fechaPanel" operation="hide" event="onclick" />
		</h:panelGroup>
	</f:facet>
	<h:form id="formPlanoSaude">
		<fieldset style="background-color: #F5F5F5">
			<div>
				<div class="colLeft">
					<h:panelGrid columns="2">
						<h:outputLabel value="Buscar por:" />
					    <h:selectOneRadio id="radioPlanoSaude" value="#{emergenciaExameForm.tipoBuscaPlanoSaude}">
							<f:selectItem itemLabel="Razão Social" itemValue="1" />
							<f:selectItem itemLabel="Nome Fantasia" itemValue="2" />
							<a4j:support actionListener="#{emergenciaExameForm.mudaTipoBusca}"
					             		event="onchange" 
					             		ajaxSingle="true" oncomplete="focoNmPlanoSaude()" />
						</h:selectOneRadio>
					</h:panelGrid>
				</div>
				<br style="clear:both" />
				<h:panelGrid columns="2">
					<h:inputText value="#{emergenciaExameForm.dscPlanoSaude}" maxlength="50"
						styleClass="campoTexto largura200"
						onblur="this.value.toUpperCase();" style="width: 450px;"
						id="nmPlanoSaude" onkeypress="return enter(event);" />
					<a4j:commandButton styleClass="botaoModal"
										oncomplete="validaPlanoSaude('#{emergenciaExameForm.msgPlanoSaude}');"
										id="Pesquisar" value="PESQUISAR"
										action="#{emergenciaExameForm.pesquisarPlanoSaude}"
										reRender="formPlanoSaude" />
				</h:panelGrid>
			</div>
		</fieldset>
		<div>
			<rich:dataTable id="tabelaPlanoSaude"
							onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
							onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
							value="#{emergenciaExameForm.listaPlanoSaude}" var="rst" rows="10"
							rowKeyVar="linha" style="width: 100%; cursor: pointer;">
				<f:facet name="header">
					<rich:columnGroup>
						<h:column>
							<h:outputText width="5%" />
						</h:column>
						<h:column>
							<h:outputText value="Razão Social" />
						</h:column>
						<h:column>
							<h:outputText value="Nome Fantasia" />
						</h:column>
					</rich:columnGroup>
				</f:facet>
				<rich:column align="center" width="5%" sortable="true">
					<a4j:commandLink reRender="pnPlanoSaude" oncomplete="#{rich:component('panPlanoSaude')}.hide()">
						<h:graphicImage id="imgSelecionar" url="IMG/selecionar.png" style="border:0;" />
						<f:setPropertyActionListener value="#{rst}" target="#{emergenciaExameForm.objPlanoSaude}" />
						<f:setPropertyActionListener value="#{rst.isnPlanoSaude}" target="#{emergenciaExameForm.isnPlanoSaude}" />
					</a4j:commandLink>
				</rich:column>
				<rich:column sortable="true">
					<h:outputText value="#{rst.dscRazaoSocial}" />
				</rich:column>
				<rich:column sortable="true">
					<h:outputText value="#{rst.dscNomeFantasia}" />
				</rich:column>
				<f:facet name="footer">
					<rich:datascroller id="ds" ajaxSingle="false" />
				</f:facet>
			</rich:dataTable>
		</div>
		<script>
			function validaPlanoSaude(msg) {
				var n = msg.search('sucesso!');
				if (msg != '') {
					if (n == -1) {
						alert(msg);
						return false;
					} else {
						alert(msg);
						return true;
					}
				} else {
					return true;
				}
			}

			function enter(e) {
				var keycode;
				if (window.event) {
					keycode = window.event.keyCode;
				} else {
					keycode = e.which;
				}
				if (keycode == 13) {
					alert('Não é possível utilizar a tecla Enter');
					return false;
				}
			}
		</script>
	</h:form>
</rich:modalPanel>

	
<h:form id="cdEmergenciExame">

	<h:commandLink style="display:none" id="cmdImprimirEtiqueta"  value="Imprimir etiqueta" action="imprimirEtiqueta" target="_blank"></h:commandLink>

	<div>
		<table class="tablePaginaPaciente">
		<tr>
			<td class="tdTitulo">EMERGÊNCIA</td>
			<td class="tdCampos">
				<table style="width:100%">
				<tr>
					<td>
						<h:outputLabel value="Nº PRONTUÁRIO" />
						<h:outputText id="txtProntuario" value="#{emergenciaExameForm.objPaciente.numProntuario}" styleClass="campoVazio" style="width:100px" />
					</td>
					<td>
						<h:outputLabel value="ÚLTIMO LEITO" />
						<h:outputText value="#{emergenciaExameForm.objPaciente.leitoAtual}"  styleClass="campoVazio" style="width:100px" />
					</td>
					<td>
						<h:outputLabel value="DATA CADASTRO" />
						<h:outputText id="txtDataCadastro" value="#{emergenciaExameForm.objPaciente.datCadastro}" styleClass="campoVazio" style="width:100px; font-weight:bold" >
							<f:convertDateTime datePattern="dd/MM/yyyy" />			   
						</h:outputText>
					</td>
					<td>
				   	    <rich:spacer height="18" style="display:block"/>
				   	    <div class="col70 campoVazio" style="display:#{(emergenciaExameForm.objPaciente.flgVre=='S')?'inline':'none'}">
			        		<h:graphicImage value="IMG/iconeCCIH.png" alt="CCIH" rendered="#{emergenciaExameForm.objPaciente.flgVre=='S'}"/>
			        	</div>
					</td>
				</tr>
				</table>
			</td>
		</tr>
		</table>
		<table class="tablePaginaPaciente">
		<tr>
			<td valign="top">
				<fieldset class="fsPaginaPaciente">
		 			<legend>DADOS PESSOAIS</legend>
		 			<div style="margin:0 auto 0 auto; width:695px; float:none;">
			 			<div>
							<h:outputLabel value="PACIENTE" /><br />
						   	<h:outputText id="nmPaciente" value="#{emergenciaExameForm.objPaciente.dscNome}" styleClass="campoVazio"  />
						</div>
						<div>
							<h:outputLabel value="DATA NASCIMENTO" /><br />						
							<h:outputText value="#{emergenciaExameForm.objPaciente.idade}" id="txtIdade" styleClass="campoVazio" style="width:200px;" />								
						</div>
						<br style="clear:both;"/>
						<div>
							<h:outputLabel value="FILIAÇÃO | MÃE" /><br />
						   	<h:outputText id="nmMae" value="#{emergenciaExameForm.objPaciente.dscMae}" styleClass="campoVazio" style="width:450px;" />
						</div>
						<div>
							<h:outputLabel value="SEXO" /><br />
							<h:outputText value="#{emergenciaExameForm.objPaciente.sexo.dscSexo}" id="txtSexo" styleClass="campoVazio" style="width:200px;" />
						</div>
						<br style="clear:both;"/>
						<div>
				            <h:outputLabel value="ENDEREÇO" for="inputEndereco" /><h:outputLabel value="*" style="color:red;font-weight: bold;" /><br />
							<h:inputText id="inputEndereco" 
								     	value="#{emergenciaExameForm.objInternacao.dscEndereco}"					     
								     	style="width:330px; text-transform:uppercase;" styleClass="campoTexto" />
				        </div>
				        <div>
				            <h:outputLabel value="COMPLEMENTO" for="inputComplemento" /><br />
							<h:inputText id="inputComplemento" value="#{emergenciaExameForm.objInternacao.dscComplemento}"							 
										style="width:216px; text-transform:uppercase;" styleClass="campoTexto" />
				        </div>
				        <div>
							<h:outputLabel value="CEP" for="inputCep" /><h:outputLabel value="*" style="color:red;font-weight: bold;" /><br />
							<h:inputText id="inputCep" 
						            	value="#{emergenciaExameForm.objInternacao.numCep}"
						             	maxlength="9"
						             	style="width:80px" styleClass="campoTexto" />	   			 	
						</div>
						<br style="clear:both;"/>
						<div>
							<h:outputLabel value="BAIRRO" for="inputBairro" />
							<h:outputText value="*" style="color:red;font-weight: bold;" rendered="#{emergenciaExameForm.bairroFortaleza or emergenciaExameForm.objInternacao.municipio.isnMunicipio == 1}"/><br />
							<h:inputText id="inputBairro" value="#{emergenciaExameForm.objInternacao.dscBairro}" maxlength="100" style="width:120px; text-transform:uppercase;" styleClass="campoTexto" disabled="#{!emergenciaExameForm.bairroFortaleza and emergenciaExameForm.objInternacao.municipio.isnMunicipio != 1}"/>
							<span>
								<a4j:commandButton id="btnFiltrar" image="IMG/imgFiltrar.gif" action="#{emergenciaExameForm.popularLstBairro}" reRender="panBairros" oncomplete="avisoErros(#{emergenciaExameForm.erroInternacao})" disabled="#{!emergenciaExameForm.bairroFortaleza and emergenciaExameForm.objInternacao.municipio.isnMunicipio != 1}"/>
							</span>
							<h:panelGroup id="panBairros">
								<h:selectOneMenu value="#{emergenciaExameForm.objBairro}" converter="simpleIndexConverter" style="width:195px;" disabled="#{!emergenciaExameForm.bairroFortaleza and emergenciaExameForm.objInternacao.municipio.isnMunicipio != 1}">
									<t:selectItems var="o" itemValue="#{o}" itemLabel="#{o.dscBairro}" value="#{emergenciaExameForm.listaBairro}" />
								</h:selectOneMenu>				
							</h:panelGroup>
						</div>
						<div>
							<h:outputLabel value="CIDADE" for="dropDownMunicipio" /><h:outputLabel style="color:red;font-weight: bold;" value=" * " /><br />
							<h:selectOneMenu id="dropDownMunicipio" style="width: 240px"  
							                 value="#{emergenciaExameForm.objInternacao.municipio.isnMunicipio}">
								<a4j:support id="sptMun" reRender="outputUf01, inputBairro, panBairros, btnFiltrar"
								             action="#{emergenciaExameForm.buscarUf}"
								             event="onchange" 
								             ajaxSingle="true"/>
								<f:selectItems value="#{emergenciaExameForm.sliMunicipio}" />
							</h:selectOneMenu>				  
						</div>
						<div>
							<h:outputLabel value="UF" /><br />
							<h:outputText id="outputUf01" value="#{emergenciaExameForm.strUf}" styleClass="campoVazio" style="width: 50px"/>
						</div>
						<br style="clear:both;"/>
			            <div>
			            	<h:outputLabel value="TELEFONE 1" for="dropDownTipoTelefone1" /><br/>
			                <h:selectOneMenu id="dropDownTipoTelefone1" converter="simpleIndexConverter"
					                         value="#{emergenciaExameForm.objInternacao.tipoTelefone1}">
					                         <f:selectItem itemLabel="" itemValue="" />
						 		  <t:selectItems  var="o" itemValue="#{o}" itemLabel="#{o.dscTipoTelefone}"  value="#{emergenciaExameForm.sliTipoTelefone}" />
						 		 
					     	</h:selectOneMenu>
					    </div>
					    <div>
			                <h:outputLabel value="DDD" for="inputDDDFixo1" /><br/>
							<h:inputText id="inputDDDFixo1" 
							             value="#{emergenciaExameForm.objInternacao.numDdd1}"
							      		 maxlength="2"
							      		 style="width:25px" styleClass="campoTexto" />
						</div>
						<div>
							<h:outputLabel value="NÚMERO" for="inputTelefoneFixo1" /><br/>
							<h:inputText id="inputTelefoneFixo1" 	    	         	
				        	      		 value="#{emergenciaExameForm.objInternacao.numTelefone1}"
								 		 maxlength="10"					 	
								 		 style="width:80px" styleClass="celular campoTexto" />
			            </div>
			            <div>
			                <h:outputLabel value="CONTATO" for="inputContato1" /><br/>
							<h:inputText id="inputContato1" 
							             value="#{emergenciaExameForm.objInternacao.dscTelefone1Contato}"
								         maxlength="15" 
								         style="width:85px" styleClass="campoTexto"/>
			            </div>
			        	<div>
				            <h:outputLabel value="TELEFONE 2" for="dropDownTipoTelefone2" /><br/>
							<h:selectOneMenu id="dropDownTipoTelefone2" converter="simpleIndexConverter"
					                         value="#{emergenciaExameForm.objInternacao.tipoTelefone2}">
						 		  <t:selectItems  var="o" itemValue="#{o}" itemLabel="#{o.dscTipoTelefone}"  value="#{emergenciaExameForm.sliTipoTelefone2}" />
					     	</h:selectOneMenu>
					    </div>
			            <div>
					     	<h:outputLabel value="DDD" for="inputDDDCelular2" /><br/>
			    			<h:inputText id="inputDDDCelular2"  value="#{emergenciaExameForm.objInternacao.numDdd2}"
								 		  maxlength="2" style="width:25px" styleClass="campoTexto"/>
						</div>
			            <div>
							<h:outputLabel value="NÚMERO" for="inputTelefoneCelular2" /><br/>
					 		<h:inputText id="inputTelefoneCelular2" 
						       		     value="#{emergenciaExameForm.objInternacao.numTelefone2}"
										 maxlength="10"					    
									 	 style="width:80px" styleClass="celular campoTexto" />
						</div>
			            <div>
							<h:outputLabel value="CONTATO" for="inputContato2" /><br/>
					 		<h:inputText id="inputContato2" 
					 		             styleClass="campoTexto"		   	      	   
				       					 value="#{emergenciaExameForm.objInternacao.dscTelefone2Contato}"
							   			 maxlength="15" style="width:85px"/>
			            </div>
			            <br style="clear:both;"/>
			            <div> 
				        	<h:outputLabel value="SITUAÇÃO FAMILIAR" for="dropDownSituacao" /><h:outputLabel value="*" style="color:red; font-weight:bold;" /><br />
							<h:selectOneMenu id="dropDownSituacao" value="#{emergenciaExameForm.objInternacao.situacaoFamiliar.isnSituacaoFamiliar}">
								<f:selectItems value="#{emergenciaExameForm.sliSituacaoFamilia}" />
							</h:selectOneMenu>
				        </div>
				        <div>
				            <h:outputLabel value="ESCOLARIDADE" for="dropDownEscolaridade" /><h:outputLabel value="*" style="color:red;font-weight:bold;" /><br />
							<h:selectOneMenu id="dropDownEscolaridade" 
											value="#{emergenciaExameForm.objInternacao.escolaridade.isnEscolariade}">
								<f:selectItems value="#{emergenciaExameForm.sliEscolaridade}" />
							</h:selectOneMenu>			   
				        </div>
				        <br style="clear:both;"/>
				        <div>
				        	<h:outputLabel value="OCUPAÇÃO" for="dropDownOcupacao" /><h:outputLabel value="*" style="color:red;font-weight:bold;" /><br />
							<h:selectOneMenu id="dropDownOcupacao" value="#{emergenciaExameForm.objInternacao.ocupacao.isnOcupacao}" style="width:350px;">
								<f:selectItems value="#{emergenciaExameForm.sliOcupacao}"/>
							</h:selectOneMenu>			  
				        </div>
				        <div>
				        	<h:outputLabel value="RELIGIÃO" for="inputReligiao" /><h:outputLabel value="*" style="color:red;font-weight:bold;" /><br />
							<h:inputText id="inputReligiao" style="width:310px; text-transform:uppercase;" styleClass="campoTexto"				  	       
								       value="#{emergenciaExameForm.objInternacao.dscReligiao}"
								       maxlength="30" />
				        </div>
				        <br style="clear:both;"/>
				        <div>
							<h:outputLabel value="REFERÊNCIA" for="dropDownReferencia" /><h:outputLabel style="color:red;" value=" * " /><br />
				  			<h:selectOneMenu id="dropDownReferencia" 
				            		         value="#{emergenciaExameForm.objInternacao.referencia.isnReferencia}"
				            		         style="width: 360px" >
								<f:selectItems value="#{emergenciaExameForm.sliReferencia}" />
				  			</h:selectOneMenu>
				        </div>
				        <div>
							<h:outputLabel value="REGULAÇÃO" for="dropDownRegulacao" /><h:outputLabel style="color:red;" value="***" /><br />
										<h:selectOneMenu id="dropDownRegulacao"
											value="#{emergenciaExameForm.objInternacaoLeito.regulacao.isnRegulacao}">
											<a4j:support id="des" reRender="frt,panNumRegulacao"  ajaxSingle="true"
												action="#{emergenciaExameForm.limpaCampoRegulacao}"
												event="onchange" />
											<f:selectItems value="#{emergenciaExameForm.sliRegulacao}" />
										</h:selectOneMenu>
									</div>
									<a4j:outputPanel id="frt">
										<div id="panNumRegulacao" style="#{(emergenciaExameForm.objInternacaoLeito.regulacao.isnRegulacao != 1)?'':'display:none'}">
											<h:outputLabel value="NÚMERO DA REGULAÇÃO"	for="inputNumRegulacao" />
											<h:outputLabel style="color:red;" value="*" /><br />
											<h:inputText id="inputNumRegulacao" styleClass="campoTexto"
												value="#{emergenciaExameForm.objInternacaoLeito.numRegulacao}"
												maxlength="50"
												style="width:180px; text-transform:uppercase;" />
										</div>
									</a4j:outputPanel>
									<br style="clear:both;"/>
				        <div style="#{(emergenciaExameForm.objPaciente.sexo.sglSexo eq 'F')?'':'display:none'}">
				    		<h:outputLabel value="GESTANTE" styleClass="fonteNegrito" /><h:outputLabel style="color:red;" value="*" /><br />
				   			<h:panelGrid columns="2" styleClass="boxWithBorder" cellpading="0" cellspacing="0">
					   			<h:selectOneRadio id="radioGestante" value="#{emergenciaExameForm.radioGestante}">
					   				<f:selectItem id="gesSim" itemLabel="Sim" itemValue="S" />
								 	<f:selectItem id="gesNao" itemLabel="Não" itemValue="N" />
								 	<a4j:support reRender="cdEmergenciExame" actionListener="#{emergenciaExameForm.limpaFlgGestante}" event="onclick" />
								</h:selectOneRadio>
								<h:selectOneMenu id="dropDownGestante" value="#{emergenciaExameForm.objInternacao.flgGestante}" rendered="#{emergenciaExameForm.radioGestante eq 'S'}">
									<f:selectItem id="ges0" itemLabel="Selecione..." itemValue="0" />
									<f:selectItem id="ges1" itemLabel="1º Trimestre" itemValue="1" />
								 	<f:selectItem id="ges2" itemLabel="2º Trimestre" itemValue="2" />
								 	<f:selectItem id="ges3" itemLabel="3º Trimestre" itemValue="3" />
								 	<f:selectItem id="ges4" itemLabel="Idade Gestacional Ignorada" itemValue="4" />
								 </h:selectOneMenu>				   			
				   			</h:panelGrid>
						</div>
						<br style="clear:both;"/>
				        <div>
				    		<h:outputLabel value="CONDIÇÕES DE CHEGADA DO PACIENTE" styleClass="fonteNegrito" /><br />
				   			<h:selectOneRadio id="radioCondPaciente" value="#{emergenciaExameForm.objInternacao.flgSemAndar}" styleClass="boxWithBorder">
								<f:selectItem id="condPaciente1" itemLabel="Caminhando"     itemValue="1" />
								<f:selectItem id="condPaciente2" itemLabel="Cadeira de Roda" itemValue="2" />
								<f:selectItem id="condPaciente3" itemLabel="Samu"            itemValue="3" />
							</h:selectOneRadio>
						</div>
						<div>
							<h:outputLabel value="ACOMPANHADO POR AGENTE JUDICIÁRIO" styleClass="fonteNegrito" style="white-space:nowrap;" /><br />
							<h:selectOneRadio id="radioJud" value="#{emergenciaExameForm.objInternacao.flgPreso}" styleClass="boxWithBorder">
								<f:selectItem id="judSim" itemLabel="Sim" itemValue="S" />
							 	<f:selectItem id="judNao" itemLabel="Não" itemValue="N" />
				   			</h:selectOneRadio>
				        </div>
				        <br style="clear:both;"/>
						<div>
				        	<table style="display:none">
				        	<tr>
				        		<td>
						        	<h:selectBooleanCheckbox id="flgAcidenteTrabalho" value="#{emergenciaExameForm.flgAcidTrabalho}">
										<f:selectItems value="#{emergenciaExameForm.flgAcidTrabalho}"/>
									</h:selectBooleanCheckbox>
									<h:outputLabel value="ACIDENTE DE TRABALHO" for="flgAcidenteTrabalho" styleClass="fonteNegrito" />
				        		</td>
				        		<td>
						          	<h:selectBooleanCheckbox id="flgplanoSaude" value="#{emergenciaExameForm.flgPlanoSaude}">
										<f:selectItems value="#{emergenciaExameForm.flgPlanoSaude}"/>
									</h:selectBooleanCheckbox>
									<h:outputLabel value="PLANO DE SAÚDE" for="flgplanoSaude" styleClass="fonteNegrito" />
				        		</td>
				        	</tr>
				        	</table>
						    <h:outputLabel value="PLANO DE SAÚDE" style="font-weight:bold;" /><br />
						    <h:panelGroup id="pnPlanoSaude">
								<h:panelGrid columns="3" cellpadding="0" cellspacing="0">
									<h:inputText value="#{emergenciaExameForm.objPlanoSaude.dscRazaoSocial}" disabled="true" id="planoSaudeInput" style="width:500px; text-transform:uppercase;"/>
									<a4j:commandButton image="IMG/pesquisa.gif" id="btnPlanoSaude" style="margin-left:15px; border:1px solid #000"
														action="#{emergenciaExameForm.abrirPlanoSaude}"
														oncomplete="Richfaces.showModalPanel('panPlanoSaude'); focoNmPlanoSaude();"
														reRender="panPlanoSaude">
									</a4j:commandButton>
									<a4j:commandButton image="/images/icons/delete.png" 
								           		       action="#{emergenciaExameForm.limparPlanoSaude}"
								           		       onclick="limpaPlanoSaudeInput()" style="margin-left:5px"
									    		       reRender="planoSaudeInput" title="Clique para cancelar seleção de Plano de Saúde" />
								</h:panelGrid>
							</h:panelGroup>
				        </div>
				        <!-- INICIO Esse código é apenas para o richfaces incluir o JQUERY na página -->
				        <div style="display:none;">
				        	<rich:calendar />
				        </div>
				        <!-- FIM Esse código é apenas para o richfaces incluir o JQUERY na página -->
			        </div>
		 		</fieldset>
		 	</td>
		 	<td style="width:10px;">&nbsp;</td>
        	<td valign="top" style="width:370px">
        		<fieldset class="fsPaginaPaciente">
	         		<legend>OBSERVAÇÃO</legend>
	         		<div style="margin-left:auto;margin-right:auto;">
		         		<h:inputTextarea id="inputAreaObsInternacaoLeito" 
		   	       		       	   style="text-transform:uppercase; width:320px; height:529px;"
		           			   	   value="#{emergenciaExameForm.objInternacao.dscObs}" 
				   			   	   onkeyup="return limitarTamanhoCampo(this,500);" 
								   styleClass="campoTexto countdown limit_500_" />
						<div class="restantes" style="width:300px; font-size:12px">&nbsp;</div>
					</div>
	         	</fieldset>
        	</td>
		 </tr>
		 </table>
		<br style="clear: both"/>
		<div style="font-size: 0.65em; margin: 8px 0 8px 0; font-weight: bold">
			<h:outputText value="Cadastrado por: " />
			<h:outputText value="#{emergenciaExameForm.nomeUsuario}" />
		</div>
	    <div style="margin-top: 10px; text-align: center">            
	   		<a4j:commandButton id="btnGrava" 
						 	   value="Salvar"						  	    		  	    				
							   action="#{emergenciaExameForm.gravar}"
							   onclick="this.disabled=true;"
							   oncomplete="this.disabled=false; imprimirEtiqueta(#{emergenciaExameForm.erroInternacao}); avisoErros(#{emergenciaExameForm.erroInternacao},#{emergenciaExameForm.isnInternacao},'#{emergenciaExameForm.nomeUsuario}','#{emergenciaExameForm.enderecoRelatorios}')" 
							   style='margin-right: 10px' styleClass="botaoModal" >	
										   
			</a4j:commandButton>
			  				
			<h:commandButton id="btnCancelar" 
					  	     value="Cancelar"
							 style='margin-right: 10px'
							 styleClass="botaoModal" 
							 action="#{emergenciaExameForm.cancelar}" 
							 immediate="true">
				<f:setPropertyActionListener value="#{emergenciaExameForm.objPaciente}" target="#{geralForm.objPaciente}"/>			
			</h:commandButton>
			  	
			<a4j:commandButton id="btnExcluir" 
					  	   	   value="Excluir"
					  	   	   onclick="if (! confirm('Confirma a exclusão?') ) { return false }"		      			  	    		
					  	       oncomplete="avisoErros(#{emergenciaExameForm.erroInternacao})"	  	    		
					  	   	   action="#{emergenciaExameForm.excluir}" 	    		 
					  	   	   rendered="#{emergenciaExameForm.objInternacao.ativa}" styleClass="botaoModal">
		  	</a4j:commandButton>
		  		
		  	<a4j:commandButton id="imprimirEtiqueta" 
					  	       action="#{emergenciaExameForm.imprimirEtiqueta}"
					  	       style="visibility: hidden"
					  	       ajaxSingle="true" />			
		</div>
	</div>
	<br/><br/><br/>		
	<script type="text/javascript">
	<!--
	function mascara(o,f){
		v_obj=o
		v_fun=f
		setTimeout("execmascara()",1)
		}
		function execmascara(){
		v_obj.value=v_fun(v_obj.value)
		}
		function mtel(v){
		v=v.replace(/\D/g,"");
		v=v.replace(/^(\d{5})(\d)/g,"$1-$2");
		v=v.replace(/(\d)(\d{4})$/,"$1-$2");
		return v;
		}
		function id( el ){
		return document.getElementById( el );
		}
		window.onload = function(){
		id('cdEmergenciExame:inputCep').onkeypress = function(){
		mascara( this, mtel );
		}
		}
    	

    	function validarLeito(erro) {
        	if (erro==31) {
            	alert("Leito selecionado não é compativel com o sexo do paciente.");
        	} else {
            	Richfaces.hideModalPanel("panelLeito");
        	}
    	}
    	
    	function imprimirEtiqueta(erro){ 
    		 if (erro == 0) {
    			if (confirm("Deseja imprimir a etiqueta de internação?")) {
	    			var item = document.getElementById("cdEmergenciExame:cmdImprimirEtiqueta");
	    			item.click();
	    		} else {
	    			clickBtnCancelar();
	    		}
    		 }
    	}
    	
    	function clickBtnCancelar() {
    		var btnCancelar = document.getElementById("cdEmergenciExame:btnCancelar");
    		btnCancelar.click();
    	}
    	
    	function avisoErros(erro, internacao,dscUsuario,server) {        			    
		    if (erro == 3) {
			    alert("Usuário sem permissão.");
			    return false;
		    } else if (erro == 2) {			    
		    	alert("Não é possível excluir a internação. Internação possui movimentação/prescrição.");
			    return false;
		    } else if (erro == 10) {
		    	alert("Campo Situação Familiar é obrigatório!");
		    	document.getElementById("cdInternacao:dropDownSituacao").focus();
		    } else if (erro == 11) {
		    	alert("Campo Escolaridade é obrigatório!");       
		    	document.getElementById("cdInternacao:dropDownEscolaridade").focus();
		    } else if (erro == 12) {
		    	alert("Campo Ocupação é obrigatório!");		
		    	document.getElementById("cdInternacao:dropDownOcupacao").focus();   	        
		    } else if (erro == 13) {
		    	alert("Campo Cidade é obrigatório!");
		    	document.getElementById("cdInternacao:dropDownMunicipio").focus();		    			    	        
		    } else if (erro == 14) {
		    	alert("Campo 'Admitido por' é obrigatório!");
		    	document.getElementById("cdInternacao:dropDownProfissional").focus();		    			    	        
		    } else if (erro == 15) {
		    	alert("Campo Referência é obrigatório!");
		    	document.getElementById("cdInternacao:dropDownReferencia").focus();		    			    	        
		    } else if (erro == 16) {
		    	alert("Campo Regulação é obrigatório!");
		    	document.getElementById("cdInternacao:dropDownRegulacao").focus();
		    } else if (erro == 17) {
		    	alert("Campo Diagnostico inicial (CID10) é obrigatório!");
		    } else if (erro == 18) {
		    	alert("Campo Leito da Internação é obrigatório!");
		    } else if (erro == 19) {
		    	alert("Informe o Numero da Regulação!");
		    } else if (erro == 20) {
		    	alert("Campo Sexo do Acompanhante é obrigatório!");
		    	document.getElementById("cdInternacao:dropDownSexoResp").focus();
		    } else if (erro == 21) {
		    	alert("Campo Parentesco do Acompanhante é obrigatório!");
		    	document.getElementById("cdInternacao:dropDownParentesco").focus();
		    } else if (erro == 22) {
		    	alert("Endereço do Acompanhante esta incompleto!");
		    	document.getElementById("cdInternacao:inputEndResp").focus();
		    } else if (erro == 23) {
		    	alert("ATENÇÃO: Leito já foi ocupado, escolha outro!");
		    } else if (erro == 24) {
		    	alert("ATENÇÃO: Paciente já possui uma internação em aberto!");
		    } else if (erro == 25) {
		    	alert("ATENÇÃO: Houve problema de gravação, contate o NTI!");		    	
		    } else if (erro == 26) {
		    	alert("Campo Religião é obrigatório!");
		    	document.getElementById("cdInternacao:inputReligiao").focus();	
		    } else if (erro == 27) {
		    	alert("Campo Endereço é obrigatório!");
		    	document.getElementById("cdInternacao:inputEndereco").focus();
		    } else if (erro == 28) {
		    	//alert("Campo Bairro é obrigatório!");
		    	alert("Campo bairro obrigatório para a cidade de Fortaleza!");
		    	document.getElementById("cdInternacao:inputBairro").focus();
		    } else if (erro == 29) {
		    	alert("Campo Número do CEP é obrigatório!");	
		    	document.getElementById("cdInternacao:inputCep").focus();
		    } else if (erro == 30) {
		    	document.getElementById("cdInternacao:inputBairro").focus();
		    } else if (erro == 31) {
		    	alert("Não existe este bairro cadastrado ativo!");
		    	document.getElementById("cdInternacao:inputBairro").focus();
		    } else if (erro == 32) {
		    	alert("EMERGES ToLife está inoperante. Notifique o(a) coordenador(a) da unidade.");	
		    } else if (erro == 33) {
		    	alert("EMERGES ToLife está inoperante. Notifique o(a) coordenador(a) da unidade.");	
		    } else if (erro == 34) {
		    	alert("Campo Gestante é obrigatório!");
		    } else if (erro == 35) {
		    	alert("Informe o tipo do Telefone 1!");
		    } else if (erro == 36) {
		    	alert("Informe o ddd 1!");
		    }  else if (erro == 37) {
		    	alert("Campo Número do Telefone 1 deve conter 9 dígitos!");
		    } else if (erro == 38) {
		    	alert("Campo Número do Telefone 2 deve conter 9 dígitos!");
		    } else if (erro == 39) {
		    	alert("Campo Número do Telefone 1 deve conter pelo menos 8 dígitos!");
		    } else if (erro == 40) {
		    	alert("Campo Número do Telefone 2 deve conter pelo menos 8 dígitos!");
		    }else if (erro == 42) {
		    	alert("Informe o ddd do Telefone 2 !");
		    }else {			   
			  		    			    
			   // if (confirm("Deseja imprimir a Termo da Emergência?")) {
			   //    window.open(server+"/relatorios/EmergenciaExame?p1="+internacao+"&amp;p2="+dscUsuario,"relatorio","width=800,height=600;left=0");
			   // }
			   // var item = document.getElementById("cdEmergenciExame:btnCancelar");
			   // item.click();
		    }
	    }

    	//preenchimento forcado da combo de bairros de acordo com o bairro no input text
    	jQuery(document).ready(function(){
		    if(jQuery("#cdEmergenciExame\\:inputBairro").val() != ""){
		    	document.getElementById("cdEmergenciExame:btnFiltrar").click();
			}
		});

    	//contador de caracteres de inputs e textareas
	    initCountdown();
    	
	    var planoSaudeInput = document.getElementById('cdEmergenciExame:planoSaudeInput');
    	function limpaPlanoSaudeInput() {
			planoSaudeInput.value = '';
		}
    	
    	function focoNmPlanoSaude() {
    		document.getElementById('formPlanoSaude:nmPlanoSaude').focus();
    	}
    	
    	function somenteNumero2(campo) {
			var digits = "0123456789.,-";
			var campo_temp;
			for ( var i = 0; i < campo.value.length; i++) {
				campo_temp = campo.value.substring(i, i + 1);
				if (digits.indexOf(campo_temp) == -1) {
					campo.value = campo.value.substring(0, i);
				}
			}
		}
    	
    	jQuery(function(){ 	
    		jQuery('.celular').maskbrphone();			
		});

	//-->	 
	</script>
	<a4j:status id="status" 
                onstart="#{rich:component('panelStatus')}.show()" 
                onstop="#{rich:component('panelStatus')}.hide()" >
 	</a4j:status>	  							
</h:form>
</ui:define>
</ui:composition>
</html>