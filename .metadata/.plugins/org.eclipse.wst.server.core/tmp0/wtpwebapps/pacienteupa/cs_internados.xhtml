<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:a4j="http://richfaces.org/a4j"
	  xmlns:rich="http://richfaces.org/rich">

<ui:composition template="template.xhtml">
<ui:define name="headHtml">
	<title>SISTEMA DE PACIENTE - Pesquisar Paciente</title>	
</ui:define>
<ui:define name="conteudo">
<a4j:keepAlive beanName="pacienteForm" />
<a4j:keepAlive beanName="geralForm" />
<a4j:keepAlive beanName="pacienteInternadoForm" />
<a4j:form>
   	<div style="margin-bottom: 55px">	  
   	    <label class="cabAreaPesquisa">PACIENTES INTERNADOS</label>	  
	    <div class="areaPesquisa">	              
	       <div class="col220" style="margin-top: 8px">	       
	           <label>Pesquisar:</label><br/>	           
	           <h:inputText id="inputPesquisa" 
	                        value="#{pacienteInternadoForm.filtroLista}"
	                        styleClass="campoTexto" style="width:210px"/>
	       </div>
	       <div class="col170" style="margin-top: 8px">
		       <rich:spacer height="18px"/><br/>             
	           <h:selectOneMenu value="#{pacienteInternadoForm.campoPesquisa}"
	                            styleClass="selectItens"
	                            style="width:160px">
	           		<f:selectItem itemLabel="Nome/Prontuario" itemValue="1"/>
	           		<f:selectItem itemLabel="Nome Clinica" itemValue="2"/>
	           		<f:selectItem itemLabel="Nome Mãe" itemValue="3"/>
	           		<f:selectItem itemLabel="Nome Acompanhante" itemValue="4"/>
	           </h:selectOneMenu>
	       </div>     
	       <div class="col180" style="margin-top: 8px">
	           <rich:spacer height="12px"/><br/>
	           <a4j:commandButton id="btnPesquisa" 
	           		image="IMG/pesquisa.gif"
	           		alt="Pesquisar" 
	                action="#{pacienteInternadoForm.filtrarInternados}"  
		    		oncomplete="avisosPesquisa(#{pacienteInternadoForm.erroPesquisa})"
		    		reRender="tabelaPaciente,totalPesq" 
		    		style="margin-right: 8px"/>
		     		
		       <a4j:commandButton id="btnRefresh" 
		       		image="IMG/atualizar.gif"
		       		alt="Desfazer a pesquisa" 
	                action="#{pacienteInternadoForm.relerLista}"
		    		reRender="tabelaPaciente,totalPesq,totalGeral,inputPesquisa" />
		    			
		       <rich:hotKey key="return" selector="#inputPesquisa" 
		    		             handler="#{rich:element('btnPesquisa')}.click()"/>			
		   		           
	       </div>
	       <div class="col100" style="text-align: center">    
	           <label>Pesquisados:</label><br/>
	           <h:outputText id="totalPesq" value="#{pacienteInternadoForm.totalPesquisados}" 
	                         styleClass="totalizador2" />	          
	       </div>
	       <div class="col100" style="text-align: center">
	           <label>Internados:</label><br/>
	           <h:outputText id="totalGeral" value="#{pacienteInternadoForm.totalInternados}" 
	                         styleClass="totalizador2 "/>
	       </div>	       
	    </div>
		<div id="">
			<rich:dataTable id="tabelaPaciente"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{pacienteInternadoForm.lstPacienteInternado}" 
					var="internado" 					
					rows="30"					 
					style="width: 100%"										 
					reRender="ds,totalGeral">
				<f:facet name="header">
					<rich:columnGroup>
						<h:column>
							<h:outputText value="Sel" /> <!-- 3 -->
						</h:column>						
						<h:column>
							<h:outputText value="Acomp." /> <!-- 3 -->
						</h:column>												
						<h:column>
							<h:outputText value="Prontuário" /> <!-- 5 -->
						</h:column>
						<h:column>
							<h:outputText value="Paciente" /> <!-- 60 -->
						</h:column>
						<h:column>
							<h:outputText value="Nome da mãe" /> <!-- 60 -->
						</h:column>						
						<h:column>
							<h:outputText value="Clinica/Enf.Leito" /> <!-- 5 -->
						</h:column>						
						<h:column>
							<h:outputText value="Dias Leito" /> <!-- 5 -->
						</h:column>
						<h:column>
							<h:outputText value="Dias Hospital" /> <!-- 5 -->
						</h:column>
					</rich:columnGroup>
				</f:facet>
				
				<!-- SELECIONE -->
				<rich:column width="3%">
					<center>
						<a4j:commandLink id="selecionar" ajaxSingle="true" action="csInternadosParaCsGeral" title="Acessar Histórico do Paciente" >
							<h:graphicImage id="imgSelecionar02" url="IMG/selecionar.png" style="border:0;" />							
							<f:setPropertyActionListener value="#{internado.isnPaciente}" target="#{geralForm.isnPaciente}" />
						</a4j:commandLink>
					</center>
				</rich:column>
				
				<!-- PRONTUARIO -->
				<rich:column width="6%">
					<center>
						<h:panelGroup rendered="#{internado.nomAcompanhante!=null}">
						    <h:commandLink id ="acompanhante" action="#{pacienteInternadoForm.formAcompanhante}" >
						    	<h:graphicImage id="imgAcomp" 
						    	                url="IMG/acompanhante.png"
						           	    	    alt="#{internado.nomAcompanhante} - #{internado.dscParentesco}"
						            	        style="border:0;" />
						        <f:setPropertyActionListener value="#{internado.isnInternacao}" target="#{acompanhanteForm.isnInternacao}"/> 
						        <f:setPropertyActionListener value="#{internado}" target="#{acompanhanteForm.objPacienteInternando}"/>           
						   </h:commandLink>                 
						</h:panelGroup>
					</center>
				</rich:column>
				
				<!-- PRONTUARIO -->
				<rich:column width="5%">
					<center>
						<h:outputText value="#{internado.numProntuario}" />
					</center>
				</rich:column>
				
				<!-- NOME -->
				<rich:column width="30%">
				    <a4j:commandLink id="btnConsulta" action="#{pacienteInternadoForm.formPaciente}" >
						<h:outputText value="#{internado.dscPaciente} " />
						<h:panelGroup rendered="#{internado.flgCcih != null}">
						   <h:graphicImage id="imgCCIH" url="IMG/iconeCCIH.png" style="border:0;"  />
						</h:panelGroup>
						<h:graphicImage id="imgPreso" url="IMG/policial.png" style="border:0;vertical-align: middle" 
						                             rendered="#{internado.flgJudiciario=='S'}" />
    				    <f:setPropertyActionListener value="#{internado.isnPaciente}" target="#{pacienteForm.isnPaciente}" />
    				    <f:setPropertyActionListener value="#{true}" target="#{pacienteForm.alteracaoPaciente}" />
					</a4j:commandLink>					
				</rich:column>
				
				<!-- NOME DA MÃE -->
				<rich:column width="30%">
					<h:outputText value="#{internado.dscMae} " />
				</rich:column>
				
				<!-- CLINICA, ENFERMARIA, LEITO -->
				<rich:column width="14%">
					<center>
						<h:outputText value="#{internado.dscClinica} - #{internado.dscEnfermaria}.#{internado.dscLeito}"></h:outputText>
					</center>
				</rich:column>				
				
				<!-- DIAS LEITO -->
				<rich:column width="6%">
					<center>
						<h:outputText value="#{internado.tempoLeito}" />
					</center>	
				</rich:column>
				
				<!-- DIAS HOSPITAL -->
				<rich:column width="6%">
					<center>
						<h:outputText value="#{internado.tempoHospital}" />
					</center>	
				</rich:column>
				
				<f:facet name="footer">
					<rich:datascroller id="ds" ajaxSingle="false" />
				</f:facet>
			</rich:dataTable>
		</div>
	</div>
	<script type="text/javascript">
	     function avisosPesquisa(erro) {
		     if (erro==2) {
		    	 alert("Não há pacientes cadastrados que atendam a esta pesquisa.");
		     }
	     }
	</script>
</a4j:form>	
</ui:define>
</ui:composition>
</html>