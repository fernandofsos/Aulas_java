<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:a4j="http://richfaces.org/a4j"
	  xmlns:rich="http://richfaces.org/rich">

<ui:composition template="template.xhtml">
<ui:define name="headHtml">
	<link rel="stylesheet" type="text/css" href="CSS/layoutCsPaciente.css" />
	</ui:define>
	<ui:define name="conteudo">

<a4j:keepAlive beanName="chaveBolsaForm" />

<a4j:form>   
	<div style="margin-bottom: 35px">		
		<!-- INICIO DA BUSCA PACIENTE -->
		<div class="cabAreaPesquisa">CHAVES/BOLSAS</div>
    	<div class="areaPesquisa">
        	<div>
        		<label>CHAVE: </label>
				<h:inputText id="txtChave"
				             styleClass="campoTexto" 
				             value="#{chaveBolsaForm.strChave}"/>
				<a4j:commandButton image="IMG/pesquisa.gif" action="#{chaveBolsaForm.buscaChave}" 
		    	                   reRender="tabelaChave" />		    	
			</div>			
		</div>	
		<!-- FIM CAMPOS DE BUSCA -->
		
		<!-- CONTEUDO DO MODAL -->
		<div>
			<rich:dataTable id="tabelaChave"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{chaveBolsaForm.lstChave}" 
					var="listaChave" 
					rows="10"
					rowKeyVar="linha" 
					style="width: 100%"										 
					reRender="ds">
				<f:facet name="header">
					<rich:columnGroup>
						<h:column>
							<h:outputText value="Chave" />
						</h:column>
						<h:column>
							<h:outputText value="Status" />
						</h:column>
						<h:column>
							<h:outputText value="Prontuário" />
						</h:column>
						<h:column>
							<h:outputText value="Paciente" />
						</h:column>
					</rich:columnGroup>
				</f:facet>
				
				<rich:column width="10%">
					<center>
						<h:outputText value="#{listaChave.dscChave}" />
					</center>
				</rich:column>
				
				<rich:column width="5%">
				      <h:panelGroup rendered="#{listaChave.statusChave=='LIVRE'}">
				         <h:outputText value="#{listaChave.statusChave}"></h:outputText>
	 		      	</h:panelGroup>
	 		      	  <h:panelGroup rendered="#{listaChave.statusChave=='EM USO'}">
					  <a4j:commandLink id="status"
					  				   onclick="if (! confirm('Confirma a baixa da chave.')) return false" 	 
					                   value="#{listaChave.statusChave}"
					                   action="#{chaveBolsaForm.baixaChave}" reRender="tabelaChave"  >
							<f:setPropertyActionListener value="#{listaChave}" target="#{chaveBolsaForm.objChave}" />							
					</a4j:commandLink>
					</h:panelGroup> 
				</rich:column>´	
				<rich:column width="5%">
					  <h:outputText value="#{listaChave.strProntuario}" />
				</rich:column>´
				<rich:column width="35%">
						<h:outputText value="#{listaChave.strPaciente}" />
				</rich:column>´
				<f:facet name="footer">
					<rich:datascroller id="ds" ajaxSingle="false" />
				</f:facet>
			</rich:dataTable>
		</div>
	</div>
		
	<div style="margin-bottom: 35px">
    	<div  class="areaPesquisa">
        	<div>
        		<label>BOLSA: </label>
				<h:inputText id="nmBolsa" value="#{chaveBolsaForm.strBolsa}" style="margin-right: 8px; width: 160px;"/>
				<a4j:commandButton image="IMG/pesquisa.gif" action="#{chaveBolsaForm.buscaBolsa}" 
		    		                   reRender="tabelaBolsa" />
			</div>
    	</div>	
		<!-- FIM CAMPOS DE BUSCA -->
		
		<!-- CONTEUDO DO MODAL -->
		<div>
			<rich:dataTable id="tabelaBolsa"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{chaveBolsaForm.lstBolsa}" 
					var="listaBolsa" 
					rows="10"
					rowKeyVar="linha" 
					style="width: 100%"										 
					reRender="ds">
				<f:facet name="header">
					<rich:columnGroup>
						<h:column>
							<h:outputText value="Bolsa" />
						</h:column>
						<h:column>
							<h:outputText value="Status" />
						</h:column>
						<h:column>
							<h:outputText value="Prontuário" />
						</h:column>
						<h:column>
							<h:outputText value="Paciente" />
						</h:column>
						
					</rich:columnGroup>
				</f:facet>
				
				<rich:column width="10%">
					<center>
						<h:outputText value="#{listaBolsa.dscBolsa}" />
					</center>
				</rich:column>
				
				<rich:column width="5%">
				      <h:panelGroup rendered="#{listaBolsa.statusBolsa=='LIVRE'}">
				         <h:outputText value="#{listaBolsa.statusBolsa}"></h:outputText>
	 		      	</h:panelGroup>
	 		      	  <h:panelGroup rendered="#{listaBolsa.statusBolsa=='EM USO'}">
					  <a4j:commandLink id="status" 
					  				   onclick="if (! confirm('Confirma a baixa da bolsa.')) return false" 
					                   value="#{listaBolsa.statusBolsa}"
					                   action="#{chaveBolsaForm.baixaBolsa}"  reRender="tabelaBolsa"  >
							<f:setPropertyActionListener value="#{listaBolsa}" target="#{chaveBolsaForm.objBolsa}" />							
					</a4j:commandLink>
					</h:panelGroup> 
				</rich:column>´
				
				<rich:column width="5%">
					  <h:outputText value="#{listaBolsa.strProntuario}" />
				</rich:column>´
				<rich:column width="35%">
						<h:outputText value="#{listaBolsa.strPaciente}" />
				</rich:column>´
												
				<f:facet name="footer">
					<rich:datascroller id="ds" ajaxSingle="false" />
				</f:facet>
			</rich:dataTable>
		</div>
	</div>
	
	<script type="text/javascript">
	     function avisosPesquisa(tipo) {
		     if (tipo==1) {
			     alert("Digite pelo menos 3 letras ou numeros.");
		     } else if (tipo==2) {
		    	 alert("Não há pacientes cadastrados que atendam a esta pesquisa.");
		     }
	     }
	</script>
</a4j:form>	
</ui:define>
</ui:composition>
</html>