<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:a4j="http://richfaces.org/a4j"
	  xmlns:rich="http://richfaces.org/rich">

<ui:composition template="template.xhtml">
<ui:define name="headHtml">
	<link rel="stylesheet" type="text/css" href="CSS/layoutCsPaciente.css" />
	</ui:define>
	<ui:define name="conteudo">

<a4j:keepAlive beanName="interconsultaForm" />

<rich:modalPanel id="panelStatus" autosized="true" >  
 	<h:panelGrid columns="2"> 
 		<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
 		<h:outputText value="Carregando..." />
 	</h:panelGrid> 
</rich:modalPanel> 

<a4j:form>
 	<div class="tituloPagina">NAC / INTERCONSULTAS</div> 	 
	<div style="margin-bottom: 55px">	
    	<div class="areaPesquisa">
        	<div id="divPesquisaInput">
        		<label>Nome/Prontuario:</label>
				<h:inputText id="nmaPaciente" value="#{interconsultaForm.strPaciente}" />
			</div>			
			<div id="divPesquisaBotoes">
		    	<div class="col1">
		    		<a4j:commandButton image="IMG/pesquisa.gif" action="#{interconsultaForm.buscaExame}" 
		    		                   oncomplete="avisosPesquisa(#{csPacienteForm.avisoUsuario})"
		    		                   reRender="tabelaInterConsulta" />
		    	</div>
		    	<label>Situação:</label>
				<h:selectOneMenu id="dropDownTipoconsulta" value="#{interconsultaForm.intTipoConsulta}"
				                 style="width: 160px"  >
				   	 <a4j:support id="sptExame" reRender="tabelaInterConsulta"
						             action="#{interconsultaForm.tipoConsultaInterconsulta}"
						             event="onchange" 
						             status="status"
						             ajaxSingle="true"/>
				   	 <f:selectItems value="#{exameForm.sliTipoConsulta}" />
			    </h:selectOneMenu>
			</div>
    	</div>	
		<!-- FIM CAMPOS DE BUSCA -->
		
		<!-- CONTEUDO DO MODAL -->
		<div>
			<rich:dataTable id="tabelaInterConsulta"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{interconsultaForm.lstInterconsulta}" 
					var="listaInterconsulta" 
					rows="20"
					rowKeyVar="linha"
					style="width: 100%"										 
					reRender="ds">
				<f:facet name="header">
					<rich:columnGroup>
						<h:column>
							<h:outputText value="Pront." />
						</h:column>
						<h:column>
							<h:outputText value="Data" />
						</h:column>
						<h:column>
							<h:outputText value="Médico Solicitante" />
						</h:column>
						<h:column>
							<h:outputText value="Especialidade" />
						</h:column>
						<h:column>
							<h:outputText value="Interconsulta" />
						</h:column>
						<h:column>
							<h:outputText value="Situação" />
						</h:column>
						
					</rich:columnGroup>
				</f:facet>
				
				<rich:column width="5%">
					<h:outputText value="#{listaInterconsulta.numProntuario}" />
				</rich:column>
								
				<rich:column width="5%">
					<center>
						<a4j:commandLink id="selecionar" action="csInterconsultaCdInterconsulta" >
							<h:outputText value="#{listaInterconsulta.datSolicitacao}" >
									<f:convertDateTime pattern="dd/MM/yyyy" />	
							</h:outputText>
							<f:setPropertyActionListener value="#{listaInterconsulta}" target="#{interconsultaForm.objInterconsulta}" />	
						</a4j:commandLink>
					</center>
				</rich:column>
				
				<rich:column width="30%">
					<h:outputText value="#{listaInterconsulta.profissionalSolic.dscUsuario}" />
				</rich:column>
				
				<rich:column width="10%">
					<h:outputText value="#{listaInterconsulta.especialidade.dscEspecialidade}" />
				</rich:column>
				
				<rich:column width="40%">
					<h:outputText value="#{listaInterconsulta.dscInterconsulta}" />
				</rich:column>
				
				<rich:column width="8%">
					<h:outputText value="#{listaInterconsulta.situacao}" >
					</h:outputText>
				</rich:column>
						
				<f:facet name="footer">
					<rich:datascroller id="ds" ajaxSingle="false" />
				</f:facet>
			</rich:dataTable>
		</div>
	</div>
	<a4j:status id="status"  
            onstart="#{rich:component('panelStatus')}.show()" 
            onstop="#{rich:component('panelStatus')}.hide()" >
	</a4j:status>
	<script type="text/javascript">
	     function avisosPesquisa(tipo) {
		     if (tipo==1) {
			     alert("Digite pelo menos 3 letras ou numeros.");
		     } else if (tipo==2) {
		    	 alert("Não há pacientes cadastrados que atendam a esta pesquisa.");
		     }
	     }
	</script>
</a4j:form>	
</ui:define>
</ui:composition>
</html>