<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:a4j="http://richfaces.org/a4j"
	  xmlns:rich="http://richfaces.org/rich"
	  xmlns:c="http://sourceforge.net/projects/jsf-comp">

<ui:composition template="template.xhtml">    
	<ui:define name="conteudo">		
	<a4j:keepAlive beanName="estatisticaEmergenciaForm" />
	
	<rich:modalPanel id="panelStatus" autosized="true">  
 		<h:panelGrid columns="2"> 
 			<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
 			<h:outputText value="Carregando..." />
 		</h:panelGrid> 
	</rich:modalPanel>
	
					
	<h:form id="estatistica" >   
		<div class="cabAreaPesquisa">ESTATISTICAS DA EMERGÊNCIA</div>			
    	<h:panelGroup styleClass="areaPesquisa" layout="block" id="filtros" style="height: 150px" > 
    		<div>        		        		
	       		<label style="font-weight: bold">Período: </label><br />
	       		<rich:calendar id="datInicial" 
	       	               value="#{estatisticaEmergenciaForm.dataInicial}" 
	       		           datePattern="dd/MM/yyyy" />
				<div style="margin-bottom: 8px"/>	        		               
	       		<rich:calendar id="datFinal" 
	       	               value="#{estatisticaEmergenciaForm.dataFinal}" 
	       	               datePattern="dd/MM/yyyy" />               
	       	    <br/>    	       	    
	       	</div>
	       	<div class="col200">
	       	    <label style="font-weight: bold">Ordenação</label><br/>
	       	    <span>
	       	    	<h:selectOneMenu id="selOrdem" value="#{estatisticaEmergenciaForm.ordem}"
		       	                     style="width: 180px" >
		       	    	<f:selectItem itemLabel="Por Descrição" itemValue="1"/>	       			
		       			<f:selectItem itemLabel="Por Quantidade" itemValue="2"/>
		       			<f:selectItem itemLabel="Por Quantidade Desc" itemValue="3"/>
		       	    </h:selectOneMenu>
	       	    </span>
	       	</div>
	       	<div class="col280">
	       		<label style="font-weight: bold">Comparativos</label>
	       		<div>
					<h:selectBooleanCheckbox id="chkTempo" value="#{estatisticaEmergenciaForm.chkTempo}" />					
	    			<label for="chkTempo">Risco x Tempo de atendimento</label>	        			
	       			<br/>
					<h:selectBooleanCheckbox id="chkEspec" value="#{estatisticaEmergenciaForm.chkEspecialidade}" />					
	    			<label>Risco x Especialidade</label>	        			
	       			<br/>
	       			<h:selectBooleanCheckbox id="chkProcedencia" value="#{estatisticaEmergenciaForm.chkProcedencia}"/>
	       			<label>Risco x Procedência (Munícipio)</label>	        			
					<br/>
					<h:selectBooleanCheckbox id="chkOrigem" value="#{estatisticaEmergenciaForm.chkOrigem}"></h:selectBooleanCheckbox>
	       			<label>Risco x Origem do paciente</label>	        			
	       		</div>
		    </div>		    
	       	<div class="col150" style="text-align: center">
	       	   	<a4j:commandButton value="Pesquisar"
			       	              action="#{estatisticaEmergenciaForm.gerarEstatisticaPeriodo}"
			       	              style="height: 22px; 
			       	              width:100px; 
			       	              margin-bottom: 4px"
			       	              reRender="estatistica" >
				</a4j:commandButton>
	       	   	<br/>
	       	   	<a4j:commandButton value="Redefinir" 
	       	                       action="#{estatisticaEmergenciaForm.redefinirDados}"
	       	                       style="height: 22px; 
	       	                       width:100px; 
	       	                       margin-bottom: 4px"
	       	                      reRender="estatistica"/>
	       	   	<br/>
	       	   	<a4j:commandButton value="Imprimir" style="height: 22px; width:100px" />
	        </div>	
    	</h:panelGroup>
    	
    	<br style="clear: both"/>
    	
    	<div style="margin-right: 5px; width:45%; float:left">		    
			<rich:dataTable id="tblResumo"
							value="#{estatisticaEmergenciaForm.lstRiscos}"
			                var="risco"  
			    			rowClasses="linhaNormal,linhaDestaque"
			    			style="width:100%"	>
				<f:facet name="header">
					<rich:columnGroup>											
						<h:column><h:outputText value="Classificação" /></h:column>												
						<h:column><h:outputText value="Quantidade" /></h:column>													
						<h:column><h:outputText value="(%)"/></h:column>						
					</rich:columnGroup>
				</f:facet>	
				<rich:columnGroup>
					<rich:column styleClass="fonte13">
			    		<h:graphicImage value="#{estatisticaEmergenciaForm.icones[risco.isn]}" 
			      				        style="vertical-align: middle" />
						<h:outputText value="#{risco.descricao}" />
					</rich:column>								
					<rich:column styleClass="fonte13 textoCentralizado">
		    			<h:outputText value="#{risco.quantidade}">
					        <f:convertNumber pattern="#,##0"/>
				      	</h:outputText>				    							
					</rich:column>								
					<rich:column styleClass="fonte13 fonteNegrito textoCentralizado">		   				 
				    	<h:outputText value="#{risco.quantidade/estatisticaEmergenciaForm.totalRiscos*100}">
				        	<f:convertNumber pattern="#,##0.00"/>
				      	</h:outputText>					    
					</rich:column>
				</rich:columnGroup>
				<f:facet name="footer">                
       	        	<rich:columnGroup>
	           	    	<rich:column styleClass="fonte13" >Total</rich:column>
    	           	    <rich:column styleClass="fonte13 textoCentralizado" >
       	       	    		<h:outputText value="#{estatisticaEmergenciaForm.totalRiscos}">
       	       	    			<f:convertNumber pattern="#,##0"/>
       	       	    		</h:outputText>  
               	    	</rich:column>
           	       		<rich:column styleClass="fonte13" >
                	   	    <center> 
                	   	      	<h:outputText value="100,00"/>
                   	       	</center>
                  		</rich:column>                    	    
               		</rich:columnGroup>
           		</f:facet>				
			</rich:dataTable>
		</div>
		<div style="width:45%; float:right">
			<c:chart id="graficoRiscos"			          
				 	datasource="#{estatisticaEmergenciaForm.dadosGrafico}"					 	 
				 	type="pie" 
				 	is3d="true"	
				 	depth="5" 
				 	legend="false"
				 	colors="red,orange,yellow,green,blue,lightGray"
				 	style="width:100%" 
				 	height="250"		  
                   	antialias="true" >
           	</c:chart>
		</div>				
		<br style="clear: both"/>
		<h:panelGroup id="resumos" layout="block" style="margin-bottom: 60px">		
        	<rich:simpleTogglePanel style="border:0px;"
        	                        bodyClass="panel" 
        	                        headerClass="headerPanel2" 
        	                        id="panTempo" 
        	                        switchType="client" 
        	                        rendered="#{estatisticaEmergenciaForm.chkTempo}">
	           	<f:facet name="header">CLASSIFICAÇÃO DE RISCO X TEMPO DE ATENDIMENTO</f:facet>
	           	<f:facet name="openMarker"><h:graphicImage value="IMG/down.png"></h:graphicImage></f:facet>
	           	<f:facet name="closeMarker"><h:graphicImage value="IMG/up.png"></h:graphicImage></f:facet>
            	<rich:dataTable id="tblTempo"									 
								var="item"
								rowClasses="linhaDestaque"		 
								style="width: 100%"
								value="#{estatisticaEmergenciaForm.lstTempo}">
								<f:facet name="header">
									<rich:columnGroup>											
										<h:column> <h:outputText value="Classificação" /> </h:column>												
										<h:column> <h:outputText value="Tempo" /> </h:column>
										<h:column> <h:outputText value="Quantidade" /> </h:column>
										<h:column> <h:outputText value="(%)" /> </h:column>
									</rich:columnGroup>
								</f:facet>
								<rich:column colspan="4" styleClass="fonte13 fonteNegrito">
									<h:outputText value="#{item.descricao}" />
								</rich:column>
								<rich:subTable id="stblTempo" value="#{item.subItens}" var="subitem" rowKeyVar="id">
								     <rich:column></rich:column>												
									 <rich:column styleClass="fonte13">
									         <h:outputText value="#{subitem.descricao}" /> 
									 </rich:column>
									 <rich:column styleClass="textoCentralizado fonte13">						          
									       <h:outputText value="#{subitem.quantidade}" />						        
									 </rich:column>
									 <rich:column styleClass="textoCentralizado fonte13 fontNegrito">						 							       
								        <h:outputText value="#{subitem.quantidade/item.quantidade*100}" >
								      		<f:convertNumber pattern="##0.00"/>
							         	</h:outputText>	
									 </rich:column>
								</rich:subTable>					
				</rich:dataTable>				
        	</rich:simpleTogglePanel>
        	<br/>        			
        	<rich:simpleTogglePanel style="border:0px;" 
        	                        bodyClass="panel" 
        	                        headerClass="headerPanel2"
        	                         id="panEspecialidade" 
        	                        switchType="client" 
        	                        rendered="#{estatisticaEmergenciaForm.chkEspecialidade}">
            	<f:facet name="header">CLASSIFICAÇÃO DE RISCO X ESPECIALIDADE</f:facet>
            	<f:facet name="openMarker"><h:graphicImage value="IMG/down.png"></h:graphicImage></f:facet>
            	<f:facet name="closeMarker"><h:graphicImage value="IMG/up.png"></h:graphicImage></f:facet>
            	<rich:dataTable id="tblEspecialidade"									 
								var="item"
								rowClasses="linhaDestaque"		 
								style="width: 100%"
								value="#{estatisticaEmergenciaForm.lstEspecialidade}">
					<f:facet name="header">
						<rich:columnGroup>											
							<h:column> <h:outputText value="Classificação" /> </h:column>												
							<h:column> <h:outputText value="Especialidade" /> </h:column>
							<h:column> <h:outputText value="Quantidade" /> </h:column>
							<h:column> <h:outputText value="(%)" /> </h:column>
						</rich:columnGroup>
					</f:facet>
					<rich:column colspan="4" styleClass="fonte13 fonteNegrito">
						<h:outputText value="#{item.descricao}" />
					</rich:column>
					<rich:subTable id="stblTempo" value="#{item.subItens}" var="subitem" >
					     <rich:column></rich:column>												
						 <rich:column styleClass="fonte13">
						         <h:outputText value="#{subitem.descricao}" /> 
						 </rich:column>
						 <rich:column styleClass="textoCentralizado fonte13">						          
						       <h:outputText value="#{subitem.quantidade}" />						        
						 </rich:column>
						 <rich:column styleClass="textoCentralizado fonte13 fontNegrito">						       
						      <h:outputText value="#{subitem.quantidade/item.quantidade*100}" >
						      	 <f:convertNumber pattern="##0.00"/>
						      </h:outputText>						       
						 </rich:column>
					</rich:subTable>					
				</rich:dataTable>				
        	</rich:simpleTogglePanel>
        	<br/>
        	<rich:simpleTogglePanel style="border:0px;" bodyClass="panel" headerClass="headerPanel2" 
        	                        id="panProcedencia" rendered="#{estatisticaEmergenciaForm.chkProcedencia}">            	
           		<f:facet name="header">CLASSIFICAÇÃO RISCO X PROCEDÊNCIA</f:facet>
           		<f:facet name="openMarker"><h:graphicImage value="IMG/down.png"></h:graphicImage></f:facet>
           		<f:facet name="closeMarker"><h:graphicImage value="IMG/up.png"></h:graphicImage></f:facet>
            	<rich:dataTable id="tblAltas"									 
								var="item"	
								rowClasses="linhaDestaque"	 
								style="width: 100%"
								value="#{estatisticaEmergenciaForm.lstProcedencia}" >
					<f:facet name="header">
						<rich:columnGroup>											
							<h:column> <h:outputText value="Classificação" /> </h:column>												
							<h:column> <h:outputText value="Procedência" /> </h:column>
							<h:column> <h:outputText value="Quantidade" /> </h:column>
							<h:column> <h:outputText value="(%)" /> </h:column>
						</rich:columnGroup>
					</f:facet>			
					<rich:column colspan="4" styleClass="fonte13 fonteNegrito">
						<h:outputText value="#{item.descricao}" />
					</rich:column>
					<rich:subTable id="stblTempo" value="#{item.subItens}" var="subitem" >
					     <rich:column></rich:column>												
						 <rich:column styleClass="fonte13">
						         <h:outputText value="#{subitem.descricao}" /> 
						 </rich:column>
						 <rich:column styleClass="textoCentralizado fonte13">						          
						       <h:outputText value="#{subitem.quantidade}" />						        
						 </rich:column>
						 <rich:column styleClass="textoCentralizado fonte13 fontNegrito">						       
						      <h:outputText value="#{subitem.quantidade/item.quantidade*100}" >
						      	 <f:convertNumber pattern="##0.00"/>
						      </h:outputText>						       
						 </rich:column>
					</rich:subTable>					
				</rich:dataTable>       
        	</rich:simpleTogglePanel>
        	<br/>
        	<rich:simpleTogglePanel style="border:0px;" bodyClass="panel" headerClass="headerPanel2" 
        					        id="panOrigem" rendered="#{estatisticaEmergenciaForm.chkOrigem}">            	
           		<f:facet name="header">CLASSIFICAÇÃO RISCO X ORIGEM PACIENTE</f:facet>
           		<f:facet name="openMarker"><h:graphicImage value="IMG/down.png"></h:graphicImage></f:facet>
           		<f:facet name="closeMarker"><h:graphicImage value="IMG/up.png"></h:graphicImage></f:facet>
            	<rich:dataTable id="tblOrigem"
					var="item"		 
					style="width: 100%"
					rowClasses="linhaDestaque"
					value="#{estatisticaEmergenciaForm.lstOrigem}">
					<f:facet name="header">
						<rich:columnGroup>											
							<h:column> <h:outputText value="Classificação" /> </h:column>												
							<h:column> <h:outputText value="Origem" /> </h:column>
							<h:column> <h:outputText value="Quantidade" /> </h:column>
							<h:column> <h:outputText value="(%)" /> </h:column>
						</rich:columnGroup>
					</f:facet>			
					<rich:column colspan="4" styleClass="fonte13 fonteNegrito">
						<h:outputText value="#{item.descricao}" />
					</rich:column>
					<rich:subTable id="stblTempo" value="#{item.subItens}" var="subitem" >
					     <rich:column></rich:column>												
						 <rich:column styleClass="fonte13">
						         <h:outputText value="#{subitem.descricao}" /> 
						 </rich:column>
						 <rich:column styleClass="textoCentralizado fonte13">						          
						       <h:outputText value="#{subitem.quantidade}" />						        
						 </rich:column>
						 <rich:column styleClass="textoCentralizado fonte13 fontNegrito">						       
						      <h:outputText value="#{subitem.quantidade/item.quantidade*100}" >
						      	 <f:convertNumber pattern="##0.00"/>
						      </h:outputText>						       
						 </rich:column>
					</rich:subTable>										
				</rich:dataTable>          
        	</rich:simpleTogglePanel>
        
        </h:panelGroup>
        	<a4j:status id="statusPanel"
			   onstart="Richfaces.showModalPanel('panelStatus');" 
			    onstop="#{rich:component('panelStatus')}.hide()">
		</a4j:status>  
        
	</h:form>	
</ui:define>
</ui:composition>
</html>