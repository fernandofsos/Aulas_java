<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html
xmlns="http://www.w3.org/1999/xhtml"
xmlns:ui="http://java.sun.com/jsf/facelets"
xmlns:f="http://java.sun.com/jsf/core"
xmlns:h="http://java.sun.com/jsf/html"
xmlns:a4j="http://richfaces.org/a4j"
xmlns:rich="http://richfaces.org/rich"
xmlns:t="http://myfaces.apache.org/tomahawk">

<ui:composition template="template.xhtml">

	<ui:define name="headHtml">
	<!-- cs_indicador_dieta_zero.xhtml -->
		<link rel="stylesheet" type="text/css" href="CSS/layoutCsPaciente.css" />
	</ui:define>
		
	<ui:define name="conteudo">
		<rich:modalPanel id="panelStatus" autosized="true">  
			<h:panelGrid columns="2"> 
				<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
				<h:outputText value="Carregando..." />
			</h:panelGrid>
		</rich:modalPanel>
		
		<a4j:keepAlive beanName="indicadorDietaZeroForm" />
		
		<script>
			window.onload = '#{indicadorDietaZeroForm.carregaClinicas()}';
    	</script>
	
		<h:form id="formulario">
			<div class="cabAreaPesquisa">INDICADORES DE DIETA ZERO</div>
			<div class="areaPesquisa">
				<div style="margin-top: 20px; width: 100%;">
					<h:outputLabel value="Clínica: " for="selClinica" /><h:outputLabel style="color:red; font-size: 11px;" value=" *" />
					<h:selectOneMenu id="selClinica" value="#{indicadorDietaZeroForm.isnClinicaSelecionada}" >
						<f:selectItem itemLabel="Selecione uma clínica..." itemValue="0" />
						<t:selectItems value="#{indicadorDietaZeroForm.clinicas}" var="cli" itemValue="#{cli.isnClinica}" itemLabel="#{cli.dscClinica}" />
				    </h:selectOneMenu>
					<h:outputLabel value="Período: " style="font-weight: bold; margin-left: 20px;" />
					<rich:calendar
						value="#{indicadorDietaZeroForm.dataInicioFilter}"
						datePattern="dd/MM/yyyy"
						cellWidth="24px"
						style="width:200px"
						showWeeksBar="false"
						inputSize="10"
						enableManualInput="true"
						oninputkeypress="return formataData(event, this);"
						maxlength="10"
						inputClass="campoTextoSemColar"
					/>
					<h:outputText value="* " style="color:red; font-size: 11px;" />
					<h:outputText value=" à "/>
					<rich:calendar
						value="#{indicadorDietaZeroForm.dataFinalFilter}"
						datePattern="dd/MM/yyyy"
						cellWidth="24px"
						style="width:200px"
						showWeeksBar="false"
						inputSize="10"
						enableManualInput="true"
						oninputkeypress="return formataData(event, this);"
						maxlength="10"
						inputClass="campoTextoSemColar"
					/>
					<h:outputText value="* " style="color:red; font-size: 11px;" />	
		       		<a4j:commandButton
		       			value="Pesquisar"
			       		id="btnPesquisar" 
			    		actionListener="#{indicadorDietaZeroForm.calcularTotalizadores}" 
			    		oncomplete="avisosPesquisa('#{indicadorDietaZeroForm.erroPesquisa}')"
			 			reRender="formulario"
			 			style="margin-left: 20px; padding: 5px;"
			 			styleClass="botaoModal"
		 			/>
		 			<rich:jQuery selector=".campoTextoSemColar" query="bind('paste drop', function(event) {event.preventDefault();})" />
				</div>
				<br style="clear:both;"/>
			</div>
			
			<h:panelGrid columns="2" style="margin-top: 20px; margin-bottom: 20px;">
				<h:commandLink title="Imprimir em planilha excel" action="#{indicadorDietaZeroForm.imprimirExcel}">
					<h:graphicImage id="image" url="IMG/icone_xls.png" style="float:right;border:0px;"/>
				</h:commandLink>
				<a4j:commandLink
				style="margin-left: 15px;"
				target="_tab" title="Imprimir em PDF"
				id="imprimirIndicador"
				action="#{indicadorDietaZeroForm.gerarRelatorio}"
				oncomplete="window.open('#{indicadorDietaZeroForm.url}', '_tab');">
					<h:graphicImage id="imgRelatorioImprimir" url="images/icons/print_large.png" style="border:0;" />
				</a4j:commandLink>
			</h:panelGrid>
			
			<h:panelGroup columns="2">
				<fieldset style="width: 96%;">
					<h:outputText
					value="Nº TOTAL DE PACIENTES EM DIETA ZERO NO PERÍODO: #{indicadorDietaZeroForm.qtdTotalPacientes}"
					style="font-size:12px; font-weight: bold;">
					</h:outputText>
				</fieldset>
			</h:panelGroup>
			<br/>
			<h:panelGroup columns="1">
				<fieldset style="width: 96%;">
					<h:outputText value="Nº DE PACIENTES EM DIETA ZERO POR PERMANÊNCIA:" style="font-size:12px; font-weight: bold; "/>
					<br/>
					<rich:dataTable
					id="tableIndicadorPermanencia"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{indicadorDietaZeroForm.indicadorPorPermanenciaVos}"
					var="item" 
					rowKeyVar="linha" 
					style="width:100%;">
						<f:facet name="header">
							<rich:columnGroup>
								<h:column>
									<h:outputText value="Dieta Zero (Permanência)"/>
								</h:column>
								<h:column>
									<h:outputText value="Quantidade" />
								</h:column>
							</rich:columnGroup>
						</f:facet>
						<rich:column width="50%">
							<h:outputText value="#{item.descricao}"/>
						</rich:column>
						<rich:column width="15%" style="text-align:center;">
							<h:outputText value="#{item.quantidade}"/>
						</rich:column>
					</rich:dataTable>
				</fieldset>
			</h:panelGroup>					
			<br/>
			<h:panelGroup columns="1">
				<fieldset style="width: 96%;">
					<h:outputText value="TEMPO MÉDIO DE DIETA ZERO POR JUSTIFICATIVA:" style="font-size:12px; font-weight: bold; " />
					<br/>
					<rich:dataTable
					id="tableTempoMed"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{indicadorDietaZeroForm.indicadorPorJustificativaVos}"
					var="item" 
					rowKeyVar="linha" 
					style="width:100%;">
						<f:facet name="header">
							<rich:columnGroup>
								<h:column>
									<h:outputText value="Dieta Zero (Justificativa)"/>
								</h:column>
								<h:column>
									<h:outputText value="Tempo Médio" />
								</h:column>
								<h:column>
									<h:outputText value="Quantidade" />
								</h:column>
							</rich:columnGroup>
						</f:facet>
						<rich:column width="50%">
							<h:outputText value="#{item.descricao}"/>
						</rich:column>
						<rich:column width="35%" style="text-align:center;">
							<h:outputText value="#{item.justificativa}"/>
						</rich:column>
						<rich:column width="15%" style="text-align:center;">
							<h:outputText value="#{item.quantidade}"/>
						</rich:column>
					</rich:dataTable>
				</fieldset>
			</h:panelGroup>
			
			<script type="text/javascript">
				function avisosPesquisa(erro) {
	   				if(erro == 1 ) {
	   					alert('Data Inicial não pode ser vazia!');
	   				} else if(erro == 2 ) {
	   					alert('Data Final não pode ser vazia!');
	   				} else if(erro == 3 ) {
	   					alert('O campo Data Final deve ser igual ou maior que o campo Data Inicial!');   					
	   				} else if(erro == 4 ) {
	   					alert('Nenhum registro encontrado!');   					
	   				} else if(erro == 5 ) {
	   					alert('O campo clinica é obrigatório!');   					
	   				} else if(erro == 6 ) {
	   					alert('Nenhum resultado encontrado!');
	   				}
	   			}
			</script>
		</h:form>
	</ui:define>
</ui:composition>
</html>