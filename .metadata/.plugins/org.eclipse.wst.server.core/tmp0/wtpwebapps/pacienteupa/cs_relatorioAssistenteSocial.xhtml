<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:a4j="http://richfaces.org/a4j"
	  xmlns:rich="http://richfaces.org/rich">

<ui:composition template="template.xhtml">
<ui:define name="headHtml">
	<link rel="stylesheet" type="text/css" href="CSS/layoutCsPaciente.css" />
	</ui:define>
	<ui:define name="conteudo">

<a4j:keepAlive beanName="assistenteSocialForm" />

	<rich:modalPanel id="panelStatus" autosized="true">  
 		<h:panelGrid columns="2"> 
 			<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
 			<h:outputText value="Carregando..." />
 		</h:panelGrid> 
	</rich:modalPanel>

<a4j:form id="formPesquisaId">
   <div class="cabAreaPesquisa">SERVIÇO SOCIAL X PRODUTIVIDADE</div>		
    	<div style="padding:5px; display:inline-block; background: #BED6F8; margin: 0 0 10px 0; border: solid 1px #bbb;"> 	
			<label>Período:</label>
			<h:panelGroup>
				<rich:calendar value="#{assistenteSocialForm.datIniInicio}" datePattern="dd/MM/yyyy" cellWidth="18px" cellHeight="18px" style="width:180px" showWeeksBar="false" inputSize="10"  enableManualInput="true" oninputkeypress="return formataData(event, this);" maxlength="10" />
					<h:outputText value=" a " style="font-size:12px;"/>
				<rich:calendar value="#{assistenteSocialForm.datIniFim}" datePattern="dd/MM/yyyy" cellWidth="18px" cellHeight="18px" style="width:180px" showWeeksBar="false" inputSize="10"  enableManualInput="true" oninputkeypress="return formataData(event, this);" maxlength="10"/>
				
				<label>Categoria:</label>
				<h:selectOneMenu id="menuCategoria" value="#{assistenteSocialForm.isnCategoriaProf}">
					<f:selectItems value="#{assistenteSocialForm.sliCategoriaProf}"/>
				</h:selectOneMenu>
				
				<rich:spacer style="width: 5px;"/>			
						
	           	<a4j:commandButton image="IMG/pesquisa.gif" id="btnPesquisar" 
	           		        actionListener="#{assistenteSocialForm.pesquisarServicoSocial}" 
	           		        oncomplete="avisosPesquisa('#{assistenteSocialForm.mensagem}')"
		    				reRender="formPesquisaId,formPesquisaId:servicoSocial" />			
			</h:panelGroup>
			<br />
		</div>
	<br />
	
	<h:panelGrid style="width: 100%;">
			<rich:dataTable id="servicoSocial"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{assistenteSocialForm.lista}"
					rendered="#{not empty assistenteSocialForm.lista}" 
					var="social" 
					rowKeyVar="myRow" 
					style="width: 100%;"
					reRender="ds">
					
				<f:facet name="header">
					<rich:columnGroup>
						<rich:column>
							<h:outputText value="Profissional" />
						</rich:column>
						<rich:column>
							<h:outputText value="" />
						</rich:column>
						<rich:column>
							<h:outputText value="Quantidade" />
						</rich:column>
					</rich:columnGroup>
				</f:facet>			
				
				<rich:column style="background:#CCCCCC;">
					<h:graphicImage id="expandMostrar" value="IMG/expand.gif" rendered="#{!social.mostrarDeclaracoes}">
						<a4j:support event="onclick" reRender="formPesquisaId, formPesquisaId:servicoSocial">
							<f:setPropertyActionListener value="#{true}" target="#{social.mostrarDeclaracoes}" />
						</a4j:support>
					</h:graphicImage>
					<h:graphicImage id="expandEsconder" value="IMG/collapse.gif" rendered="#{social.mostrarDeclaracoes}">
						<a4j:support event="onclick" reRender="formPesquisaId:servicoSocial">
							<f:setPropertyActionListener value="#{false}" target="#{social.mostrarDeclaracoes}" />
						</a4j:support>
					</h:graphicImage>
					<rich:spacer width="10"/>
					<h:outputText value="#{social.nomeProfissional}" />
				</rich:column>
				<rich:column style="background:#CCCCCC;text-align: center;">
				</rich:column>
				<rich:column style="background:#CCCCCC;text-align: center;">
					<h:outputText value="#{social.totalDeclaracoes + social.totalAnotacoes + social.totalBaixaRisco}" />
					<rich:subTable id="subItens" var="subSocial" value="#{social.listaDeclaracoes}" rendered="#{social.mostrarDeclaracoes}" rowKeyVar="rowDeclaracao">
						<rich:column style="text-align: left;background:#EEEEEE;" rowspan="#{social.listaDeclaracoes.size()}" rendered="#{rowDeclaracao eq 0}">
							<b><h:outputText value="DECLARAÇÕES (TOTAL: #{social.totalDeclaracoes})" /></b>
						</rich:column>					
						<rich:column style="text-align: center;background:#EEEEEE;">
							<h:outputText value="#{subSocial.descricao}" />
						</rich:column>					
						<rich:column style="text-align: center;background:#EEEEEE;">
							<h:outputText value="#{subSocial.quantidade}" />
						</rich:column>					
					</rich:subTable>				
					<rich:subTable id="subItens2" var="subSocial2" value="#{social.listaAnotacoes}" rendered="#{social.mostrarDeclaracoes}" rowKeyVar="rowAnotacao">
						<rich:column style="text-align: left;background:#EEEEEE;" rowspan="#{social.listaAnotacoes.size()}" rendered="#{rowAnotacao eq 0}">
							<b><h:outputText value="ANOTAÇÕES (TOTAL: #{social.totalAnotacoes})" /></b>
						</rich:column>					
						<rich:column style="text-align: center;background:#EEEEEE;">
							<h:outputText value="#{subSocial2.descricao}" />
						</rich:column>					
						<rich:column style="text-align: center;background:#EEEEEE;">
							<h:outputText value="#{subSocial2.quantidade}" />
						</rich:column>					
					</rich:subTable>					
					<rich:subTable id="subItens3" var="subSocial3" value="#{social.listaBaixaRisco}" rendered="#{social.mostrarDeclaracoes}" rowKeyVar="rowBaixaRisco">
						<rich:column style="text-align: left;background:#EEEEEE;" rowspan="#{social.listaBaixaRisco.size()}" rendered="#{rowBaixaRisco eq 0}">
							<b><h:outputText value="BAIXAS (TOTAL: #{social.totalBaixaRisco})" /></b>
						</rich:column>					
						<rich:column style="text-align: center;background:#EEEEEE;">
							<h:outputText value="#{subSocial3.descricao}" />
						</rich:column>					
						<rich:column style="text-align: center;background:#EEEEEE;">
							<h:outputText value="#{subSocial3.quantidade}" />
						</rich:column>					
					</rich:subTable>					
				</rich:column>
			</rich:dataTable>				
	</h:panelGrid>
	
	
	 
    <a4j:status id="statusPanel"
		   	onstart="Richfaces.showModalPanel('panelStatus');" 
		    onstop="#{rich:component('panelStatus')}.hide()">
	</a4j:status>	
	
	<script type="text/javascript">
	     function avisosPesquisa(msg) {
		     if(msg != '')
		     {
			     alert(msg);
		     }
	     }
	</script>
</a4j:form>	
</ui:define>
</ui:composition>
</html>