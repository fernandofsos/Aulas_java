<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich"
      xmlns:t="http://myfaces.apache.org/tomahawk">
      
<ui:composition template="template.xhtml">
	<ui:define name="headHtml">
		<!-- cs_emergencia -->
	</ui:define>
	<ui:define name="conteudo">    
	<!-- MODAL PANEL DE CLASSIFICAÇÃO DE RISCO -->
	 <a4j:keepAlive beanName="emergenciaForm" />
	 <a4j:keepAlive beanName="prescricaoForm" />
	 <a4j:keepAlive beanName="obitoForm" />
	 
	<rich:modalPanel id="panelStatus" autosized="true">  
 		<h:panelGrid columns="2"> 
 			<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
 			<h:outputText value="Carregando..." />
 		</h:panelGrid> 
	</rich:modalPanel>	 
	 
	 <rich:modalPanel id="panPaciente" autosized="false" width="600" height="400" resizeable="true" headerClass="headerPanel3">
		
    	<f:facet name="header">
			<h:panelGroup>
       			<h:outputText value="DADOS DO PACIENTE"></h:outputText>
       		</h:panelGroup>
    	</f:facet>
    	<f:facet name="controls">
    	 	<h:panelGroup>
        		<h:graphicImage value="IMG/fechar.png" id="fechaPanel"/>
        		<rich:componentControl for="panPaciente" attachTo="fechaPanel" operation="hide" event="onclick" />
        	</h:panelGroup>
    	</f:facet>
    	<div>
    		<ui:include src="panelDadosPaciente.xhtml"/>
    	</div> 
   	</rich:modalPanel>
	 
	<rich:modalPanel id="panelRisco" autosized="true" width="600" resizeable="false" headerClass="headerPanel">
		<!-- BARRA DE TITULO MODAL-->
        <f:facet name="header">            
            <h:outputText value="Classificação de Risco"></h:outputText>            
        </f:facet>

       
       	<!-- CAMPOS DE BUSCA -->			 
   	    <h:form id="formularioPanelRiscoId">
   	    	
	        <div class="dadosPaciente">
			    <div class="col385">
			       	<label style="width: 60px; display: inline-block">Paciente: </label>
					<h:outputText value="#{emergenciaForm.paciente.dscNome}" style="font-weight: bold" />
				</div>
				<div class="col170">
					<label>Nº atendimento: </label>
					<h:outputText value="#{emergenciaForm.paciente.isnInternacao}" style="font-weight: bold" />
				</div>
				<div class="col385">
					<label>Data entrada: </label>
					<h:outputText value="#{emergenciaForm.paciente.datCadastro}" style="font-weight: bold">
				       <f:convertDateTime pattern="dd/MM/yyyy"/>				       
					</h:outputText>
					<h:outputText value=" #{emergenciaForm.paciente.horChegada}" style="font-weight: bold"/>
				</div>
				<div class="col170">
				    <div style="float: left; margin-right: 10px">
						<label>Idade: </label>
						<h:outputText value="#{emergenciaForm.paciente.idade}" style="font-weight: bold"/>
					</div>
					<div>
						<label>Sexo: </label>
						<h:outputText value="#{emergenciaForm.paciente.sglSexo}" style="font-weight: bold"/>
					</div>
				</div>
			</div>
        	<div class="geralCampos" style="font-size: 13px">
			    <h:panelGroup styleClass="linhaFormulario" layout="block">
			    	<div class="col270">	    
						<label>Última Classificação:</label>
						<h:graphicImage rendered="#{not empty emergenciaForm.paciente.isnRisco}" url="IMG/#{emergenciaForm.imagensRiscos[emergenciaForm.paciente.isnRisco]}" style="border:0; " />
					</div>
					<div class="col270">
						<label>Data de registro:</label>
						<h:outputText value="#{emergenciaForm.paciente.datRegistro}" style="font-weight: bold">
					    	<f:convertDateTime pattern="dd/MM/yyyy"/>
						</h:outputText>
						<h:outputText value=" #{emergenciaForm.paciente.horRegistro}" style="font-weight: bold"/>
					</div>
				</h:panelGroup>
			</div>	
			<div class="geralCampos">
				<div class="linhaFormulario" >
				    <div style="float: left; margin-right: 40px">		
						<label class="col90" style="font-size: 13px" >Queixa:</label>
						<h:inputText value="#{emergenciaForm.cr.dscQueixa}" maxlength="350" styleClass="campoTexto" style="width: 350px"/>
					</div>
				</div>	
				<h:panelGroup styleClass="linhaFormulario" layout="block" rendered="false">	
					<label class="col90" style="font-size: 13px">Dengue?</label>
			   		<h:selectOneRadio value="#{emergenciaForm.cr.flgDengue}">
						<f:selectItem itemValue="S" itemLabel="Sim"/>
						<f:selectItem itemValue="N" itemLabel="Não"/>
						<a4j:support event="onclick" actionListener="#{emergenciaForm.limparCorDengue}" reRender="formularioPanelRiscoId, formularioPanelRiscoId:coresDengueId"/>
					</h:selectOneRadio>	      			
				</h:panelGroup>
				
				<h:panelGroup styleClass="linhaFormulario" layout="block">	
					<label class="col90" style="font-size: 13px" >Fluxograma: *</label>
					<h:selectOneMenu id="ddpFluxograma" 
					                 value="#{emergenciaForm.objFluxograma.isnFluxograma}" style="width:350px;">
						<f:selectItems value="#{emergenciaForm.sliFluxogramas}" />
					</h:selectOneMenu>
				</h:panelGroup>
				
				<h:panelGroup styleClass="linhaFormulario" layout="block">	
					<label class="col90" style="font-size: 13px"  >Discriminador: *</label>
					<h:inputText value="#{emergenciaForm.cr.dscDiscriminador}"
					             maxlength="60" 
					             styleClass="campoTexto" 
					             style="width:350px;"/>
				</h:panelGroup>
				
				<h:panelGroup styleClass="linhaFormulario" layout="block">	
					<label class="col90" style="font-size: 13px">Classificação: *</label>
					<h:selectOneMenu id="dropHospitalDestino" 
					                 value="#{emergenciaForm.isnRisco}" 
					                 style="width:350px;">
						<f:selectItems value="#{emergenciaForm.lstRiscos}" />
					</h:selectOneMenu>					
				</h:panelGroup>
				
				<h:panelGroup id="coresDengueId" styleClass="linhaFormulario" layout="block" rendered="#{false}">	
					<label class="col90" style="font-size: 13px">Cor Dengue:</label>
					<h:selectOneMenu id="corDengueId" 
					                 value="#{emergenciaForm.cr.isnRiscoDengue}" 
					                 rendered="#{not empty emergenciaForm.lstRiscosDengue}">
						<f:selectItems value="#{emergenciaForm.lstRiscosDengue}" />
						<a4j:support event="onchange" actionListener="#{emergenciaForm.carregaGrupoCor}" reRender="formularioPanelRiscoId"/>
					</h:selectOneMenu>	
					<h:outputText value="#{emergenciaForm.dscCorGrupoDengue}" id="grupoCorDengueId" rendered="#{emergenciaForm.cr.isnRiscoDengue > 0}" style="width:60px;font-weight: bold"/>				
				</h:panelGroup>
				
				<h:panelGroup styleClass="linhaFormulario" layout="block">	
					<label class="col90" style="font-size: 13px" >Destino: *</label>
					    <h:selectOneMenu id="dropEspecialidade" 
						                 value="#{emergenciaForm.isnEspecialidadeEmergencia}" 
						                 style="width:350px;">
						<f:selectItems value="#{emergenciaForm.lstEspecialidadeEmergencia}" />
						<!-- 
						<a4j:support event="onchange" reRender="formularioPanelRiscoId" />
						 -->
					</h:selectOneMenu>
				</h:panelGroup>
				
				<h:panelGroup styleClass="linhaFormulario" layout="block">	
					
						<h:panelGrid columns="2" style="float:left;">
						<label>Risco de Queda: *</label>
						<h:selectOneRadio value="#{emergenciaForm.cr.flgRiscoQueda}">
			 		 			<f:selectItem itemLabel="Sim" itemValue="S" />
			 		 			<f:selectItem itemLabel="Não" itemValue="N" />
   			 	       	</h:selectOneRadio>	
					</h:panelGrid>
						
					
					<h:panelGrid columns="2"  style="float:left;">
						<label>Alergia: *</label>
						<h:selectOneRadio value="#{emergenciaForm.objPaciente.flgAlergia}" >
			 		 			<f:selectItem itemLabel="Sim" itemValue="S" />
			 		 			<f:selectItem itemLabel="Não" itemValue="N" />
   			 	       	</h:selectOneRadio>	
					</h:panelGrid>
					<h:panelGrid columns="2" style="float:left;">
					<label>Dengue: *</label>
						<h:selectOneRadio value="#{emergenciaForm.cr.flgDengue}" style="float:left;margin:0">
			 		 			<f:selectItem itemLabel="Sim" itemValue="S" />
			 		 			<f:selectItem itemLabel="Não" itemValue="N" />
			 		 			<a4j:support event="onclick" reRender="formularioPanelRiscoId" actionListener="#{emergenciaForm.validaChikungunya}" />
   			 	       	</h:selectOneRadio>	
					</h:panelGrid>
					
					<h:panelGrid columns="2" style="float:left;" rendered="#{emergenciaForm.cr.flgDengue == 'S' or emergenciaForm.cr.flgDengue == null }">
					<label>Primeiro sintoma dengue *</label>
					 	 <rich:calendar value="#{emergenciaForm.datSintomaDengue}" datePattern="dd/MM/yyyy" showWeeksBar="false" 
					 					enableManualInput="false" oninputkeypress="return formataData(event, this);" id="dtSint"
					 					maxlength="10" inputStyle="height:14px;font-size:8pt!important;" 
					 					ondateselected="checkarDataMaior(this,event.rich.date);"
										oninputchange="checkarDataMaior(this,event.rich.date);"/>
					</h:panelGrid>
					<h:panelGrid columns="2">
						<label>Chikungunya: *</label>
						<h:selectOneRadio value="#{emergenciaForm.cr.flgChikungunya}"
							style="float:left;margin:0">
							<f:selectItem itemLabel="Sim" itemValue="S" />
							<f:selectItem itemLabel="Não" itemValue="N" />
							<a4j:support event="onclick" reRender="formularioPanelRiscoId" actionListener="#{emergenciaForm.validaDengue}" />
						</h:selectOneRadio>
						
					</h:panelGrid>
					<h:panelGrid columns="2" rendered="#{emergenciaForm.cr.flgChikungunya == 'S' }">
							<label>Primeiro sintoma chikungunya *</label>
							<rich:calendar value="#{emergenciaForm.datSintomaChikungunya}"
								datePattern="dd/MM/yyyy" showWeeksBar="false"
								enableManualInput="false"
								oninputkeypress="return formataData(event, this);"
								id="dtSintChiku" maxlength="10"
								inputStyle="height:14px;font-size:8pt!important;"
								ondateselected="checkarDataMaior(this,event.rich.date);"
								oninputchange="checkarDataMaior(this,event.rich.date);" />
						</h:panelGrid>
				</h:panelGroup>

					<h:panelGroup styleClass="linhaFormulario">	
					<h:panelGrid columns="2">
						<label>Suspeita de Infecção *</label>
						<h:selectOneRadio value="#{emergenciaForm.cr.flgSuspeitaInfeccao}" style="float:left;margin:0">
			 		 			<f:selectItem itemLabel="Sim" itemValue="S" />
			 		 			<f:selectItem itemLabel="Não" itemValue="N" />
			 		 			<a4j:support event="onclick" oncomplete="if (#{emergenciaForm.cr.flgSuspeitaInfeccao == 'S'}){document.getElementById('formularioPanelRiscoId:limpaLista').click();}" 
			 		 			 />
	  			 	       	</h:selectOneRadio>	
	  			 	<a4j:commandButton id="limpaLista" style="display:none;" action="#{emergenciaForm.iniciarMapSinaisSirs}" oncomplete="Richfaces.showModalPanel('panelSuspeitaInfeccao');" 
	  			 	reRender="panelSuspeitaInfeccao,formularioPanelRiscoId:btnOkRisco" ajaxSingle="true"/>
	  			 	</h:panelGrid>
				</h:panelGroup>			
						
				<div class="linhaFormulario" style="height:5px;">
				   <div style="float: left;width:60px;font-weight: bold">		
						<label>SatO2:</label>
					</div>
					<div style="float: left;width:90px;font-weight: bold">		
						<label>Glasgow:</label>
					</div>
					<div style="float: left;width:90px;font-weight: bold">		
						<label>Temp:</label>
					</div>
					<div style="float: left;width:90px;font-weight: bold">		
						<label>Glicemia:</label>
					</div>
					<div style="float: left;width:90px;font-weight: bold">		
						<label>Régua Dor:</label>
					</div>
					<div style="float: left;width:50px;font-weight: bold;">		
						<label>FC:</label>
					</div>
				</div>
				
				<div class="linhaFormulario">
				   <div style="float: left;width:60px;font-weight: bold">		
						<h:inputText value="#{emergenciaForm.cr.dscSato2}" maxlength="4" styleClass="campoTexto" style="width: 40px"/>
					</div>
					<div style="float: left;width:90px;font-weight: bold">		
						<h:inputText value="#{emergenciaForm.cr.dscGlassgow}" maxlength="2" styleClass="campoTexto" style="width: 60px"/>
					</div>
					<div style="float: left;width:90px;font-weight: bold">		
						<h:inputText value="#{emergenciaForm.cr.dscTemperatura}" maxlength="4" styleClass="campoTexto" style="width: 50px"/>
					</div>
					<div style="float: left;width:90px;font-weight: bold">		
						<h:inputText value="#{emergenciaForm.cr.dscGlicemia}" maxlength="3" styleClass="campoTexto" style="width: 50px"/>
					</div>
					<div style="float: left;width:90px;font-weight: bold">		
						<h:inputText value="#{emergenciaForm.cr.dscReguaDor}" maxlength="2" styleClass="campoTexto" style="width: 50px"/>
					</div>
					<div style="float: left;width:50px;font-weight: bold;">		
						<h:inputText value="#{emergenciaForm.cr.dscFc}" maxlength="3" styleClass="campoTexto" style="width: 40px"/>
					</div>
				</div>					
							
				<div class="linhaSeparadora" />
				<div class="linhaFormulario" >
				    <div style="float: left; margin-right: 40px">		
						<label>Usuário/Conselho: *</label>
						<h:inputText value="#{emergenciaForm.usuario}" maxlength="20" styleClass="campoTexto" style="width: 90px"/>
					</div>
					<div style="float: left;">		
						<label>Senha/Assinatura: *</label>
						<h:inputSecret value="#{emergenciaForm.senha}" maxlength="20" styleClass="campoTexto"  style="width: 90px"/>
					</div>
				</div>		
			</div>
			<div style="text-align: center; margin-top: 10px">
				<a4j:commandButton id="btnOkRisco" value="OK"
								   action="#{emergenciaForm.classificarRisco}"				    
								   reRender="tabEmergencia,totaisEmergencia"
								   style="margin-right: 10px"
								   styleClass="botaoModal"
								   oncomplete="this.disabled=false; avisosValidacao(#{emergenciaForm.avisoValidacao}, 'panelRisco', false)"
								   onclick="this.disabled=true" >				
				</a4j:commandButton>
					
				
				
				<a4j:commandButton id="btnCancelRisco"  value="Cancelar"  styleClass="botaoModal" action="#{emergenciaForm.fechaPanel}" onclick="Richfaces.hideModalPanel('panelRisco');" reRender="csEmergencia"/>
			</div>
	    </h:form>	
	</rich:modalPanel>	

	<rich:modalPanel id="panelSuspeitaInfeccao" width="300" autosized="true" headerClass="headerPanel3">
		<f:facet name="header">
			<h:outputText value="Escolha uma opção"></h:outputText>		
		</f:facet>  
    	<div>
    		<h:form id="formSuspeitaInfeccao">
    			<h:panelGroup>
    			<ui:repeat var="item" value="#{emergenciaForm.listSinaisSirs}">
       				 <h:selectBooleanCheckbox  style="margin-right:6px;" value="#{emergenciaForm.checkMapSinaisSirs[item]}"/>
       				  <h:outputText style="font-size:11px;" value="#{item.dscSinaisSirs}" /><br/>
   					 </ui:repeat>
				   
			    	<br/>
			    	<div align="center">
				    	<a4j:commandButton id="btnOkInfec" value="OK" styleClass="botaoModal" action="#{emergenciaForm.gravarSinaisSirs}"
				    	 reRender="formularioPanelRiscoId,btnOkRisco" oncomplete="validarRiscoInfeccao('#{emergenciaForm.mensagem}', 'panelSuspeitaInfeccao');"/>
					</div>
			    </h:panelGroup>
		    </h:form>
		</div>	
	</rich:modalPanel>
		
	<rich:modalPanel id="panConfirmacaoAtendimento" width="300" autosized="true" headerClass="headerPanel3">
		<f:facet name="header">
			<h:outputText value="CONFIRMAÇÃO"></h:outputText>		
		</f:facet>  
		<f:facet name="controls">
    	 	<h:panelGroup>
        		<h:graphicImage value="IMG/fechar.png" id="fechaPanelConfirmacaoAtendimento"/>
        		<rich:componentControl for="panConfirmacaoAtendimento" attachTo="fechaPanelConfirmacaoAtendimento" operation="hide" event="onclick" />
        	</h:panelGroup>
    	</f:facet>
    	<div>
	    	<p>Deseja realmente atender este paciente?</p>
		</div>
    	
    	<br/>	
		<h:form id="formAtendimento">
			<div style="margin-top: 10px; text-align: center">
				<a4j:commandButton value="Sim" id="btnSim" style="height: 20px; width: 80px" action="#{emergenciaForm.modalAtendimentoMedico}" oncomplete="avisosValidacaoChamada(#{emergenciaForm.avisoValidacao}, '#{emergenciaForm.nomeProfissionalAtendimento}')" onclick="Richfaces.hideModalPanel('panConfirmacaoAtendimento');"/>
				<a4j:commandButton value="Não" id="btnNão" style="height: 20px; width: 80px" onclick="Richfaces.hideModalPanel('panConfirmacaoAtendimento');"/>
			</div>
		</h:form>
	</rich:modalPanel>
	
	<rich:modalPanel id="panConfirmacaoRisco" width="300" autosized="true" headerClass="headerPanel3">
		<f:facet name="header">
			<h:outputText value="CONFIRMAÇÃO"></h:outputText>		
		</f:facet>  
		<f:facet name="controls">
    	 	<h:panelGroup>
        		<h:graphicImage value="IMG/fechar.png" id="fechaPanelConfirmacaoRisco"/>
        		<rich:componentControl for="panConfirmacaoRisco" attachTo="fechaPanelConfirmacaoRisco" operation="hide" event="onclick" />
        	</h:panelGroup>
    	</f:facet>
    	<div>
	    	<p>Deseja realmente classificar este paciente?</p>
		</div>
    	
    	<br/>	
		<h:form id="formRisco">
			<div style="margin-top: 10px; text-align: center">
				<a4j:commandButton value="Sim" id="btnSim" style="height: 20px; width: 80px" action="#{emergenciaForm.limparCampoModal}" oncomplete="avisosValidacaoChamada(#{emergenciaForm.avisoValidacao}, '#{emergenciaForm.nomeProfissionalAtendimento}')" onclick="Richfaces.hideModalPanel('panConfirmacaoRisco');" reRender="panelRisco"/>
				<a4j:commandButton value="Não" id="btnNão" style="height: 20px; width: 80px" onclick="Richfaces.hideModalPanel('panConfirmacaoRisco');"/>
			</div>
		</h:form>
	</rich:modalPanel>
 	 	
 	 <rich:modalPanel id="panelPeso" autosized="true" width="300" resizeable="false" headerClass="headerPanel">
		<!-- BARRA DE TITULO MODAL-->
        <f:facet name="header">            
            <h:outputText value="Atendimento Enfermagem"></h:outputText>            
        </f:facet>
       
       	<!-- CAMPOS DE BUSCA -->			 
   	    <h:form>
	               			
        	<div class="geralCampos">
				<div class="linhaFormulario" >
					<div style="float: left;">		
						<label>Peso Paciente:</label>
						<h:inputText value="#{emergenciaForm.strPeso}" maxlength="10" styleClass="campoTexto" style="width: 40px"/> <label>Kg</label>
					</div>
				</div>	
			</div>	
			
			<div style="text-align: center; margin-top: 10px">
				<a4j:commandButton id="btnOkPeso" value="OK" 
								   action="#{emergenciaForm.pesoClassificacaoRisco}"				    
								   reRender="tabEmergencia,totaisEmergencia"
								   style="margin-right: 10px" 
								   styleClass="botaoModal"
								   oncomplete="this.disabled=false; avisosValidacao(#{emergenciaForm.avisoValidacao}, 'panelPeso', false)"
								   onclick="this.disabled=true">	
								   
								   <rich:componentControl for="panelRisco" attachTo="btnOkPeso" operation="hide" event="onclick" />			
				</a4j:commandButton>			
			</div>
	    </h:form>	
	 </rich:modalPanel>
 	

	<!-- MODAL PANEL DE baixa --> 
	<rich:modalPanel id="panelBaixa" autosized="true" width="600" resizeable="false" headerClass="headerPanel">
		<!-- BARRA DE TITULO MODAL-->
        <f:facet name="header">            
            <h:outputText value="Atendimento Baixa"></h:outputText>            
        </f:facet>

        <f:facet name="controls">
            <h:panelGroup>
                <h:graphicImage value="IMG/fechar.png" id="fechar3" />
                <rich:componentControl for="panelBaixa" attachTo="fechar3" operation="hide" event="onclick" />
            </h:panelGroup>
        </f:facet>
       	<!-- CAMPOS DE BUSCA -->			 
   	    <h:form>
	        <div class="dadosPaciente">
			    <div class="col400">
			       	<label>Paciente: </label>
					<h:outputText value="#{emergenciaForm.paciente.dscNome}" style="font-weight: bold" />
				</div>
				<div class="col150">
					<label>Nº atendimento: </label>
					<h:outputText value="#{emergenciaForm.paciente.isnInternacao}" style="font-weight: bold" />
				</div>
				<div class="col380">
				    <label>Data entrada: </label>
					<h:outputText value="#{emergenciaForm.paciente.datCadastro}" style="font-weight: bold">
				    	<f:convertDateTime pattern="dd/MM/yyyy"/>				       
					</h:outputText>
					<h:outputText value=" #{emergenciaForm.paciente.horChegada}" style="font-weight: bold"/>									
				</div>
				<div class="col170">
				    <div style="float: left; margin-right: 10px">
						<label>Idade: </label>
						<h:outputText value="#{emergenciaForm.paciente.idade}" style="font-weight: bold"/>
					</div>
					<div>
						<label>Sexo: </label>
						<h:outputText value="#{emergenciaForm.paciente.sglSexo}" style="font-weight: bold"/>
					</div>
				</div>
			</div>			
        	<div class="geralCampos">
				<div class="col70">
					<label>Risco: </label><br/>
					<h:graphicImage url="IMG/#{emergenciaForm.imagensRiscos[emergenciaForm.paciente.isnRisco]}" 
					                style="border:0; " />
				</div>
				<div class="col230">
					<label>Fluxograma: </label><br/>
					<h:outputText value="#{emergenciaForm.paciente.dscFluxograma}" style="font-weight: bold"/>
				</div>				
				<div class="col250">
					<label>Discriminador: </label><br/>
					<h:outputText value="#{emergenciaForm.paciente.dscDiscriminador}" style="font-weight: bold"/>
				</div>
			</div>			
        	<div class="geralCampos">
        	    <h:panelGroup styleClass="linhaFormulario" layout="block">		
					<label>Motivo da Baixa:</label><br/>
					<h:inputTextarea value="#{emergenciaForm.textoAtendimento}"
					                 styleClass="campoObservacao" 
				                 	 style="width: 540px" 
				                     onkeyup="limitarTamanhoCampo(this,1000)"/>
				</h:panelGroup>									
				<div class="linhaFormulario" >
				    <div style="float: left; margin-right: 40px">		
						<label>Usuário:</label>
						<h:inputText value="#{emergenciaForm.usuario}" maxlength="20" styleClass="campoTexto" 
						             style="width: 90px"/>
					</div>
					<div style="float: left;">		
						<label>Senha:</label>
						<h:inputSecret value="#{emergenciaForm.senha}" maxlength="20" styleClass="campoTexto" 
						               style="width: 90px"/>
					</div>
				</div>	
			</div>	
			
			<div style="text-align: center; margin-top: 10px">
				<a4j:commandButton id="btnOkAtend" value="OK" 
								   action="#{emergenciaForm.baixarPaciente()}"				    
								   reRender="tabEmergencia,totaisEmergencia"
								   style="margin-right: 10px" 
								   styleClass="botaoModal"
								   oncomplete="this.disabled=false; avisosValidacao(#{emergenciaForm.avisoValidacao}, 'panelBaixa', false)"
								   onclick="this.disabled=true" >				
				</a4j:commandButton>			
				<a4j:commandButton id="btnCancelAtend"  value="Cancelar"  styleClass="botaoModal">
					<rich:componentControl for="panelBaixa" attachTo="btnCancelAtend" operation="hide" event="onclick" />
				</a4j:commandButton>
			</div>
	    </h:form>	
	 </rich:modalPanel>
	 
	<h:form id="csEmergencia" >
	 	<div class="cabAreaPesquisa">PACIENTES RECEPÇÃO</div>
		<h:panelGroup styleClass="areaPesquisa" layout="block" id="totaisEmergencia" style="height:130px;">
		    <div class="col150" style="text-align: center; margin-right: 40px">		       
		   	   <label><b>Pacientes em Espera</b></label><br/>
		       <label class="totalizador">#{emergenciaForm.totalEmergencia}</label>
		    </div>		    		    
		    <div class="colLeft">
		        <div class="col90" style="height: 60px;">
		            <br/>
					<label><b>Classificação de Risco</b></label>		        		
				</div>    
		    	<div class="col320" style="overflow:hidden; border: solid 1px #999;">
		      		<div class="totaisRisco bordaDir bordaBot">
		           		<h:graphicImage url="IMG/risco_vermelho.gif" style="vertical-align: middle"/>
				   		<label> <b>#{emergenciaForm.totaisRisco[0]}</b></label>			
		        	</div>
		      		<div class="totaisRisco bordaDir bordaBot">
		           		<h:graphicImage url="IMG/risco_laranja.gif" style="vertical-align: middle"/>
				   		<label><b>#{emergenciaForm.totaisRisco[1]}</b></label>					
		      		</div>
		      		<div class="totaisRisco bordaDir bordaBot">
		           		<h:graphicImage url="IMG/risco_amarelo.gif" style="vertical-align: middle"/>
				   		<label><b>#{emergenciaForm.totaisRisco[2]}</b></label>				
		        	</div>
		      		<div class="totaisRisco bordaBot">
		           		<h:graphicImage url="IMG/risco_verde.gif" style="vertical-align: middle"/>
				   		<label><b>#{emergenciaForm.totaisRisco[3]}</b></label>			
		        	</div>		        	
		        	<br style="clear: both"/>		        
		         	<div class="totaisRisco bordaDir">
		           		<h:graphicImage url="IMG/risco_azul.gif" style="vertical-align: middle"/>
				   		<label><b>#{emergenciaForm.totaisRisco[4]}</b></label>					
		      		</div>
		      		<div class="totaisRisco bordaDir">
		           		<h:graphicImage url="IMG/risco_branco.gif" style="vertical-align: middle"/>
				   		<label><b>#{emergenciaForm.totaisRisco[5]}</b></label>				
		        	</div>
		        	<div class="totaisRisco bordaDir">
		           		<h:graphicImage url="IMG/risco_cinza.gif" style="vertical-align: middle"/>
				   		<label><b>#{emergenciaForm.totaisRisco[6]}</b></label>				
		        	</div>
		        	<div class="totaisRisco" >
		           		<h:graphicImage url="IMG/risco_preto.gif" style="padding-left:7px; padding-top:6px;" />
				   		<label style="padding-left:4px;"  >#{emergenciaForm.totaisRisco[7]}</label>				
		        	</div>
		        </div>
		    </div>	
		    <div class="col180" style="height: 60px; text-align: center;">
		        <br/>
		        <a4j:commandButton id="btnRefresh" 
		       		image="IMG/atualizar2.gif"
		       		alt="Atualizar lista" 
	                action="#{emergenciaForm.atualizarListaEmergencia}"
		    		reRender="tabEmergencia,totaisEmergencia" />		
		    </div>	    
   		</h:panelGroup>   		 		
   		<div>
   			<rich:dataTable id="tabEmergencia"
							onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
							onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
							value="#{emergenciaForm.listaPacientesRecepcao}" 
							var="paciente"
							rows="30"					 
							style="width: 100%"										 
							reRender="ds,totaisEmergencia">
				<f:facet name="header">
					<rich:columnGroup>											
						<h:column> <h:outputText value="" /> </h:column>												
						<h:column> <h:outputText value="Risco" /> </h:column>
						<h:column> <h:outputText value="N° Atend." /> </h:column>
						<h:column> <h:outputText value="Paciente" /> </h:column>
						<h:column> <h:outputText value="Data/Hora" /> </h:column>						
						<h:column> <h:outputText value="T.Emerg."/> </h:column>
						<h:column> <h:outputText value="T.Risco"/> </h:column>						
						<h:column> <h:outputText value="Idade"/> </h:column>						
						<h:column> <h:outputText value="Especialidade" /> </h:column>
						<h:column> <h:outputText value="Impressão" /> </h:column>
						<h:column> <h:outputText value="Ações" /> </h:column>
					</rich:columnGroup>
				</f:facet>			
				<!-- PRONTUARIO -->
				<rich:column width="6%">
					<center>			
					    <a4j:outputPanel styleClass="linhaFormulario" layout="block">
					    	<h:graphicImage url="IMG/#{emergenciaForm.imagensRiscos[paciente.isnRisco]}" style="border:0;" />
					    	<rich:toolTip direction="bottom-right" layout="block" rendered="#{paciente.isnRisco != 0}"
					    	              styleClass="tooltipEmergencia">
								<f:facet name="defaultContent">
									<strong>Aguarde...</strong>
								</f:facet>
								<div>
								    <label>Fluxograma:</label>
								    <h:outputText value="#{paciente.dscFluxograma}" style="font-weight: bold"/>
								    <br/>
								    <label>Queixa:</label>
								    <h:outputText value="#{paciente.dscQueixa}" style="font-weight: bold"/>
								    <br/>
								    <label>Encaminhamento:</label>
								    <h:outputText value=" " style="font-weight: bold"/>
								    <br/>
								    <label>Tempo Classificação (HH:mm):</label>
								    <h:outputText value="#{paciente.tempoClassificacaoRisco}" style="font-weight: bold"/>
								</div>
							</rich:toolTip>					    	
					    </a4j:outputPanel>															
					</center>
				</rich:column>
				
				<!-- RISCO -->
				<rich:column>
					<center>
						<div style="display:#{paciente.flgAlergia == 'S'?'':'none'}">
							<h:outputText value="Alergia" style="color:blue; font-size:11px"/>
						</div>
						<div style="display:#{paciente.flgRiscoQueda == 'S'?'':'none'}">
							<h:outputText value="Queda" rendered="#{paciente.flgRiscoQueda == 'S'}" style="color:red; font-size:11px"/>
						</div>
					</center>
					
				</rich:column>
				
				<!-- ATENDIMENTO -->
				<rich:column>
					<center>
						<h:outputText value="#{paciente.isnInternacao}" />
					</center>
				</rich:column>
				
				<!-- NOME -->
				<rich:column> 
				
          			<a4j:commandLink styleClass="link" oncomplete="#{rich:component('panPaciente')}.show();" value="#{paciente.dscNome}" action="#{farmaciaForm.popularDadosPaciente}" reRender="panPaciente">
          				<f:setPropertyActionListener target="#{farmaciaForm.isnPaciente}" value="#{paciente.isnPaciente}" />
          			</a4j:commandLink>			
          			
          			<h:graphicImage id="imgDocFoto" url="IMG/imgDocFoto.png" title="Cadastro de Documento sem Foto" style="margin:0 0 0 4px; border:0; vertical-align:middle" rendered="#{paciente.flgDocFoto eq 'N'}" />	
          			<h:graphicImage id="imgSepse" url="IMG/risco_sepse.png" title="Paciente com suspeita de infecção" style="margin:0 0 0 4px; border:0; vertical-align:middle" rendered="#{paciente.exibeIconeSepse}" />	
				</rich:column>
				
				<!-- DATA/HORA -->
				<rich:column>
					<h:outputText value="#{paciente.datCadastro}" >
					     <f:convertDateTime pattern="dd/MM/yyyy" />
					</h:outputText>
					<h:outputText value=" #{paciente.horChegada}" />
				</rich:column>
				
				<!-- CLINICA, ENFERMARIA, LEITO -->
				<rich:column>
					<h:outputText value="#{paciente.tempoEmergencia}" />
				</rich:column>				
				
				<!-- Tempo do Risco -->				
				<rich:column>
					<h:outputText value="#{paciente.tempoRisco}" />
				</rich:column>
				
				<!-- Idade -->				
				<rich:column>
					<h:outputText value="#{paciente.idade}" />
				</rich:column>
				
				<!--  ESPECIALIDADE -->
				<rich:column>
					<h:outputText value="#{paciente.dscEspecialidadeEmergencia}" />
				</rich:column>
				
				
				<!--  IMPRESAO  -->
				<rich:column>
					<center>
						<t:commandLink id="atendimento" action="#{emergenciaForm.relatorio}" target="blank" title="IMPRIMIR GUIA DO PACIENTE">
							<h:graphicImage id="imgAtendimento" url="IMG/impressora.png" style="border:0;" />
							<f:setPropertyActionListener value="#{paciente.isnInternacao}" target="#{emergenciaForm.isnInternacao}" />							
						</t:commandLink>
					</center>
					
				</rich:column>
				
				
				<!-- AÇOÕES -->
				<rich:column style="text-align: center;">
				
				   <!-- rendered do botao id="btnChamada"
				   		rendered="#{emergenciaForm.permissaoEnf == 'S' or (emergenciaForm.permissaoMed == 'S' and paciente.isnEspecialidadeEmergencia != 9) or (emergenciaForm.permissaoOdonto == 'S' and paciente.isnEspecialidadeEmergencia == 9)}"
				    -->
					<a4j:commandButton id="btnChamada"
									   action="#{emergenciaForm.chamar}"
									   value="Chamar"
									   onclick="if (!confirm('Deseja chamar este paciente?')) return false"
									   rendered="false"
									   reRender="csEmergencia"
									   oncomplete="validar('#{emergenciaForm.mensagem}');"
									   style="margin-right: 2px;">
						<f:setPropertyActionListener value="#{paciente.isnInternacao}" target="#{emergenciaForm.isnInternacao}" />
					</a4j:commandButton>
										
					<h:graphicImage url="IMG/chamada.png" style="border:none; width: 16px; height: 18px; margin-right: 2px;" rendered="#{paciente.qtdChamada > 0}"/>
				
					<a4j:commandButton id="btnRiscoVermelho"					                   
					                   action="#{emergenciaForm.limparCampoModal}" 
					                   oncomplete="avisosValidacaoChamada(#{emergenciaForm.avisoValidacao}, '#{emergenciaForm.nomeProfissionalAtendimento}'); this.disabled = false;"
					      			   value="Risco" 
					      			   alt="Classificação de Risco"   
					                   style="margin-right: 5px;"
					                   rendered="#{(paciente.flgRisco == null or paciente.flgRisco == 'N') and (emergenciaForm.permissaoEnf == 'S') and (!emergenciaForm.usarClassificacaoToLife) and (paciente.isnInternacaoAtendimento == null)}"
					                   reRender="panelRisco, panelAtendimento"
					                   onclick="this.disabled=true">					    
					    <f:setPropertyActionListener value="#{paciente}" target="#{emergenciaForm.pacienteOtimizado}"/>
					</a4j:commandButton>
					<a4j:commandButton id="btnRisco"					                    
					                   action="#{emergenciaForm.limparCampoModal}" 
					                   oncomplete="avisosValidacaoChamada(#{emergenciaForm.avisoValidacao}, '#{emergenciaForm.nomeProfissionalAtendimento}'); this.disabled = false;"
					      			   value="Risco" 
					      			   alt="Classificação de Risco"   
					                   style="margin-right: 5px;color:red;"
					                   rendered="#{(paciente.flgRisco == 'S') and (emergenciaForm.permissaoEnf == 'S') and (!emergenciaForm.usarClassificacaoToLife) and (paciente.isnInternacaoAtendimento == null)}"
					                   reRender="panelRisco, panelAtendimento"
					                   onclick="this.disabled=true">					    
					    <f:setPropertyActionListener value="#{paciente}" target="#{emergenciaForm.pacienteOtimizado}"/>
					</a4j:commandButton>
					
					<a4j:commandButton id="btnAtendimento"
					                   ajaxSingle="true" 
					                   reRender="panelAtendimento"
					                   action="#{emergenciaForm.modalAtendimentoMedico}" 
					                   oncomplete="avisosValidacaoChamada(#{emergenciaForm.avisoValidacao}, '#{emergenciaForm.nomeProfissionalAtendimento}')"
					    			   value="Atendimento"
					                   rendered="#{ (paciente.flgAtendendo == null or paciente.flgAtendendo == 'N') and ((emergenciaForm.permissaoMed == 'S' and paciente.isnEspecialidadeEmergencia != 9) or (emergenciaForm.permissaoOdonto == 'S' and paciente.isnEspecialidadeEmergencia == 9)) }"
					                   alt="Atendimento Médico"
					                   style="margin-right: 5px;">
					    <f:setPropertyActionListener value="#{paciente}" target="#{emergenciaForm.pacienteOtimizado}"/>
					    <f:setPropertyActionListener value="#{paciente}" target="#{prescricaoForm.pacienteOtimizado}"/>					    
					    <f:setPropertyActionListener value="#{paciente.isnInternacao}" target="#{emergenciaForm.isnInternacao}" />
					    <f:setPropertyActionListener value="#{paciente.isnInternacao}" target="#{prescricaoForm.isnInternacao}" />
						<f:setPropertyActionListener value="atendimentoAba" target="#{templateForm.tabAmbulatorio}"/>
					    <f:setPropertyActionListener value="#{false}" target="#{emergenciaForm.mostrarBotaoCancelamentoSepse}" />
					</a4j:commandButton>
					<a4j:commandButton id="btnAtendimentoVermelho"
					                   ajaxSingle="true" 
					                   reRender="panelAtendimento"
					                   action="#{emergenciaForm.modalAtendimentoMedico}" 
					                   oncomplete="avisosValidacaoChamada(#{emergenciaForm.avisoValidacao}, '#{emergenciaForm.nomeProfissionalAtendimento}')"			
					    			   value="Atendimento"
					                   rendered="#{(paciente.flgAtendendo == 'S') and ((emergenciaForm.permissaoMed == 'S' and paciente.isnEspecialidadeEmergencia != 9) or (emergenciaForm.permissaoOdonto == 'S' and paciente.isnEspecialidadeEmergencia == 9))}"
					                   alt="Atendimento Médico"
					                   style="margin-right: 5px;color:red;">
					    <f:setPropertyActionListener value="#{paciente}" target="#{emergenciaForm.pacienteOtimizado}"/>
					    <f:setPropertyActionListener value="#{paciente}" target="#{prescricaoForm.pacienteOtimizado}"/>		
					    <f:setPropertyActionListener value="#{paciente.isnInternacao}" target="#{emergenciaForm.isnInternacao}" />
					    <f:setPropertyActionListener value="#{paciente.isnInternacao}" target="#{prescricaoForm.isnInternacao}" />
						<f:setPropertyActionListener value="atendimentoAba" target="#{templateForm.tabAmbulatorio}"/>
					    <f:setPropertyActionListener value="#{false}" target="#{emergenciaForm.mostrarBotaoCancelamentoSepse}" />
					</a4j:commandButton>
					
				</rich:column>
				
				<f:facet name="footer">
					<rich:datascroller id="ds" ajaxSingle="false" />
				</f:facet>
			</rich:dataTable>
		</div>	
		<br/><br/><br/>		
		
		<a4j:status id="statusPanel"
			   onstart="Richfaces.showModalPanel('panelStatus');" 
			    onstop="#{rich:component('panelStatus')}.hide()">
		</a4j:status> 		
		
		</h:form>
		<script type="text/javascript">
		<!--
		function checkarDataMaior(obj, choosenDate) {
			var now = new Date();
	    	var diff = now.getTime() - choosenDate.getTime();
	        if (diff < 0) {
	        	 alert("Data selecionada é maior que a Data Atual!");
	        	 #{rich:component('dtSint')}.resetSelectedDate();
	        }
	        return false; 
	    }
		  //-->
			function avisosValidacao(erro, panel, show) {
				if (erro == 1) {
				   	alert("Selecione a classificação de risco do paciente.");
				   	return false;
				} else if (erro == 2) {
					alert("Classificação de risco selecionada e a mesma que a atual.");
				   	return false;
				} else if (erro == 3) {
					alert("Usuário/Conselho e/ou Senha/Assinatura inválidos.");					
			    	return false;
			    } else if (erro == 4) {
					alert("Para registrar nova classificação espere 1 minuto.");					
			    	return false;	
			    } else if (erro == 5) {
					alert("Usuário sem permisão para esta ação.");					
			    	return false;		
			    } else if (erro == 6) {
					alert("Selecione o Destino da emergência.");					
			    	return false;		
			    } else if (erro == 7) {
					alert("Campo 'Observações do atendimento' não pode ficar em branco.");					
			    	return false;				
			    } else if (erro == 8) {
					alert("Informe o motivo da alta.");					
			    	return false;			
			    } else if (erro == 9) {
					alert("Hospital destino não informado.");					
			    	return false;			
			    } else if (erro == 10) {
					alert("Informe o Eixo a ser transferido.");					
			    	return false;			
				} else if (erro == 11) {
					alert("Erro ao gravar no banco de dados. Contate o NTI.");
			    	return false;	
				} else if (erro == 12) {
					alert("Selecione o Fluxograma.");
			    	return false;	
			    } else if (erro == 13) {
					alert("Informe o discriminador.");
			    	return false;	
			    } else if (erro == 14) {
					alert("Selecione sim ou não para acidente.");
			    	return false;
			    } else if (erro == 15) {
					alert("Selecione sim ou não para agressão.");
			    	return false;
			    }else if(erro == 16){
			    	Richfaces.showModalPanel("panelPeso");
			    }else if(erro == 17){
			    	alert("Enfermeira precisa avaliar o risco do paciente.");
			    	return false;
			    }else if(erro == 18){
			    	window.location = "#{request.contextPath}/cd_atendimentoMedico.jsf";
			    }else if(erro == 19){
			    	alert("Paciente em atendimento por outro profissional.");
			    	return false;
			     }else if(erro == 20){
			    	Richfaces.showModalPanel("panelRisco");
			     }else if(erro == 22){
			    	alert("Antes de executar essa operação você deve atualizar sua pagina!");
			     }else if(erro == 23){
				    	alert("Campo Risco de Queda Obrigatório!");
			     }else if(erro == 24){
				    	alert("Campo Alergia Obrigatório!");
				}else if(erro == 25){
				    	alert("Campo data do primeiro sintoma da dengue é obrigatório!");
				}else if(erro == 26){
				    	alert("Campo dengue é obrigatório!");
				}else if(erro == 27){
				    	alert("Campo Suspeita de Infecção é obrigatório!");
				}else if(erro == 28){
				    	alert("Campo chikungunya é obrigatório!");
				}else if(erro == 29){
				    	alert("Campo data do primeiro sintoma da chikungunya é obrigatório!");
				}else {
			    	if (show) {
			        	Richfaces.showModalPanel(panel);
			    	} else {
			    		Richfaces.hideModalPanel(panel);
			    	}	 	
				} 		    	
			}
			
			function avisosValidacaoChamada(erro, nomeProfissional)
			{
				if (erro == 17)
				{
			    	alert("Enfermeira precisa avaliar o risco do paciente.");
				}
				if (erro == 20)
				{
			    	Richfaces.showModalPanel("panelRisco");
				}
				if (erro == 23)
				{
			    	alert("Não é possível atender este paciente, pois ele está sendo classificado pelo(a) profissional " + nomeProfissional + "!");
		     	}
				else if (erro == 24)
		     	{
			    	alert("Não é possível classificar este paciente, pois ele está em atendimento pelo(a) profissional " + nomeProfissional + "!");
		     	}
				else if (erro == 25)
		     	{
			    	alert("Não é possível atender este paciente, pois ele está em atendimento pelo(a) profissional " + nomeProfissional + "!");
		     	}
				else if (erro == 26)
		     	{
			    	alert("Não é possível classificar este paciente, pois ele está sendo classificado pelo(a) profissional " + nomeProfissional + "!");
		     	}
				else if (erro == 29)
		     	{
			    	alert("Este paciente já foi atendido por Dr(a) " + nomeProfissional + ", por favor atualize sua página!");
		     	}
				else if (erro == 30)
		     	{
			    	alert("EMERGES ToLife está inoperante. Notifique o(a) coordenador(a) da unidade.");
		     	}
				else if(erro == 31){
					alert("Paciente já foi atendido! Não é possivel classificá-lo novamente!");
					var btnRefresh = document.getElementById('csEmergencia:btnRefresh');
					btnRefresh.click();
				}
				else if(erro == 32){
					alert("O status desse atendimento foi alterado! Deseja atualizar a página?");
					var btnRefresh = document.getElementById('csEmergencia:btnRefresh');
					btnRefresh.click();
				}
			}
			
			function validar(msg)
			{
				if(msg != '')
				{
					alert(msg);
					return false;
				}
				return true;
			}

			function validarRiscoInfeccao(msg, panel){
				if(msg != ''){
					alert(msg);
				}else{
					Richfaces.hideModalPanel(panel);
				}
			}
			
			function verificarChamada(possuiChamada)
			{
				if (possuiChamada)
				{
					Richfaces.showModalPanel('panConfirmacaoRisco')					
				}
				else
				{
					Richfaces.showModalPanel("panelRisco");
				}
			}
			
			
		</script>
	</ui:define>
</ui:composition>
</html>