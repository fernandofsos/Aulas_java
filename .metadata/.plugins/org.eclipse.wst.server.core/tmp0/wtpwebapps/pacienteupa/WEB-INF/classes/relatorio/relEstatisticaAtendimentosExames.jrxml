<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="relEstatisticaAtendimentosExames" language="groovy" pageWidth="595" pageHeight="840" columnWidth="555" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="1.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="Title" isDefault="false" fontName="Arial" fontSize="26" isBold="true" pdfFontName="Helvetica-Bold"/>
	<style name="SubTitle" isDefault="false" forecolor="#666666" fontName="Arial" fontSize="18"/>
	<style name="Column header" isDefault="false" forecolor="#666666" fontName="Arial" fontSize="12" isBold="true"/>
	<style name="Detail" isDefault="false" fontName="Arial" fontSize="12"/>
	<parameter name="CAMINHO_IMG" class="java.lang.String"/>
	<parameter name="CAMINHO_IMG2" class="java.lang.String"/>
	<parameter name="DataInicial" class="java.util.Date"/>
	<parameter name="DataFinal" class="java.util.Date"/>
	<queryString>
		<![CDATA[select usu.dsc_usuario,
       ate.total_atendimentos,
       exm.dsc_exame,
       exa.total_exame,
       usu.dsc_login,

       (select vlr_parametro from medpoint.t_parametro where isn_parametro = 10) as endereco_completo,
       (select vlr_parametro from medpoint.t_parametro where isn_parametro = 13) as dsc_unidade
from ( select isn_usuario, count(*) as total_atendimentos
                 from medpoint.t_internacao_atendimento
                 where dat_ini between $P{DataInicial} and $P{DataFinal}
                 group by 1 ) ate
     left join (select isn_usuario, isn_exame, count(*) as total_exame
                from medpoint.t_exame_solic
                where dat_solicitacao between $P{DataInicial} and $P{DataFinal}
                group by 1, 2) exa on exa.isn_usuario = ate.isn_usuario
     left join medpoint.t_exame exm on exm.isn_exame = exa.isn_exame
     left join seguranca.t_usuario usu on usu.isn_usuario = ate.isn_usuario  ]]>
	</queryString>
	<field name="dsc_usuario" class="java.lang.String"/>
	<field name="total_atendimentos" class="java.lang.Long"/>
	<field name="dsc_exame" class="java.lang.String"/>
	<field name="total_exame" class="java.lang.Long"/>
	<field name="dsc_login" class="java.lang.String"/>
	<field name="endereco_completo" class="java.lang.String"/>
	<field name="dsc_unidade" class="java.lang.String"/>
	<variable name="SOMA_EXAMES" class="java.lang.Integer" resetType="Group" resetGroup="dsc_usuario" calculation="Sum">
		<variableExpression><![CDATA[$F{total_exame}]]></variableExpression>
	</variable>
	<group name="dsc_usuario">
		<groupExpression><![CDATA[$F{dsc_usuario}]]></groupExpression>
		<groupHeader>
			<band height="46">
				<staticText>
					<reportElement x="0" y="1" width="555" height="15"/>
					<box>
						<topPen lineWidth="1.0"/>
						<leftPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Center">
						<font isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[MEDICO]]></text>
				</staticText>
				<staticText>
					<reportElement x="117" y="16" width="36" height="15"/>
					<box>
						<leftPen lineWidth="0.0"/>
					</box>
					<textElement/>
					<text><![CDATA[Nome:]]></text>
				</staticText>
				<textField>
					<reportElement x="154" y="16" width="401" height="15"/>
					<box>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement/>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{dsc_usuario}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="0" y="33" width="555" height="13"/>
					<box>
						<topPen lineWidth="1.0" lineStyle="Dashed"/>
						<leftPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement textAlignment="Center">
						<font isBold="true" isUnderline="true"/>
					</textElement>
					<text><![CDATA[EXAMES]]></text>
				</staticText>
				<staticText>
					<reportElement x="0" y="16" width="36" height="15"/>
					<box>
						<leftPen lineWidth="1.0"/>
					</box>
					<textElement/>
					<text><![CDATA[ CRM:]]></text>
				</staticText>
				<textField>
					<reportElement x="36" y="16" width="81" height="15"/>
					<box>
						<rightPen lineWidth="0.0"/>
					</box>
					<textElement/>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{dsc_login}]]></textFieldExpression>
				</textField>
			</band>
		</groupHeader>
		<groupFooter>
			<band height="101">
				<staticText>
					<reportElement x="0" y="13" width="118" height="15"/>
					<box>
						<leftPen lineWidth="1.0"/>
						<bottomPen lineWidth="1.0"/>
					</box>
					<textElement/>
					<text><![CDATA[Total de Atendimentos:]]></text>
				</staticText>
				<textField>
					<reportElement x="118" y="13" width="437" height="15"/>
					<box>
						<bottomPen lineWidth="1.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement/>
					<textFieldExpression class="java.lang.String"><![CDATA[$F{total_atendimentos}]]></textFieldExpression>
				</textField>
				<staticText>
					<reportElement x="0" y="0" width="90" height="15"/>
					<box>
						<leftPen lineWidth="1.0"/>
					</box>
					<textElement/>
					<text><![CDATA[Total de Exames:]]></text>
				</staticText>
				<textField>
					<reportElement x="89" y="0" width="466" height="15"/>
					<box>
						<bottomPen lineWidth="0.0"/>
						<rightPen lineWidth="1.0"/>
					</box>
					<textElement/>
					<textFieldExpression class="java.lang.String"><![CDATA[ $V{SOMA_EXAMES} == null ? "0" : $V{SOMA_EXAMES}]]></textFieldExpression>
				</textField>
			</band>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="87" splitType="Stretch">
			<image>
				<reportElement x="435" y="0" width="120" height="46"/>
				<imageExpression class="java.lang.String"><![CDATA[$P{CAMINHO_IMG}]]></imageExpression>
			</image>
			<textField>
				<reportElement x="318" y="46" width="238" height="17"/>
				<box leftPadding="4"/>
				<textElement>
					<font fontName="SansSerif" isBold="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{dsc_unidade}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="1" y="0" width="317" height="17"/>
				<textElement>
					<font fontName="SansSerif" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[INSTITUTO DE SAÚDE E GESTÃO HOSPITALAR - ISGH ]]></text>
			</staticText>
			<image>
				<reportElement x="319" y="0" width="116" height="46"/>
				<imageExpression class="java.lang.String"><![CDATA[$P{CAMINHO_IMG2}]]></imageExpression>
			</image>
			<staticText>
				<reportElement x="1" y="63" width="554" height="22"/>
				<textElement textAlignment="Center">
					<font fontName="SansSerif" size="16" isBold="true" isUnderline="false"/>
				</textElement>
				<text><![CDATA[ESTATÍSTICA ATENDIMENTOS E EXAMES]]></text>
			</staticText>
			<staticText>
				<reportElement x="1" y="34" width="317" height="17"/>
				<textElement>
					<font fontName="SansSerif" size="8" isBold="true"/>
				</textElement>
				<text><![CDATA[ORGANIZAÇÃO SOCIAL SAÚDE]]></text>
			</staticText>
			<staticText>
				<reportElement x="1" y="17" width="317" height="17"/>
				<textElement>
					<font fontName="SansSerif" size="11" isBold="true"/>
				</textElement>
				<text><![CDATA[UNIDADE DE PRONTO ATENDIMENTO - UPA]]></text>
			</staticText>
		</band>
	</title>
	<pageHeader>
		<band splitType="Stretch"/>
	</pageHeader>
	<columnHeader>
		<band splitType="Stretch"/>
	</columnHeader>
	<detail>
		<band height="33" splitType="Stretch">
			<staticText>
				<reportElement x="0" y="16" width="72" height="17"/>
				<box leftPadding="2">
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0" lineStyle="Dashed"/>
				</box>
				<textElement markup="styled">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Quantidade:]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="67" y="16" width="488" height="17"/>
				<box>
					<bottomPen lineWidth="1.0" lineStyle="Dashed"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{total_exame}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="-1" width="40" height="17"/>
				<box leftPadding="2">
					<leftPen lineWidth="1.0"/>
				</box>
				<textElement markup="styled">
					<font isBold="true"/>
				</textElement>
				<text><![CDATA[Exame:]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="42" y="-1" width="513" height="17"/>
				<box>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{dsc_exame}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<columnFooter>
		<band splitType="Stretch"/>
	</columnFooter>
	<pageFooter>
		<band height="67" splitType="Stretch">
			<textField>
				<reportElement x="-13" y="49" width="592" height="14"/>
				<textElement textAlignment="Center">
					<font fontName="SansSerif"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{endereco_completo}]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="289" y="6" width="100" height="20"/>
				<textElement/>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="0" y="36" width="555" height="1"/>
			</line>
			<staticText>
				<reportElement x="0" y="37" width="555" height="14"/>
				<textElement textAlignment="Center">
					<font fontName="SansSerif"/>
				</textElement>
				<text><![CDATA[Unidade mantida com recursos públicos, provenientes de seus impostos e contribuições sociais.]]></text>
			</staticText>
			<line>
				<reportElement x="0" y="22" width="555" height="1"/>
			</line>
			<textField>
				<reportElement x="236" y="6" width="35" height="20"/>
				<textElement textAlignment="Right"/>
				<textFieldExpression class="java.lang.String"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="271" y="6" width="17" height="20"/>
				<textElement textAlignment="Center"/>
				<text><![CDATA[de]]></text>
			</staticText>
		</band>
	</pageFooter>
	<summary>
		<band splitType="Stretch"/>
	</summary>
</jasperReport>
