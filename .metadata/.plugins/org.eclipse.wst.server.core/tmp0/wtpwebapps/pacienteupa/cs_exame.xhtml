<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
	  xmlns:a4j="http://richfaces.org/a4j"
	  xmlns:rich="http://richfaces.org/rich">

<ui:composition template="template.xhtml">
<ui:define name="headHtml">
	<link rel="stylesheet" type="text/css" href="CSS/layoutCsPaciente.css" />
	</ui:define>
	<ui:define name="conteudo">

<a4j:keepAlive beanName="exameForm" />

<rich:modalPanel id="panelStatus" autosized="true" >  
 	<h:panelGrid columns="2"> 
 		<h:graphicImage url="IMG/ajax-loader.gif" style="border:0px"/> 
 		<h:outputText value="Carregando..." />
 	</h:panelGrid> 
 </rich:modalPanel> 

<a4j:form> 
	<div style="margin-bottom: 55px">		
		<!-- INICIO DA BUSCA EXAME -->		
       	<div class="tituloPagina">NAC / EXAMES</div>    	     
    	<div class="areaPesquisa">
            <div style="margin-right: 20px; vertical-align: middle;">
                <label>Situação:</label>
                <h:selectOneMenu value="#{exameForm.intTipoConsulta}" style="margin-right: 8px" >
                    <f:selectItems value="#{exameForm.sliTipoConsulta}"/>                    	           			           		
	           </h:selectOneMenu> 
            </div>
            <div style="float: left; margin-right: 20px; vertical-align: middle;">        	
        		<label>Pesquisar:</label>
				<h:inputText id="nmaPaciente" value="#{exameForm.strPesquisa}" style="margin-right: 8px; width: 160px;" />
				<h:selectOneMenu value="#{exameForm.campoPesquisa}" style="margin-right: 8px" >
	           		<f:selectItem itemLabel="Nome/Prontuario" itemValue="1"/>	           		
	           		<f:selectItem itemLabel="Nome Mãe" itemValue="2"/>	           		
	           		<f:selectItem itemLabel="Data Nascimento" itemValue="3"/>
	           		<f:selectItem itemLabel="Naturaliade" itemValue="4"/>
	           		<f:selectItem itemLabel="Data de Cadastro" itemValue="5"/>
	           </h:selectOneMenu> 
	           <a4j:commandButton image="IMG/pesquisa.gif" action="#{exameForm.buscaPaciente}" 
		    		oncomplete="avisosPesquisa(#{exameForm.avisoUsuario})"
		    		reRender="tabelaPaciente,totalRegs" />
		    				    	
			</div>			
			<div style="float: left; width: 180px; vertical-align: middle;">
			    <label>Qtd. de registros:</label>
			    <h:outputText id="totalRegs" value="#{exameForm.totalRegistros}" style="font-weight: bold" /> 
			</div>			
    	</div>	
		<!-- FIM CAMPOS DE BUSCA -->
		
		<!-- CONTEUDO DO MODAL -->
		<div>
			<rich:dataTable id="tabelaExame"
					onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
					onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
					value="#{exameForm.lstExameSolic}" 
					var="exame" 
					rows="20"
					rowKeyVar="linha" 
					style="width: 100%"										 
					reRender="ds">
				<f:facet name="header">
					<rich:columnGroup>
						<h:column>
							<h:outputText value="Pront." />
						</h:column>
						<h:column>
							<h:outputText value="Paciente" />
						</h:column>
						<h:column>
							<h:outputText value="Enf/leito" />
						</h:column>
						<h:column>
							<h:outputText value="Data" />
						</h:column>
						<h:column>
							<h:outputText value="Exame" />
						</h:column>
						<h:column>
							<h:outputText value="Programação" />
						</h:column>
						<h:column>
							<h:outputText value="Situação" />
						</h:column>
					</rich:columnGroup>
				</f:facet>
								
				<rich:column width="5%">
					<center>
						<a4j:commandLink id="selecionar" action="csExameCdExame" >
							<h:outputText value="#{exame.numProntuario}" />
							<f:setPropertyActionListener value="#{exame}" target="#{exameForm.objExameSolic}" />	
						</a4j:commandLink>
					</center>
					
				</rich:column>
				
				<rich:column width="30%" sortable="true" >
					<h:outputText value="#{exame.dscNome}" />
				</rich:column>
				
				<rich:column width="12%">
					<h:outputText value="#{exame.dscEnfermaria}.#{exame.dscLeito}" />
				</rich:column>
							
				<rich:column width="8%">
					<h:outputText value="#{exame.datSolicitacao}" >
						<f:convertDateTime pattern="dd/MM/yyyy" />	
					</h:outputText>
				</rich:column>
				
				<rich:column width="25%">
					<h:outputText value="#{exame.dscExame}" />
				</rich:column>
				
				<rich:column width="15%">
					<h:outputText value=" " />
				</rich:column>
				
				<rich:column width="10%">
					<h:outputText value="pendente" />
				</rich:column>
		
				<f:facet name="footer">
					<rich:datascroller id="ds" ajaxSingle="false" />
				</f:facet>
			</rich:dataTable>
		</div>
	</div>
	<a4j:status id="status" 
                onstart="#{rich:component('panelStatus')}.show()"  
                onstop="#{rich:component('panelStatus')}.hide()" >
 	</a4j:status>
	<script type="text/javascript">
	     function avisosPesquisa(tipo) {
		     if (tipo==1) {
			     alert("Digite pelo menos 3 letras ou numeros.");
		     } else if (tipo==2) {
		    	 alert("Não há pacientes cadastrados que atendam a esta pesquisa.");
		     }
	     }
	</script>
</a4j:form>	
</ui:define>
</ui:composition>
</html>