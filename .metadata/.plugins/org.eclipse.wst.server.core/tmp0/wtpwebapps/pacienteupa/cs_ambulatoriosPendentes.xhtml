<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
<ui:composition template="template.xhtml">
<ui:define name="headHtml">
	<title>SISTEMA DE PACIENTE - Pesquisar Internações Validadas</title>
</ui:define>
<ui:define name="conteudo">
	<a4j:keepAlive beanName="ambulatoriosPendentesForm" />
	
	<a4j:form>
   		<div style="margin-bottom: 55px">
   	    	<label class="cabAreaPesquisa">AMBULATÓRIOS PENDENTES</label>	    
			<div class="areaPesquisa">	              
	       		<div class="col170" style="margin-top: 8px">
		       		<rich:spacer height="18px"/><br/>             
	           		<h:selectOneMenu value="#{ambulatoriosPendentesForm.campoPesquisa}"
	                                 styleClass="selectItens"
	                                 style="width:160px">
	           			<f:selectItem itemLabel="Nome" itemValue="1"/>	           			
	           			<f:selectItem itemLabel="Data/Período" itemValue="2"/>	
	           			<a4j:support reRender="lblPesquisaDat,pnlCondicao" event="onchange" action="#{ambulatoriosPendentesForm.setarCampoDatFim}">
	           				<f:setPropertyActionListener value="#{true}" target="#{ambulatoriosPendentesForm.opcaoEscolhida}"/>
	           			</a4j:support>
	           		</h:selectOneMenu>
	       		</div>
	       		<div class="col300" style="margin-top: 8px">
	       		  <h:outputText id="lblPesquisaDat" style="font-weight: bold" value="#{(ambulatoriosPendentesForm.campoPesquisa == '2'?'Período':'Pesquisa')}"/>
	       		  <br/> 
	       		  <h:panelGroup id="pnlCondicao" >	       
	           		 	<h:inputText id="inputPesquisa" 
		                             value="#{ambulatoriosPendentesForm.nome}"
		                             styleClass="campoTexto" 
		                             style="width:210px" 
		                             rendered="#{(ambulatoriosPendentesForm.campoPesquisa == '1')}"/>
	                    
	                    <rich:calendar id="datInicial" 
		       	        		       value="#{ambulatoriosPendentesForm.datIni}" 
		       		           		   datePattern="dd/MM/yyyy"
		       		           		   rendered="#{(ambulatoriosPendentesForm.campoPesquisa == '2')}" 
		       		           		   styleClass="campoTexto" 
		       		           		   enableManualInput="true"
		       		           		   oninputkeypress="return formataData(event, this)"
		       		           		   showWeeksBar="false">
     		           		<a4j:support event="onchanged" reRender="pnlCondicao" action="#{ambulatoriosPendentesForm.setarCampoDatFim}">
     		           			<f:setPropertyActionListener value="#{false}" target="#{ambulatoriosPendentesForm.opcaoEscolhida}"/>
     		           		</a4j:support>
            				<a4j:support event="oninputblur" reRender="pnlCondicao" action="#{ambulatoriosPendentesForm.setarCampoDatFim}">
            					<f:setPropertyActionListener value="#{false}" target="#{ambulatoriosPendentesForm.opcaoEscolhida}"/>
            				</a4j:support>
           				</rich:calendar>
		       	    	<h:outputText id="iptA" style="font-weight: bold" value="#{(ambulatoriosPendentesForm.campoPesquisa == '2'?'a':'')}"/>
		       	    	<rich:calendar id="datfim" 
		       	        		       value="#{ambulatoriosPendentesForm.datFim}" 
		       		           		   datePattern="dd/MM/yyyy" 
		       		           		   rendered="#{(ambulatoriosPendentesForm.campoPesquisa == '2')}" 
		       		           		   styleClass="campoTexto" 
		       		           		   enableManualInput="true"
		       		           		   oninputkeypress="return formataData(event, this)"
		       		           		   showWeeksBar="false">
           				</rich:calendar>
	       	    	<br/>    	       	                 
	       		   </h:panelGroup>	   	    
	       		</div>
	       		
	       		<div class="col180" style="margin-top: 8px">
	           		<rich:spacer height="12px"/><br/>
	           		<a4j:commandButton id="btnPesquisa" 
					           		   image="IMG/pesquisa.gif"
					           		   alt="Pesquisar" 
					                   actionListener="#{ambulatoriosPendentesForm.pesquisar}"
					                   oncomplete="validaAmbulatoriosPendentes('#{ambulatoriosPendentesForm.msgAmbulatoriosPendentes}');"
						    		   reRender="tabelaPesquisa, totalGeral" 
						    		   style="margin-right: 8px"/>
		       		<rich:hotKey key="return" 
		       		             selector="#inputPesquisa" 
		    		             handler="#{rich:element('btnPesquisa')}.click()"/>
	       		</div>
	       		<div class="col124" style="text-align: right">
	           		<label>Registros:</label><br/>
	           		<h:outputText id="totalGeral" 
	           		              value="#{ambulatoriosPendentesForm.totalRegistro}" 
	                              styleClass="totalizador2 "/>
	       		</div>	
	    	</div>
				<rich:dataTable id="tabelaPesquisa"
									onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
									onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
									value="#{ambulatoriosPendentesForm.listaPesquisa}" 
									var="rst" 
									rows="30"					 
									style="width: 100%"										 
									reRender="ds,totalGeral">
			
						<f:facet name="header">
							<rich:columnGroup>
								<rich:column style="text-align: center;width: 5%;">
									Atend.
								</rich:column>
								<rich:column style="text-align: center;">
									Pront.
								</rich:column>
								<rich:column style="text-align: center;">
									Nome
								</rich:column>
								<rich:column style="text-align: center;">
									Data
								</rich:column>
								<rich:column style="text-align: center;">
									Turno
								</rich:column>
								<rich:column style="text-align: center;">
									Hr. Cheg
								</rich:column>
								<rich:column style="text-align: center;">
									Priorit.
								</rich:column>
								<rich:column style="text-align: center;">
									TAP
								</rich:column>
								<rich:column style="text-align: center;">
									Especialidade
								</rich:column>
								<rich:column style="text-align: center;">
									Situação
								</rich:column>		
								<rich:column style="text-align: center; width: 3%;"/>
							</rich:columnGroup>	
						</f:facet>
							
						<rich:column style="text-align: left;">
							<h:outputText value="#{rst.isnMarcacao}"/>
						</rich:column>
						<rich:column style="text-align: left;">
							<h:outputText value="#{rst.pacienteBean.numProntuario}" />
						</rich:column>
						<rich:column style="text-align: left;">
							<h:outputText value="#{rst.dscNome}" />
						</rich:column>
						<rich:column style="text-align: center;">
							<h:outputText value="#{rst.escalaBean.datEscala}" converter="ConversorDeDatas" />
						</rich:column>
						<rich:column style="text-align: center;">
							<h:outputText value="MANHÃ" rendered="#{rst.escalaBean.isnTurno == 1}"/>
							<h:outputText value="TARDE" rendered="#{rst.escalaBean.isnTurno == 2}"/>
							<h:outputText value="NOITE" rendered="#{rst.escalaBean.isnTurno == 3}"/>
						</rich:column>
						<rich:column style="text-align: center;">
							<h:outputText value="#{rst.horChegada}" converter="ConversorDeHoras" />
							<h:outputText value="h" rendered="#{rst.horChegada != null}" />
						</rich:column>
						<rich:column style="text-align: left;">
							<h:outputText value="SIM" rendered="#{rst.flgPrioritario == 'S'}" title="#{rst.dscPrioritario}" style="font-size: 11px;font-weight:bold;"/>
							<h:outputText value="NÃO" rendered="#{rst.flgPrioritario == null or rst.flgPrioritario == 'N'}"/>
						</rich:column>
						<rich:column style="text-align: left;">
							<h:outputText value="SIM" rendered="#{rst.flgTap == 'S'}"/>
							<h:outputText value="NÃO" rendered="#{rst.flgTap == null or rst.flgTap == 'N'}"/>
						</rich:column>
						<rich:column style="text-align: left;">
							<h:outputText value="#{rst.tipoConsultaBean.dscTipoConsulta}" />
						</rich:column>
						<rich:column style="text-align: left;">
							<h:outputText value="#{rst.marcacaoSituacaoBean.dscMarcacaoSituacao}" style="font-size: 11px;" />
						</rich:column>
						<rich:column style="text-align: center;">
							 <h:commandLink id ="acompanhante" action="#{pacienteForm.getPaciente}" >
								<h:graphicImage id="imgAtendimento" url="IMG/atendimento.png" style="border:0;" />
						        <f:setPropertyActionListener value="#{rst}" target="#{pacienteForm.marcacaoBean}"/>
						        <f:setPropertyActionListener value="#{rst.dscNome}" target="#{pacienteForm.objPaciente.dscNome}"/>
						   	</h:commandLink> 
						</rich:column>
						<f:facet name="footer">
							<rich:datascroller id="idScroll" ajaxSingle="false" />
						</f:facet>			
					</rich:dataTable>
		</div>
		<script>
			function validaAmbulatoriosPendentes(msg)
			{
				if(msg != '')
				{
					alert(msg);
				}
			}
		</script>
	</a4j:form>	
</ui:define>
</ui:composition>
</html>