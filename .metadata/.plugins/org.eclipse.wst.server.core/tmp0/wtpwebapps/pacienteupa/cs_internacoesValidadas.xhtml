<?xml version="1.0" encoding="ISO-8859-1" ?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" 
					  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
	  xmlns:ui="http://java.sun.com/jsf/facelets"
	  xmlns:f="http://java.sun.com/jsf/core"
	  xmlns:h="http://java.sun.com/jsf/html"
      xmlns:a4j="http://richfaces.org/a4j"
      xmlns:rich="http://richfaces.org/rich">
<ui:composition template="template.xhtml">
<ui:define name="headHtml">
	<title>SISTEMA DE PACIENTE - Pesquisar Internações Validadas</title>
</ui:define>
<ui:define name="conteudo">
	<a4j:keepAlive beanName="obitoForm" />
	
	<a4j:form>
   		<div style="margin-bottom: 55px">
   	    	<div class="cabAreaPesquisa">INTERNAÇÕES VALIDADAS</div>	    
			<div class="areaPesquisa">	              
	       		<div class="col170" style="margin-top: 8px">
		       		<rich:spacer height="18px"/><br/>             
	           		<h:selectOneMenu value="#{obitoForm.campoPesquisa}"
	                                 styleClass="selectItens"
	                                 style="width:160px">
	           			<f:selectItem itemLabel="Nome/Prontuario" itemValue="1"/>	           			
	           			<f:selectItem itemLabel="Nome Mãe" itemValue="2"/>
	           			<f:selectItem itemLabel="Data/Período " itemValue="3"/>	
	           			<a4j:support reRender="lblPesquisaDat,pnlCondicao" event="onchange"></a4j:support>           			
	           		</h:selectOneMenu>
	       		</div>
	       		
	       		<div class="col300" style="margin-top: 8px">
	       		  <h:outputText id="lblPesquisaDat" style="font-weight: bold" value="#{(obitoForm.campoPesquisa == '3'?'Período':'Pesquisa')}"> </h:outputText>
	       		  <br/> 
	       		  <h:panelGroup id="pnlCondicao" >	       
	           		 	<h:inputText id="inputPesquisa" 
		                             value="#{obitoForm.filtroLista}"
		                             styleClass="campoTexto" 
		                             style="width:210px" 
		                             rendered="#{(obitoForm.campoPesquisa == '2' or obitoForm.campoPesquisa == '1')}"/>
	                    
	                    <rich:calendar id="datInicial" 
		       	        		       value="#{obitoForm.datIni}" 
		       		           		   datePattern="dd/MM/yyyy" 
		       		           		   rendered="#{(obitoForm.campoPesquisa == '3')}" 
		       		           		   styleClass="campoTexto" />					        		               
		       	    	<h:outputText id="iptA" style="font-weight: bold" value="#{(obitoForm.campoPesquisa == '3'?'a':'')}"> </h:outputText>
		       	    	<rich:calendar id="datfim" 
		       	        		       value="#{obitoForm.datFim}" 
		       		           		   datePattern="dd/MM/yyyy" 
		       		           		   rendered="#{(obitoForm.campoPesquisa == '3')}" 
		       		           		   styleClass="campoTexto" />
		       		           		   					        		               
	       	    	<br/>    	       	                 
	       		   </h:panelGroup>	   	    
	       		</div>
	       		 
	       		<div class="col180" style="margin-top: 8px">
	           		<rich:spacer height="12px"/><br/>
	           		<a4j:commandButton id="btnPesquisa" 
					           		   image="IMG/pesquisa.gif"
					           		   alt="Pesquisar" 
					                   action="#{obitoForm.filtrarListaValidadas}"  
						    		   oncomplete="avisosPesquisa(#{obitoForm.erroPesquisa})"
						    		   reRender="tabelaValidacao,totalGeral" 
						    		   style="margin-right: 8px"/>
		       		<rich:hotKey key="return" 
		       		             selector="#inputPesquisa" 
		    		             handler="#{rich:element('btnPesquisa')}.click()"/>
	       		</div>	       		
	       		<div class="col124" style="text-align: right">
	           		<label>Registros:</label><br/>
	           		<h:outputText id="totalGeral" 
	           		              value="#{obitoForm.totalValidados}" 
	                              styleClass="totalizador2 "/>
	       		</div>	       
	    	</div>
	    	<div >
				<rich:dataTable id="tabelaValidacao"
								onRowMouseOver="this.style.backgroundColor='#F1F1F1'"
								onRowMouseOut="this.style.backgroundColor='#{a4jSkin.tableBackgroundColor}'"
								value="#{obitoForm.lstInternacaoValidadas}" 
								var="internacaoLeito" 
								rows="30"					 
								style="width: 100%"										 
								reRender="ds,totalGeral">					
				
					<!-- SELECIONE -->
					<rich:column width="3%" headerClass="headColumn">
					    <f:facet name="header">
					    	<h:outputText value="SEL" />
					    </f:facet>
						<center>
							<a4j:commandLink id="selecionar" ajaxSingle="true" action="csValidaInternacaoCdValidaInternacao" title="Acessar dados da internação" >
								<h:graphicImage id="imgSelecionar02" url="IMG/selecionar.png" style="border:0;" />							
								<f:setPropertyActionListener value="#{internacaoLeito}" target="#{obitoForm.objInternacaoLeito}" />
							</a4j:commandLink>
						</center>
					</rich:column>
					
					<!-- PRONTUARIO -->
					<rich:column width="5%" sortBy="#{internacaoLeito.internacao.paciente.numProntuario}"
					             headerClass="headColumn">
					    <f:facet name="header">
					    	<h:outputText value="PRONT" />
					    </f:facet>
						<center>
							<h:outputText value="#{internacaoLeito.internacao.paciente.numProntuario}" />
						</center>
					</rich:column>
				
					<!-- NOME -->
					<rich:column width="30%" sortBy="#{internacaoLeito.internacao.paciente.dscNome}"
					             headerClass="headColumn" >
						<f:facet name="header">
					    	<h:outputText value="PACIENTE"/>
					    </f:facet>
						<h:outputText value="#{internacaoLeito.internacao.paciente.dscNome}" />
					</rich:column>
				
					<!-- NOME DA MÃE -->
					<rich:column width="27%" headerClass="headColumn">
					    <f:facet name="header">
					    	<h:outputText value="NOME DA MÃE"  />
					    </f:facet>
						<h:outputText value="#{internacaoLeito.internacao.paciente.dscMae}" />
					</rich:column>
					
					<!-- DESTINO -->
					<rich:column width="20%" style="text-align: center" sortBy="#{internacaoLeito.destino.dscDestino}"
					             headerClass="headColumn">
					    <f:facet name="header">
					    	<h:outputText value="UNIDADE" />
					    </f:facet>
						<h:outputText value="#{internacaoLeito.leito.enfermaria.clinica.dscClinica} - #{internacaoLeito.leito.enfermaria.dscEnfermaria}.#{internacaoLeito.leito.dscLeito}" />
					</rich:column>
					
					<!-- DESTINO -->
					<rich:column width="15%" style="text-align: center" sortBy="#{internacaoLeito.destino.dscDestino}"
					             headerClass="headColumn">
					    <f:facet name="header">
					    	<h:outputText value="DESTINO" />
					    </f:facet>
						<h:outputText value="#{internacaoLeito.destino.dscDestino}" />
					</rich:column>
					
					<!-- DATA ALTA -->
					<rich:column width="10%" style="text-align: center" sortBy="#{internacaoLeito.internacao.datValidacao}" 
					             headerClass="headColumn">
					    <f:facet name="header">
					    	<h:outputText value="DATA"/>
					    </f:facet>
						<h:outputText value="#{internacaoLeito.internacao.datValidacaoFmt} " />
					</rich:column>
					
					<f:facet name="footer">
						<rich:datascroller id="ds" ajaxSingle="false" />
					</f:facet>
				</rich:dataTable>
			</div>
		</div>
		<script type="text/javascript">
	    	 function avisosPesquisa(erro) {
		     	if (erro==2) {
		    	 	alert("Não há pacientes cadastrados que atendam a esta pesquisa.");
		     	}
	     	}
		</script>
	</a4j:form>	
</ui:define>
</ui:composition>
</html>